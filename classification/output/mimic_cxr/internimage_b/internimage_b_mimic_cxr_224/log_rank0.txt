[2025-11-18 11:51:51 internimage_b_mimic_cxr_224] (main.py 729): INFO Full config saved to output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/config.json
[2025-11-18 11:51:51 internimage_b_mimic_cxr_224] (main.py 732): INFO AMP_OPT_LEVEL: O1
AMP_TYPE: float16
AUG:
  AUTO_AUGMENT: none
  COLOR_JITTER: 0.0
  CUTMIX: 0.0
  CUTMIX_MINMAX: null
  MEAN:
  - 0.485
  - 0.456
  - 0.406
  MIXUP: 0.0
  MIXUP_MODE: batch
  MIXUP_PROB: 0.0
  MIXUP_SWITCH_PROB: 0.0
  RANDOM_RESIZED_CROP: false
  RECOUNT: 1
  REMODE: pixel
  REPROB: 0.1
  STD:
  - 0.229
  - 0.224
  - 0.225
BASE:
- ''
DATA:
  BATCH_SIZE: 128
  CACHE_MODE: part
  DATASET: mimic_cxr
  DATA_PATH: /scratch/smehta90/mimic_splits
  IMG_ON_MEMORY: false
  IMG_SIZE: 224
  INTERPOLATION: bicubic
  NUM_WORKERS: 8
  PIN_MEMORY: true
  ZIP_MODE: false
EVAL_22K_TO_1K: false
EVAL_FREQ: 1
EVAL_MODE: false
LOCAL_RANK: 0
MODEL:
  DROP_PATH_RATE: 0.5
  DROP_PATH_TYPE: linear
  DROP_RATE: 0.0
  INTERN_IMAGE:
    CENTER_FEATURE_SCALE: false
    CHANNELS: 112
    CORE_OP: DCNv3
    DEPTHS:
    - 4
    - 4
    - 21
    - 4
    DW_KERNEL_SIZE: null
    GROUPS:
    - 7
    - 14
    - 28
    - 56
    LAYER_SCALE: 1.0e-05
    LEVEL2_POST_NORM: false
    LEVEL2_POST_NORM_BLOCK_IDS: null
    MLP_RATIO: 4.0
    OFFSET_SCALE: 1.0
    POST_NORM: true
    REMOVE_CENTER: false
    RES_POST_NORM: false
    USE_CLIP_PROJECTOR: false
  LABEL_SMOOTHING: 0.0
  NAME: internimage_b_mimic_cxr_224
  NUM_CLASSES: 14
  PRETRAINED: pretrained/internimage_b_1k_224.pth
  RESUME: ''
  TYPE: intern_image
OUTPUT: output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224
PRINT_FREQ: 50
SAVE_CKPT_NUM: 1
SAVE_FREQ: 1
SEED: 42
TAG: run1
TEST:
  CROP: true
  SEQUENTIAL: false
THROUGHPUT_MODE: false
TRAIN:
  ACCUMULATION_STEPS: 1
  AUTO_RESUME: true
  BASE_LR: 0.0001
  CLIP_GRAD: 5.0
  EMA:
    DECAY: 0.9999
    ENABLE: true
  EPOCHS: 20
  LR_LAYER_DECAY: true
  LR_LAYER_DECAY_RATIO: 0.875
  LR_SCHEDULER:
    DECAY_EPOCHS: 30
    DECAY_RATE: 0.1
    NAME: cosine
  MIN_LR: 1.0e-06
  OPTIMIZER:
    BETAS:
    - 0.9
    - 0.999
    DCN_LR_MUL: null
    EPS: 1.0e-08
    FREEZE_BACKBONE: null
    MOMENTUM: 0.9
    NAME: adamw
    USE_ZERO: false
  RAND_INIT_FT_HEAD: true
  START_EPOCH: 0
  USE_CHECKPOINT: false
  WARMUP_EPOCHS: 2
  WARMUP_LR: 5.0e-07
  WEIGHT_DECAY: 0.05

[2025-11-18 11:51:53 internimage_b_mimic_cxr_224] (main.py 175): INFO Creating model:intern_image/internimage_b_mimic_cxr_224
[2025-11-18 11:51:54 internimage_b_mimic_cxr_224] (main.py 178): INFO InternImage(
  (patch_embed): StemLayer(
    (conv1): Conv2d(3, 56, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm1): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((56,), eps=1e-06, elementwise_affine=True)
      (2): to_channels_first()
    )
    (act): GELU(approximate='none')
    (conv2): Conv2d(56, 112, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm2): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
    )
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (levels): ModuleList(
    (0): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): Identity()
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.016)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.031)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.047)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (1): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.062)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.078)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.094)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.109)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (2): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.125)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.141)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.156)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.172)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (4): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.188)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (5): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.203)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (6): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.219)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (7): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.234)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (8): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.250)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (9): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.266)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (10): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.281)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (11): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.297)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (12): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.312)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (13): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.328)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (14): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.344)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (15): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.359)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (16): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.375)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (17): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.391)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (18): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.406)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (19): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.422)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (20): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.438)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(448, 896, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (3): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.453)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.469)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.484)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.500)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (conv_head): Sequential(
    (0): Conv2d(896, 1344, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (1): Sequential(
      (0): BatchNorm2d(1344, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): GELU(approximate='none')
  )
  (head): Linear(in_features=1344, out_features=14, bias=True)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
[2025-11-18 11:51:55 internimage_b_mimic_cxr_224] (main.py 214): INFO Using native Torch AMP. Training in mixed precision.
[2025-11-18 11:51:55 internimage_b_mimic_cxr_224] (main.py 226): INFO using fp16_compress_hook!
[2025-11-18 11:51:55 internimage_b_mimic_cxr_224] (main.py 234): INFO number of params: 96135662
[2025-11-18 11:51:55 internimage_b_mimic_cxr_224] (main.py 247): INFO Using BCEWithLogitsLoss for multi-label classification
[2025-11-18 11:51:55 internimage_b_mimic_cxr_224] (main.py 272): INFO no checkpoint found in output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224, ignoring auto resume
[2025-11-18 11:51:55 internimage_b_mimic_cxr_224] (utils.py 123): INFO ==============> Loading weight pretrained/internimage_b_1k_224.pth for fine-tuning......
[2025-11-18 11:51:57 internimage_b_mimic_cxr_224] (utils.py 249): WARNING Error in loading classifier head, re-init classifier head to 0
[2025-11-18 11:51:57 internimage_b_mimic_cxr_224] (utils.py 284): WARNING _IncompatibleKeys(missing_keys=['head.weight', 'head.bias'], unexpected_keys=[])
[2025-11-18 11:51:57 internimage_b_mimic_cxr_224] (utils.py 289): INFO => loaded successfully pretrained/internimage_b_1k_224.pth
[2025-11-18 11:52:41 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 43.257 (43.257)	Loss 0.6931 (0.6931)	Mem 3828MB
[2025-11-18 11:54:18 internimage_b_mimic_cxr_224] (utils_multilabel.py 141): INFO  * Mean AUC-ROC 0.4875 Loss 0.6931
[2025-11-18 11:54:18 internimage_b_mimic_cxr_224] (utils_multilabel.py 142): INFO  * Per-class AUC-ROC: ['0.4878', '0.4540', '0.5052', '0.4769', '0.5129', '0.4502', '0.5290', '0.5204', '0.4037', '0.4951', '0.4143', '0.5102', '0.4550', '0.6110']
[2025-11-18 11:54:18 internimage_b_mimic_cxr_224] (main.py 296): INFO AUC-ROC of the network on the 2991 val images: 0.4875
[2025-11-18 11:54:18 internimage_b_mimic_cxr_224] (main.py 331): INFO Start training
[2025-11-18 11:55:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][0/2882]	eta 2 days, 17:47:59 lr 0.000000	time 82.1928 (82.1928)	model_time 18.4820 (18.4820)	loss 0.6931 (0.6931)	grad_norm 0.4588 (0.4588/0.0000)	mem 33516MB
[2025-11-18 12:01:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][50/2882]	eta 6:13:41 lr 0.000001	time 6.0570 (7.9171)	model_time 0.6278 (0.9821)	loss 0.6906 (0.6921)	grad_norm 0.4748 (0.4693/0.0109)	mem 34628MB
[2025-11-18 12:05:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][100/2882]	eta 5:21:38 lr 0.000001	time 0.6440 (6.9369)	model_time 0.6437 (0.8091)	loss 0.6846 (0.6900)	grad_norm 0.5156 (0.4795/0.0152)	mem 34629MB
[2025-11-18 12:10:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][150/2882]	eta 4:57:39 lr 0.000001	time 0.6311 (6.5373)	model_time 0.6308 (0.7506)	loss 0.6746 (0.6868)	grad_norm 0.5469 (0.4930/0.0252)	mem 34629MB
[2025-11-18 12:16:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][200/2882]	eta 4:51:56 lr 0.000001	time 34.5294 (6.5313)	model_time 0.6409 (0.7226)	loss 0.6599 (0.6821)	grad_norm 0.5614 (0.5080/0.0350)	mem 34629MB
[2025-11-18 12:21:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][250/2882]	eta 4:43:06 lr 0.000001	time 0.6372 (6.4540)	model_time 0.6370 (0.7055)	loss 0.6336 (0.6753)	grad_norm 0.6456 (0.5299/0.0571)	mem 34629MB
[2025-11-18 12:26:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][300/2882]	eta 4:38:44 lr 0.000001	time 0.6528 (6.4773)	model_time 0.6523 (0.6956)	loss 0.6048 (0.6663)	grad_norm 0.7212 (0.5542/0.0816)	mem 34629MB
[2025-11-18 12:31:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][350/2882]	eta 4:30:59 lr 0.000001	time 2.3458 (6.4218)	model_time 0.6265 (0.6879)	loss 0.5676 (0.6554)	grad_norm 0.6534 (0.6017/0.1570)	mem 34629MB
[2025-11-18 12:37:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][400/2882]	eta 4:27:50 lr 0.000001	time 43.7513 (6.4748)	model_time 0.6310 (0.6808)	loss 0.5361 (0.6424)	grad_norm 0.6149 (0.6418/0.1595)	mem 34630MB
[2025-11-18 12:42:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][450/2882]	eta 4:21:32 lr 0.000001	time 0.6327 (6.4524)	model_time 0.6324 (0.6754)	loss 0.4892 (0.6275)	grad_norm 0.7222 (0.6776/0.1555)	mem 34630MB
[2025-11-18 12:47:17 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][500/2882]	eta 4:11:51 lr 0.000001	time 0.6323 (6.3439)	model_time 0.6320 (0.6713)	loss 0.4601 (0.6116)	grad_norm 0.5965 (0.7028/0.1509)	mem 34631MB
[2025-11-18 12:51:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][550/2882]	eta 4:03:54 lr 0.000001	time 6.3895 (6.2754)	model_time 0.6401 (0.6686)	loss 0.4025 (0.5955)	grad_norm 0.8001 (0.7084/0.1510)	mem 34631MB
[2025-11-18 12:56:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][600/2882]	eta 3:57:37 lr 0.000001	time 19.8867 (6.2478)	model_time 0.6343 (0.6663)	loss 0.4091 (0.5800)	grad_norm 0.5150 (0.6966/0.1575)	mem 34631MB
[2025-11-18 13:01:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][650/2882]	eta 3:51:12 lr 0.000001	time 23.1510 (6.2155)	model_time 0.6435 (0.6647)	loss 0.3692 (0.5652)	grad_norm 0.4922 (0.6659/0.1144)	mem 34631MB
[2025-11-18 13:06:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][700/2882]	eta 3:43:46 lr 0.000001	time 0.6384 (6.1534)	model_time 0.6380 (0.6630)	loss 0.3806 (0.5512)	grad_norm 0.6417 (0.6373/0.1196)	mem 34631MB
[2025-11-18 13:10:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][750/2882]	eta 3:37:11 lr 0.000001	time 0.6478 (6.1125)	model_time 0.6475 (0.6612)	loss 0.3559 (0.5380)	grad_norm 1.1323 (0.6017/0.1241)	mem 34631MB
[2025-11-18 13:15:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][800/2882]	eta 3:29:47 lr 0.000001	time 0.6407 (6.0458)	model_time 0.6404 (0.6598)	loss 0.3492 (0.5260)	grad_norm 0.4353 (0.5761/0.1271)	mem 34631MB
[2025-11-18 13:19:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][850/2882]	eta 3:23:44 lr 0.000001	time 23.7267 (6.0158)	model_time 0.6341 (0.6586)	loss 0.3270 (0.5150)	grad_norm 0.7811 (0.5581/0.1303)	mem 34631MB
[2025-11-18 13:23:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][900/2882]	eta 3:16:11 lr 0.000001	time 0.6368 (5.9394)	model_time 0.6365 (0.6577)	loss 0.3182 (0.5050)	grad_norm 0.5486 (0.5419/0.1428)	mem 34631MB
[2025-11-18 13:27:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][950/2882]	eta 3:09:35 lr 0.000001	time 15.0845 (5.8878)	model_time 0.6311 (0.6566)	loss 0.3367 (0.4955)	grad_norm 0.8101 (0.5357/0.1495)	mem 34631MB
[2025-11-18 13:31:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1000/2882]	eta 3:03:03 lr 0.000001	time 0.6319 (5.8361)	model_time 0.6317 (0.6554)	loss 0.3158 (0.4869)	grad_norm 0.3810 (0.5347/0.1576)	mem 34631MB
[2025-11-18 13:35:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1050/2882]	eta 2:56:59 lr 0.000001	time 8.0038 (5.7964)	model_time 0.6347 (0.6541)	loss 0.3304 (0.4787)	grad_norm 0.4145 (0.5393/0.1656)	mem 34631MB
[2025-11-18 13:39:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1100/2882]	eta 2:50:46 lr 0.000001	time 2.3094 (5.7501)	model_time 0.6381 (0.6534)	loss 0.3130 (0.4712)	grad_norm 0.3554 (0.5393/0.1703)	mem 34631MB
[2025-11-18 13:44:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1150/2882]	eta 2:45:22 lr 0.000001	time 16.8895 (5.7288)	model_time 0.6345 (0.6527)	loss 0.3275 (0.4642)	grad_norm 0.7164 (0.5388/0.1754)	mem 34631MB
[2025-11-18 13:47:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1200/2882]	eta 2:39:06 lr 0.000001	time 0.6431 (5.6759)	model_time 0.6427 (0.6522)	loss 0.3094 (0.4578)	grad_norm 0.5530 (0.5411/0.1708)	mem 34631MB
[2025-11-18 13:52:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1250/2882]	eta 2:33:48 lr 0.000001	time 11.8243 (5.6546)	model_time 0.6384 (0.6516)	loss 0.2974 (0.4517)	grad_norm 0.2892 (0.5382/0.1722)	mem 34631MB
[2025-11-18 13:56:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1300/2882]	eta 2:29:03 lr 0.000001	time 20.5604 (5.6531)	model_time 0.6497 (0.6513)	loss 0.2932 (0.4459)	grad_norm 0.5907 (0.5361/0.1730)	mem 34631MB
[2025-11-18 14:01:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1350/2882]	eta 2:24:15 lr 0.000001	time 13.0755 (5.6500)	model_time 0.6373 (0.6508)	loss 0.3150 (0.4405)	grad_norm 0.7302 (0.5400/0.1703)	mem 34631MB
[2025-11-18 14:06:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1400/2882]	eta 2:19:31 lr 0.000001	time 0.6328 (5.6488)	model_time 0.6324 (0.6503)	loss 0.2906 (0.4351)	grad_norm 0.4554 (0.5326/0.1616)	mem 34631MB
[2025-11-18 14:10:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1450/2882]	eta 2:14:44 lr 0.000001	time 0.6422 (5.6453)	model_time 0.6419 (0.6501)	loss 0.2730 (0.4302)	grad_norm 0.3822 (0.5479/0.1685)	mem 34631MB
[2025-11-18 14:16:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1500/2882]	eta 2:10:31 lr 0.000001	time 20.9769 (5.6665)	model_time 0.6462 (0.6497)	loss 0.2883 (0.4256)	grad_norm 0.7719 (0.5612/0.1664)	mem 34631MB
[2025-11-18 14:20:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1550/2882]	eta 2:05:50 lr 0.000001	time 17.9663 (5.6687)	model_time 0.6383 (0.6493)	loss 0.2820 (0.4211)	grad_norm 0.8666 (0.5829/0.1763)	mem 34631MB
[2025-11-18 14:25:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1600/2882]	eta 2:00:48 lr 0.000001	time 0.6324 (5.6540)	model_time 0.6321 (0.6489)	loss 0.2806 (0.4168)	grad_norm 0.6792 (0.5932/0.1789)	mem 34632MB
[2025-11-18 14:30:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1650/2882]	eta 1:56:13 lr 0.000001	time 16.6551 (5.6602)	model_time 0.6295 (0.6485)	loss 0.2976 (0.4127)	grad_norm 0.6655 (0.6001/0.1766)	mem 34632MB
[2025-11-18 14:35:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1700/2882]	eta 1:52:16 lr 0.000001	time 24.7794 (5.6989)	model_time 0.6359 (0.6479)	loss 0.2939 (0.4089)	grad_norm 1.0478 (0.6222/0.1815)	mem 34632MB
[2025-11-18 14:41:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1750/2882]	eta 1:48:02 lr 0.000001	time 0.6273 (5.7265)	model_time 0.6270 (0.6475)	loss 0.2764 (0.4052)	grad_norm 0.7786 (0.6251/0.1852)	mem 34632MB
[2025-11-18 14:46:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1800/2882]	eta 1:43:10 lr 0.000001	time 0.6290 (5.7213)	model_time 0.6288 (0.6470)	loss 0.2437 (0.4016)	grad_norm 0.4887 (0.6329/0.1964)	mem 34632MB
[2025-11-18 14:52:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1850/2882]	eta 1:39:08 lr 0.000001	time 21.8841 (5.7637)	model_time 0.6570 (0.6467)	loss 0.2805 (0.3983)	grad_norm 0.6480 (0.6407/0.1931)	mem 34632MB
[2025-11-18 14:57:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1900/2882]	eta 1:34:41 lr 0.000001	time 16.7748 (5.7860)	model_time 0.6337 (0.6467)	loss 0.2746 (0.3950)	grad_norm 0.4365 (0.6454/0.1879)	mem 34632MB
[2025-11-18 15:02:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][1950/2882]	eta 1:29:45 lr 0.000001	time 0.6410 (5.7784)	model_time 0.6407 (0.6464)	loss 0.2847 (0.3921)	grad_norm 1.1891 (0.6631/0.1989)	mem 34632MB
[2025-11-18 15:07:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2000/2882]	eta 1:25:01 lr 0.000001	time 0.6385 (5.7843)	model_time 0.6381 (0.6463)	loss 0.2803 (0.3892)	grad_norm 0.6858 (0.6615/0.1975)	mem 34632MB
[2025-11-18 15:12:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2050/2882]	eta 1:20:27 lr 0.000001	time 37.0063 (5.8017)	model_time 0.6262 (0.6461)	loss 0.2666 (0.3865)	grad_norm 0.4660 (0.6669/0.2044)	mem 34632MB
[2025-11-18 15:17:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2100/2882]	eta 1:15:29 lr 0.000001	time 5.6778 (5.7926)	model_time 0.6486 (0.6458)	loss 0.2670 (0.3838)	grad_norm 0.5695 (0.6717/0.2049)	mem 34632MB
[2025-11-18 15:21:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2150/2882]	eta 1:10:32 lr 0.000001	time 19.3587 (5.7815)	model_time 0.6403 (0.6455)	loss 0.2654 (0.3812)	grad_norm 0.7550 (0.6762/0.2098)	mem 34632MB
[2025-11-18 15:26:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2200/2882]	eta 1:05:35 lr 0.000001	time 0.6448 (5.7711)	model_time 0.6445 (0.6454)	loss 0.2578 (0.3788)	grad_norm 0.4207 (0.6806/0.2092)	mem 34632MB
[2025-11-18 15:30:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2250/2882]	eta 1:00:45 lr 0.000001	time 33.5719 (5.7681)	model_time 0.6279 (0.6453)	loss 0.2816 (0.3765)	grad_norm 1.1243 (0.6819/0.2048)	mem 34632MB
[2025-11-18 15:34:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2300/2882]	eta 0:55:48 lr 0.000001	time 0.6280 (5.7533)	model_time 0.6278 (0.6451)	loss 0.2868 (0.3742)	grad_norm 0.8205 (0.6963/0.2056)	mem 34632MB
[2025-11-18 15:39:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2350/2882]	eta 0:50:58 lr 0.000001	time 7.5534 (5.7487)	model_time 0.6231 (0.6447)	loss 0.2426 (0.3721)	grad_norm 0.6639 (0.6930/0.2059)	mem 34632MB
[2025-11-18 15:44:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2400/2882]	eta 0:46:06 lr 0.000001	time 0.6335 (5.7404)	model_time 0.6332 (0.6447)	loss 0.2521 (0.3699)	grad_norm 0.6751 (0.6939/0.2124)	mem 34632MB
[2025-11-18 15:48:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2450/2882]	eta 0:41:20 lr 0.000001	time 16.8670 (5.7409)	model_time 0.6380 (0.6445)	loss 0.2609 (0.3679)	grad_norm 0.6785 (0.6884/0.2070)	mem 34632MB
[2025-11-18 15:54:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2500/2882]	eta 0:36:37 lr 0.000001	time 0.6256 (5.7523)	model_time 0.6253 (0.6442)	loss 0.2645 (0.3660)	grad_norm 0.7194 (0.6911/0.2080)	mem 34632MB
[2025-11-18 15:59:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2550/2882]	eta 0:31:55 lr 0.000001	time 45.4244 (5.7705)	model_time 0.6366 (0.6439)	loss 0.2809 (0.3641)	grad_norm 0.5595 (0.6780/0.2088)	mem 34632MB
[2025-11-18 16:05:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2600/2882]	eta 0:27:13 lr 0.000001	time 0.6253 (5.7942)	model_time 0.6251 (0.6437)	loss 0.2689 (0.3623)	grad_norm 0.8334 (0.6761/0.2083)	mem 34632MB
[2025-11-18 16:11:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2650/2882]	eta 0:22:27 lr 0.000001	time 7.4587 (5.8103)	model_time 0.6276 (0.6434)	loss 0.2805 (0.3605)	grad_norm 0.9558 (0.6765/0.2010)	mem 34632MB
[2025-11-18 16:16:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2700/2882]	eta 0:17:38 lr 0.000001	time 0.6293 (5.8136)	model_time 0.6291 (0.6431)	loss 0.2941 (0.3589)	grad_norm 0.7820 (0.6841/0.1899)	mem 34632MB
[2025-11-18 16:21:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2750/2882]	eta 0:12:50 lr 0.000001	time 39.6836 (5.8347)	model_time 0.6412 (0.6431)	loss 0.2512 (0.3573)	grad_norm 0.5621 (0.6864/0.1907)	mem 34632MB
[2025-11-18 16:26:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2800/2882]	eta 0:07:58 lr 0.000001	time 0.6332 (5.8406)	model_time 0.6327 (0.6430)	loss 0.2892 (0.3556)	grad_norm 0.8904 (0.6904/0.1910)	mem 34632MB
[2025-11-18 16:31:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [0/20][2850/2882]	eta 0:03:06 lr 0.000001	time 8.7367 (5.8407)	model_time 0.6351 (0.6430)	loss 0.3106 (0.3541)	grad_norm 1.2754 (0.7024/0.1968)	mem 34632MB
[2025-11-18 16:34:55 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 0 training takes 4:40:36
[2025-11-18 16:34:55 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_0.pth saving......
[2025-11-18 16:34:57 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_0.pth saved !!!
[2025-11-18 16:35:50 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 53.070 (53.070)	Loss 0.2873 (0.2873)	Mem 34632MB
[2025-11-18 16:37:36 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:0] * Mean AUC-ROC 0.7218 Loss 0.2656
[2025-11-18 16:37:36 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:0] * Per-class AUC-ROC: ['0.7452', '0.7322', '0.7381', '0.8399', '0.6497', '0.5513', '0.6393', '0.6974', '0.8251', '0.8421', '0.6662', '0.6637', '0.6431', '0.8721']
[2025-11-18 16:37:36 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.7218
[2025-11-18 16:37:36 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-18 16:37:38 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-18 16:37:38 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.7218
[2025-11-18 16:37:49 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 10.859 (10.859)	Loss 0.6124 (0.6124)	Mem 34632MB
[2025-11-18 16:38:10 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:0] * Mean AUC-ROC 0.6071 Loss 0.6046
[2025-11-18 16:38:10 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:0] * Per-class AUC-ROC: ['0.6154', '0.5910', '0.6193', '0.6704', '0.5310', '0.4932', '0.5345', '0.6144', '0.7451', '0.6779', '0.5571', '0.5362', '0.5380', '0.7756']
[2025-11-18 16:38:10 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.6071
[2025-11-18 16:38:10 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-18 16:38:13 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-18 16:38:13 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.6071
[2025-11-18 16:39:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][0/2882]	eta 1 day, 14:22:06 lr 0.000001	time 47.9271 (47.9271)	model_time 0.6292 (0.6292)	loss 0.2811 (0.2811)	grad_norm 1.0274 (1.0274/0.0000)	mem 34632MB
[2025-11-18 16:44:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][50/2882]	eta 5:23:34 lr 0.000001	time 0.6337 (6.8555)	model_time 0.6334 (0.6330)	loss 0.2600 (0.2641)	grad_norm 0.5197 (0.7464/0.2108)	mem 34632MB
[2025-11-18 16:49:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][100/2882]	eta 5:01:44 lr 0.000001	time 6.8685 (6.5077)	model_time 0.6422 (0.6319)	loss 0.2416 (0.2671)	grad_norm 0.7406 (0.7292/0.2047)	mem 34632MB
[2025-11-18 16:54:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][150/2882]	eta 4:48:58 lr 0.000001	time 0.6526 (6.3463)	model_time 0.6522 (0.6353)	loss 0.2958 (0.2667)	grad_norm 0.8544 (0.7273/0.2059)	mem 34632MB
[2025-11-18 16:59:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][200/2882]	eta 4:47:03 lr 0.000001	time 0.6337 (6.4219)	model_time 0.6335 (0.6361)	loss 0.2659 (0.2663)	grad_norm 0.7110 (0.7348/0.2012)	mem 34632MB
[2025-11-18 17:05:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][250/2882]	eta 4:47:38 lr 0.000001	time 0.6371 (6.5572)	model_time 0.6368 (0.6375)	loss 0.3023 (0.2660)	grad_norm 1.0911 (0.7355/0.2020)	mem 34632MB
[2025-11-18 17:11:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][300/2882]	eta 4:43:18 lr 0.000001	time 6.2137 (6.5837)	model_time 0.6305 (0.6378)	loss 0.2586 (0.2662)	grad_norm 0.8473 (0.7308/0.2040)	mem 34632MB
[2025-11-18 17:16:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][350/2882]	eta 4:37:32 lr 0.000001	time 0.6275 (6.5768)	model_time 0.6272 (0.6369)	loss 0.2710 (0.2658)	grad_norm 0.7049 (0.7327/0.2027)	mem 34632MB
[2025-11-18 17:22:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][400/2882]	eta 4:36:50 lr 0.000001	time 0.6393 (6.6923)	model_time 0.6390 (0.6369)	loss 0.2506 (0.2653)	grad_norm 0.5578 (0.7454/0.2083)	mem 34632MB
[2025-11-18 17:29:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][450/2882]	eta 4:34:19 lr 0.000001	time 0.6296 (6.7681)	model_time 0.6294 (0.6361)	loss 0.2878 (0.2651)	grad_norm 0.6937 (0.7451/0.2042)	mem 34632MB
[2025-11-18 17:34:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][500/2882]	eta 4:29:37 lr 0.000001	time 15.2385 (6.7917)	model_time 0.6548 (0.6368)	loss 0.2422 (0.2650)	grad_norm 0.9284 (0.7437/0.2037)	mem 34632MB
[2025-11-18 17:40:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][550/2882]	eta 4:22:55 lr 0.000001	time 0.6493 (6.7648)	model_time 0.6490 (0.6376)	loss 0.2655 (0.2646)	grad_norm 0.6434 (0.7536/0.2007)	mem 34632MB
[2025-11-18 17:45:47 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][600/2882]	eta 4:16:31 lr 0.000001	time 0.6349 (6.7449)	model_time 0.6347 (0.6379)	loss 0.2362 (0.2643)	grad_norm 1.2564 (0.7635/0.1936)	mem 34632MB
[2025-11-18 17:51:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][650/2882]	eta 4:12:43 lr 0.000001	time 3.7219 (6.7935)	model_time 0.6425 (0.6382)	loss 0.2737 (0.2640)	grad_norm 0.8933 (0.7653/0.1903)	mem 34632MB
[2025-11-18 17:57:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][700/2882]	eta 4:06:14 lr 0.000001	time 0.6383 (6.7710)	model_time 0.6379 (0.6388)	loss 0.2698 (0.2638)	grad_norm 0.9843 (0.7557/0.1819)	mem 34632MB
[2025-11-18 18:03:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][750/2882]	eta 4:02:00 lr 0.000001	time 0.6409 (6.8110)	model_time 0.6404 (0.6390)	loss 0.2593 (0.2636)	grad_norm 0.6478 (0.7659/0.1957)	mem 34632MB
[2025-11-18 18:09:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][800/2882]	eta 3:55:59 lr 0.000001	time 0.6522 (6.8009)	model_time 0.6520 (0.6393)	loss 0.2797 (0.2638)	grad_norm 0.7358 (0.7702/0.2005)	mem 34632MB
[2025-11-18 18:15:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][850/2882]	eta 3:52:45 lr 0.000001	time 26.4676 (6.8729)	model_time 0.6477 (0.6396)	loss 0.2484 (0.2637)	grad_norm 0.8960 (0.7651/0.1943)	mem 34632MB
[2025-11-18 18:21:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][900/2882]	eta 3:48:00 lr 0.000001	time 0.6499 (6.9023)	model_time 0.6495 (0.6401)	loss 0.2746 (0.2633)	grad_norm 0.7818 (0.7663/0.2015)	mem 34632MB
[2025-11-18 18:27:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][950/2882]	eta 3:42:11 lr 0.000001	time 0.6420 (6.9006)	model_time 0.6416 (0.6405)	loss 0.2689 (0.2633)	grad_norm 0.7655 (0.7732/0.2055)	mem 34632MB
[2025-11-18 18:33:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1000/2882]	eta 3:35:55 lr 0.000001	time 0.6367 (6.8837)	model_time 0.6364 (0.6409)	loss 0.2905 (0.2630)	grad_norm 0.9313 (0.7815/0.2121)	mem 34632MB
[2025-11-18 18:39:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1050/2882]	eta 3:31:05 lr 0.000001	time 44.3506 (6.9134)	model_time 0.6461 (0.6414)	loss 0.2484 (0.2629)	grad_norm 0.6405 (0.7801/0.2040)	mem 34632MB
[2025-11-18 18:44:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1100/2882]	eta 3:25:02 lr 0.000001	time 0.6397 (6.9039)	model_time 0.6394 (0.6415)	loss 0.2526 (0.2629)	grad_norm 0.5421 (0.7881/0.1999)	mem 34632MB
[2025-11-18 18:50:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1150/2882]	eta 3:18:39 lr 0.000001	time 0.6361 (6.8818)	model_time 0.6359 (0.6417)	loss 0.2773 (0.2627)	grad_norm 1.0572 (0.7875/0.2088)	mem 34632MB
[2025-11-18 18:56:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1200/2882]	eta 3:13:02 lr 0.000001	time 0.6348 (6.8860)	model_time 0.6346 (0.6418)	loss 0.2428 (0.2625)	grad_norm 0.6523 (0.7867/0.1997)	mem 34632MB
[2025-11-18 19:02:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1250/2882]	eta 3:08:31 lr 0.000001	time 57.2772 (6.9312)	model_time 0.6367 (0.6421)	loss 0.2736 (0.2623)	grad_norm 1.0460 (0.7939/0.2075)	mem 34632MB
[2025-11-18 19:09:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1300/2882]	eta 3:03:27 lr 0.000001	time 0.6468 (6.9579)	model_time 0.6464 (0.6421)	loss 0.2627 (0.2621)	grad_norm 0.7680 (0.7890/0.2007)	mem 34632MB
[2025-11-18 19:14:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1350/2882]	eta 2:57:45 lr 0.000001	time 0.6498 (6.9615)	model_time 0.6495 (0.6422)	loss 0.2563 (0.2619)	grad_norm 0.7181 (0.7838/0.1986)	mem 34632MB
[2025-11-18 19:20:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1400/2882]	eta 2:51:56 lr 0.000001	time 0.6375 (6.9611)	model_time 0.6372 (0.6423)	loss 0.2362 (0.2617)	grad_norm 0.5699 (0.7808/0.2043)	mem 34632MB
[2025-11-18 19:27:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1450/2882]	eta 2:47:10 lr 0.000001	time 52.8428 (7.0043)	model_time 0.6426 (0.6420)	loss 0.2266 (0.2615)	grad_norm 0.9980 (0.7915/0.2081)	mem 34632MB
[2025-11-18 19:33:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1500/2882]	eta 2:41:01 lr 0.000001	time 0.6318 (6.9911)	model_time 0.6315 (0.6417)	loss 0.2713 (0.2614)	grad_norm 0.5658 (0.7955/0.2204)	mem 34632MB
[2025-11-18 19:38:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1550/2882]	eta 2:34:48 lr 0.000001	time 0.6269 (6.9735)	model_time 0.6265 (0.6413)	loss 0.2574 (0.2612)	grad_norm 0.6389 (0.7838/0.2122)	mem 34632MB
[2025-11-18 19:43:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1600/2882]	eta 2:28:32 lr 0.000001	time 0.6366 (6.9518)	model_time 0.6363 (0.6411)	loss 0.2432 (0.2610)	grad_norm 0.3934 (0.7888/0.2141)	mem 34632MB
[2025-11-18 19:49:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1650/2882]	eta 2:22:42 lr 0.000001	time 47.4602 (6.9502)	model_time 0.6306 (0.6408)	loss 0.2605 (0.2608)	grad_norm 0.7920 (0.7933/0.2196)	mem 34632MB
[2025-11-18 19:54:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1700/2882]	eta 2:16:37 lr 0.000001	time 0.6384 (6.9354)	model_time 0.6381 (0.6406)	loss 0.2586 (0.2607)	grad_norm 0.5224 (0.8012/0.2255)	mem 34632MB
[2025-11-18 19:59:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1750/2882]	eta 2:10:13 lr 0.000001	time 0.6326 (6.9026)	model_time 0.6323 (0.6403)	loss 0.2578 (0.2605)	grad_norm 0.9986 (0.8031/0.2305)	mem 34632MB
[2025-11-18 20:04:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1800/2882]	eta 2:04:07 lr 0.000001	time 0.6301 (6.8831)	model_time 0.6298 (0.6400)	loss 0.2659 (0.2604)	grad_norm 0.7716 (0.8062/0.2332)	mem 34632MB
[2025-11-18 20:10:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1850/2882]	eta 1:58:32 lr 0.000001	time 39.3632 (6.8919)	model_time 0.6269 (0.6398)	loss 0.2233 (0.2602)	grad_norm 0.7760 (0.8120/0.2315)	mem 34632MB
[2025-11-18 20:15:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1900/2882]	eta 1:52:24 lr 0.000001	time 0.6295 (6.8682)	model_time 0.6292 (0.6396)	loss 0.2462 (0.2600)	grad_norm 0.8015 (0.8208/0.2328)	mem 34632MB
[2025-11-18 20:20:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][1950/2882]	eta 1:46:18 lr 0.000001	time 0.6456 (6.8444)	model_time 0.6452 (0.6397)	loss 0.2563 (0.2600)	grad_norm 0.7983 (0.8302/0.2253)	mem 34632MB
[2025-11-18 20:25:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2000/2882]	eta 1:40:22 lr 0.000001	time 0.6310 (6.8279)	model_time 0.6307 (0.6396)	loss 0.2553 (0.2598)	grad_norm 0.7754 (0.8234/0.2163)	mem 34632MB
[2025-11-18 20:31:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2050/2882]	eta 1:34:40 lr 0.000001	time 45.5787 (6.8279)	model_time 0.6307 (0.6394)	loss 0.2585 (0.2597)	grad_norm 0.9799 (0.8213/0.2070)	mem 34632MB
[2025-11-18 20:36:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2100/2882]	eta 1:28:42 lr 0.000001	time 0.6262 (6.8057)	model_time 0.6260 (0.6392)	loss 0.2480 (0.2595)	grad_norm 0.9231 (0.8243/0.2044)	mem 34643MB
[2025-11-18 20:41:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2150/2882]	eta 1:22:43 lr 0.000001	time 0.6271 (6.7807)	model_time 0.6267 (0.6390)	loss 0.2543 (0.2595)	grad_norm 0.6199 (0.8320/0.2096)	mem 34643MB
[2025-11-18 20:46:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2200/2882]	eta 1:16:47 lr 0.000001	time 0.6349 (6.7558)	model_time 0.6346 (0.6389)	loss 0.2484 (0.2594)	grad_norm 1.1877 (0.8308/0.2091)	mem 34643MB
[2025-11-18 20:51:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2250/2882]	eta 1:11:14 lr 0.000001	time 41.6484 (6.7638)	model_time 0.6327 (0.6387)	loss 0.2487 (0.2593)	grad_norm 0.9695 (0.8283/0.2122)	mem 34643MB
[2025-11-18 20:57:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2300/2882]	eta 1:05:27 lr 0.000001	time 0.6400 (6.7478)	model_time 0.6397 (0.6387)	loss 0.2547 (0.2591)	grad_norm 0.7776 (0.8317/0.2114)	mem 34643MB
[2025-11-18 21:02:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2350/2882]	eta 0:59:42 lr 0.000001	time 0.6451 (6.7336)	model_time 0.6447 (0.6389)	loss 0.2262 (0.2590)	grad_norm 0.8760 (0.8407/0.2092)	mem 34643MB
[2025-11-18 21:07:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2400/2882]	eta 0:54:00 lr 0.000001	time 0.6440 (6.7226)	model_time 0.6436 (0.6391)	loss 0.2600 (0.2588)	grad_norm 0.8664 (0.8391/0.2030)	mem 34643MB
[2025-11-18 21:12:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2450/2882]	eta 0:48:22 lr 0.000001	time 41.7797 (6.7179)	model_time 0.6374 (0.6393)	loss 0.2655 (0.2588)	grad_norm 1.3765 (0.8315/0.2060)	mem 34643MB
[2025-11-18 21:17:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2500/2882]	eta 0:42:41 lr 0.000001	time 0.6414 (6.7061)	model_time 0.6412 (0.6394)	loss 0.2828 (0.2587)	grad_norm 0.8074 (0.8314/0.2115)	mem 34643MB
[2025-11-18 21:22:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2550/2882]	eta 0:36:57 lr 0.000001	time 0.6382 (6.6788)	model_time 0.6378 (0.6396)	loss 0.2920 (0.2585)	grad_norm 1.0281 (0.8421/0.2205)	mem 34643MB
[2025-11-18 21:27:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2600/2882]	eta 0:31:19 lr 0.000001	time 0.6391 (6.6640)	model_time 0.6387 (0.6396)	loss 0.2553 (0.2584)	grad_norm 0.8847 (0.8470/0.2249)	mem 34643MB
[2025-11-18 21:32:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2650/2882]	eta 0:25:44 lr 0.000001	time 42.0579 (6.6570)	model_time 0.6427 (0.6398)	loss 0.2586 (0.2583)	grad_norm 0.6853 (0.8503/0.2305)	mem 34643MB
[2025-11-18 21:36:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2700/2882]	eta 0:20:07 lr 0.000001	time 0.6314 (6.6361)	model_time 0.6311 (0.6397)	loss 0.2560 (0.2581)	grad_norm 0.6595 (0.8489/0.2324)	mem 34643MB
[2025-11-18 21:41:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2750/2882]	eta 0:14:34 lr 0.000001	time 0.6316 (6.6231)	model_time 0.6314 (0.6396)	loss 0.2665 (0.2580)	grad_norm 1.0048 (0.8523/0.2327)	mem 34643MB
[2025-11-18 21:46:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2800/2882]	eta 0:09:01 lr 0.000001	time 0.6300 (6.5988)	model_time 0.6297 (0.6394)	loss 0.2563 (0.2579)	grad_norm 0.6057 (0.8561/0.2301)	mem 34643MB
[2025-11-18 21:51:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [1/20][2850/2882]	eta 0:03:31 lr 0.000001	time 55.6688 (6.5965)	model_time 0.6307 (0.6393)	loss 0.2198 (0.2577)	grad_norm 0.7660 (0.8480/0.2218)	mem 34643MB
[2025-11-18 21:53:47 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 1 training takes 5:15:34
[2025-11-18 21:53:47 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_1.pth saving......
[2025-11-18 21:53:49 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_1.pth saved !!!
[2025-11-18 21:54:30 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 39.983 (39.983)	Loss 0.2850 (0.2850)	Mem 34643MB
[2025-11-18 21:55:52 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:1] * Mean AUC-ROC 0.7640 Loss 0.2478
[2025-11-18 21:55:52 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:1] * Per-class AUC-ROC: ['0.8065', '0.7917', '0.7718', '0.8881', '0.6979', '0.5621', '0.6628', '0.7247', '0.8409', '0.8988', '0.6852', '0.7169', '0.7489', '0.8997']
[2025-11-18 21:55:52 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.7640
[2025-11-18 21:55:52 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-18 21:55:54 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-18 21:55:54 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.7640
[2025-11-18 21:56:05 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 10.590 (10.590)	Loss 0.4714 (0.4714)	Mem 34643MB
[2025-11-18 21:56:28 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:1] * Mean AUC-ROC 0.6757 Loss 0.4496
[2025-11-18 21:56:28 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:1] * Per-class AUC-ROC: ['0.7060', '0.7052', '0.7025', '0.8033', '0.6157', '0.4255', '0.6111', '0.6759', '0.7917', '0.7843', '0.6070', '0.5901', '0.5978', '0.8441']
[2025-11-18 21:56:28 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.6757
[2025-11-18 21:56:28 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-18 21:56:32 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-18 21:56:32 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.6757
[2025-11-18 21:57:17 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][0/2882]	eta 1 day, 11:54:26 lr 0.000001	time 44.8530 (44.8530)	model_time 0.6378 (0.6378)	loss 0.2656 (0.2656)	grad_norm 1.0962 (1.0962/0.0000)	mem 34643MB
[2025-11-18 22:02:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][50/2882]	eta 5:21:24 lr 0.000001	time 0.7639 (6.8094)	model_time 0.7637 (0.6331)	loss 0.2371 (0.2483)	grad_norm 0.8238 (0.8622/0.2150)	mem 34643MB
[2025-11-18 22:06:22 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][100/2882]	eta 4:30:40 lr 0.000001	time 0.6391 (5.8378)	model_time 0.6388 (0.6341)	loss 0.2699 (0.2476)	grad_norm 0.7351 (0.8583/0.2443)	mem 34643MB
[2025-11-18 22:11:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][150/2882]	eta 4:23:54 lr 0.000001	time 0.6417 (5.7959)	model_time 0.6412 (0.6373)	loss 0.2435 (0.2476)	grad_norm 1.1046 (0.8614/0.2329)	mem 34643MB
[2025-11-18 22:15:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][200/2882]	eta 4:19:28 lr 0.000001	time 30.0720 (5.8048)	model_time 0.6285 (0.6382)	loss 0.2609 (0.2484)	grad_norm 1.2473 (0.8583/0.2287)	mem 34643MB
[2025-11-18 22:20:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][250/2882]	eta 4:08:33 lr 0.000001	time 0.6258 (5.6664)	model_time 0.6257 (0.6363)	loss 0.2559 (0.2487)	grad_norm 0.6926 (0.8596/0.2299)	mem 34643MB
[2025-11-18 22:24:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][300/2882]	eta 3:59:46 lr 0.000001	time 9.2996 (5.5720)	model_time 0.6398 (0.6354)	loss 0.2425 (0.2495)	grad_norm 0.9111 (0.8544/0.2254)	mem 34643MB
[2025-11-18 22:28:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][350/2882]	eta 3:52:30 lr 0.000001	time 0.6342 (5.5096)	model_time 0.6338 (0.6372)	loss 0.2774 (0.2494)	grad_norm 1.0061 (0.8439/0.2215)	mem 34643MB
[2025-11-18 22:33:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][400/2882]	eta 3:47:40 lr 0.000001	time 18.9446 (5.5038)	model_time 0.6423 (0.6377)	loss 0.2869 (0.2490)	grad_norm 0.7719 (0.8275/0.2109)	mem 34643MB
[2025-11-18 22:38:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][450/2882]	eta 3:45:22 lr 0.000001	time 0.6336 (5.5602)	model_time 0.6333 (0.6382)	loss 0.2225 (0.2492)	grad_norm 1.0027 (0.8388/0.2204)	mem 34643MB
[2025-11-18 22:42:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][500/2882]	eta 3:38:23 lr 0.000001	time 0.6301 (5.5012)	model_time 0.6297 (0.6380)	loss 0.2381 (0.2492)	grad_norm 0.5508 (0.8233/0.2234)	mem 34643MB
[2025-11-18 22:46:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][550/2882]	eta 3:32:14 lr 0.000001	time 0.6385 (5.4606)	model_time 0.6380 (0.6381)	loss 0.2310 (0.2490)	grad_norm 1.4041 (0.8249/0.2255)	mem 34643MB
[2025-11-18 22:51:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][600/2882]	eta 3:28:37 lr 0.000001	time 0.6388 (5.4854)	model_time 0.6385 (0.6381)	loss 0.2430 (0.2488)	grad_norm 0.7179 (0.8195/0.2299)	mem 34643MB
[2025-11-18 22:56:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][650/2882]	eta 3:25:21 lr 0.000001	time 31.2317 (5.5204)	model_time 0.6348 (0.6380)	loss 0.2549 (0.2489)	grad_norm 0.7031 (0.8252/0.2328)	mem 34643MB
[2025-11-18 23:00:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][700/2882]	eta 3:19:33 lr 0.000001	time 0.6284 (5.4876)	model_time 0.6281 (0.6376)	loss 0.2618 (0.2490)	grad_norm 0.9089 (0.8366/0.2319)	mem 34643MB
[2025-11-18 23:04:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][750/2882]	eta 3:14:01 lr 0.000001	time 0.6437 (5.4604)	model_time 0.6433 (0.6377)	loss 0.2492 (0.2492)	grad_norm 0.6175 (0.8249/0.2302)	mem 34643MB
[2025-11-18 23:08:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][800/2882]	eta 3:07:35 lr 0.000001	time 0.6361 (5.4061)	model_time 0.6357 (0.6380)	loss 0.2431 (0.2490)	grad_norm 0.8001 (0.8352/0.2315)	mem 34643MB
[2025-11-18 23:13:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][850/2882]	eta 3:03:20 lr 0.000001	time 19.8280 (5.4138)	model_time 0.6259 (0.6386)	loss 0.2389 (0.2489)	grad_norm 1.0019 (0.8254/0.2265)	mem 34643MB
[2025-11-18 23:17:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][900/2882]	eta 2:58:46 lr 0.000001	time 0.6292 (5.4119)	model_time 0.6289 (0.6383)	loss 0.2235 (0.2490)	grad_norm 0.8532 (0.8327/0.2304)	mem 34643MB
[2025-11-18 23:21:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][950/2882]	eta 2:53:09 lr 0.000001	time 0.6319 (5.3777)	model_time 0.6316 (0.6380)	loss 0.2501 (0.2489)	grad_norm 0.9838 (0.8327/0.2365)	mem 34643MB
[2025-11-18 23:25:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1000/2882]	eta 2:48:03 lr 0.000001	time 0.6392 (5.3580)	model_time 0.6389 (0.6378)	loss 0.2709 (0.2490)	grad_norm 0.5554 (0.8365/0.2420)	mem 34643MB
[2025-11-18 23:30:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1050/2882]	eta 2:44:08 lr 0.000001	time 27.9858 (5.3759)	model_time 0.6557 (0.6380)	loss 0.2655 (0.2488)	grad_norm 0.8973 (0.8346/0.2385)	mem 34643MB
[2025-11-18 23:34:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1100/2882]	eta 2:38:35 lr 0.000001	time 0.6293 (5.3397)	model_time 0.6290 (0.6379)	loss 0.2742 (0.2489)	grad_norm 0.7692 (0.8408/0.2348)	mem 34643MB
[2025-11-18 23:38:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1150/2882]	eta 2:33:16 lr 0.000001	time 0.6330 (5.3098)	model_time 0.6328 (0.6376)	loss 0.2263 (0.2488)	grad_norm 1.3557 (0.8501/0.2420)	mem 34643MB
[2025-11-18 23:42:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1200/2882]	eta 2:28:31 lr 0.000001	time 0.6294 (5.2982)	model_time 0.6291 (0.6374)	loss 0.2549 (0.2488)	grad_norm 0.8818 (0.8542/0.2344)	mem 34643MB
[2025-11-18 23:47:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1250/2882]	eta 2:24:08 lr 0.000001	time 32.9631 (5.2991)	model_time 0.6331 (0.6370)	loss 0.2430 (0.2488)	grad_norm 0.8811 (0.8672/0.2317)	mem 34643MB
[2025-11-18 23:50:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1300/2882]	eta 2:18:57 lr 0.000001	time 0.6287 (5.2703)	model_time 0.6284 (0.6368)	loss 0.2475 (0.2488)	grad_norm 1.0143 (0.8765/0.2311)	mem 34643MB
[2025-11-19 02:24:47 internimage_b_mimic_cxr_224] (main.py 729): INFO Full config saved to output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/config.json
[2025-11-19 02:24:47 internimage_b_mimic_cxr_224] (main.py 732): INFO AMP_OPT_LEVEL: O1
AMP_TYPE: float16
AUG:
  AUTO_AUGMENT: none
  COLOR_JITTER: 0.0
  CUTMIX: 0.0
  CUTMIX_MINMAX: null
  MEAN:
  - 0.485
  - 0.456
  - 0.406
  MIXUP: 0.0
  MIXUP_MODE: batch
  MIXUP_PROB: 0.0
  MIXUP_SWITCH_PROB: 0.0
  RANDOM_RESIZED_CROP: false
  RECOUNT: 1
  REMODE: pixel
  REPROB: 0.1
  STD:
  - 0.229
  - 0.224
  - 0.225
BASE:
- ''
DATA:
  BATCH_SIZE: 128
  CACHE_MODE: part
  DATASET: mimic_cxr
  DATA_PATH: /scratch/smehta90/mimic_splits
  IMG_ON_MEMORY: false
  IMG_SIZE: 224
  INTERPOLATION: bicubic
  NUM_WORKERS: 12
  PIN_MEMORY: true
  ZIP_MODE: false
EVAL_22K_TO_1K: false
EVAL_FREQ: 1
EVAL_MODE: false
LOCAL_RANK: 0
MODEL:
  DROP_PATH_RATE: 0.5
  DROP_PATH_TYPE: linear
  DROP_RATE: 0.0
  INTERN_IMAGE:
    CENTER_FEATURE_SCALE: false
    CHANNELS: 112
    CORE_OP: DCNv3
    DEPTHS:
    - 4
    - 4
    - 21
    - 4
    DW_KERNEL_SIZE: null
    GROUPS:
    - 7
    - 14
    - 28
    - 56
    LAYER_SCALE: 1.0e-05
    LEVEL2_POST_NORM: false
    LEVEL2_POST_NORM_BLOCK_IDS: null
    MLP_RATIO: 4.0
    OFFSET_SCALE: 1.0
    POST_NORM: true
    REMOVE_CENTER: false
    RES_POST_NORM: false
    USE_CLIP_PROJECTOR: false
  LABEL_SMOOTHING: 0.0
  NAME: internimage_b_mimic_cxr_224
  NUM_CLASSES: 14
  PRETRAINED: pretrained/internimage_b_1k_224.pth
  RESUME: ''
  TYPE: intern_image
OUTPUT: output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224
PRINT_FREQ: 50
SAVE_CKPT_NUM: 1
SAVE_FREQ: 1
SEED: 42
TAG: run1
TEST:
  CROP: true
  SEQUENTIAL: false
THROUGHPUT_MODE: false
TRAIN:
  ACCUMULATION_STEPS: 1
  AUTO_RESUME: true
  BASE_LR: 0.0001
  CLIP_GRAD: 5.0
  EMA:
    DECAY: 0.9999
    ENABLE: true
  EPOCHS: 20
  LR_LAYER_DECAY: true
  LR_LAYER_DECAY_RATIO: 0.875
  LR_SCHEDULER:
    DECAY_EPOCHS: 30
    DECAY_RATE: 0.1
    NAME: cosine
  MIN_LR: 1.0e-06
  OPTIMIZER:
    BETAS:
    - 0.9
    - 0.999
    DCN_LR_MUL: null
    EPS: 1.0e-08
    FREEZE_BACKBONE: null
    MOMENTUM: 0.9
    NAME: adamw
    USE_ZERO: false
  RAND_INIT_FT_HEAD: true
  START_EPOCH: 0
  USE_CHECKPOINT: false
  WARMUP_EPOCHS: 2
  WARMUP_LR: 5.0e-07
  WEIGHT_DECAY: 0.05

[2025-11-19 02:24:49 internimage_b_mimic_cxr_224] (main.py 175): INFO Creating model:intern_image/internimage_b_mimic_cxr_224
[2025-11-19 02:24:50 internimage_b_mimic_cxr_224] (main.py 178): INFO InternImage(
  (patch_embed): StemLayer(
    (conv1): Conv2d(3, 56, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm1): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((56,), eps=1e-06, elementwise_affine=True)
      (2): to_channels_first()
    )
    (act): GELU(approximate='none')
    (conv2): Conv2d(56, 112, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm2): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
    )
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (levels): ModuleList(
    (0): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): Identity()
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.016)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.031)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.047)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (1): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.062)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.078)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.094)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.109)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (2): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.125)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.141)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.156)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.172)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (4): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.188)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (5): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.203)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (6): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.219)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (7): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.234)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (8): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.250)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (9): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.266)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (10): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.281)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (11): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.297)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (12): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.312)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (13): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.328)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (14): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.344)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (15): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.359)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (16): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.375)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (17): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.391)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (18): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.406)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (19): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.422)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (20): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.438)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(448, 896, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (3): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.453)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.469)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.484)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.500)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (conv_head): Sequential(
    (0): Conv2d(896, 1344, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (1): Sequential(
      (0): BatchNorm2d(1344, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): GELU(approximate='none')
  )
  (head): Linear(in_features=1344, out_features=14, bias=True)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
[2025-11-19 02:24:50 internimage_b_mimic_cxr_224] (main.py 214): INFO Using native Torch AMP. Training in mixed precision.
[2025-11-19 02:24:50 internimage_b_mimic_cxr_224] (main.py 226): INFO using fp16_compress_hook!
[2025-11-19 02:24:50 internimage_b_mimic_cxr_224] (main.py 234): INFO number of params: 96135662
[2025-11-19 02:24:50 internimage_b_mimic_cxr_224] (main.py 247): INFO Using BCEWithLogitsLoss for multi-label classification
[2025-11-19 02:24:50 internimage_b_mimic_cxr_224] (main.py 270): INFO auto resuming from output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth
[2025-11-19 02:24:50 internimage_b_mimic_cxr_224] (utils.py 60): INFO ==============> Resuming form output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth....................
[2025-11-19 02:31:53 internimage_b_mimic_cxr_224] (main.py 729): INFO Full config saved to output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/config.json
[2025-11-19 02:31:53 internimage_b_mimic_cxr_224] (main.py 732): INFO AMP_OPT_LEVEL: O1
AMP_TYPE: float16
AUG:
  AUTO_AUGMENT: none
  COLOR_JITTER: 0.0
  CUTMIX: 0.0
  CUTMIX_MINMAX: null
  MEAN:
  - 0.485
  - 0.456
  - 0.406
  MIXUP: 0.0
  MIXUP_MODE: batch
  MIXUP_PROB: 0.0
  MIXUP_SWITCH_PROB: 0.0
  RANDOM_RESIZED_CROP: false
  RECOUNT: 1
  REMODE: pixel
  REPROB: 0.1
  STD:
  - 0.229
  - 0.224
  - 0.225
BASE:
- ''
DATA:
  BATCH_SIZE: 128
  CACHE_MODE: part
  DATASET: mimic_cxr
  DATA_PATH: /scratch/smehta90/mimic_splits
  IMG_ON_MEMORY: false
  IMG_SIZE: 224
  INTERPOLATION: bicubic
  NUM_WORKERS: 12
  PIN_MEMORY: true
  ZIP_MODE: false
EVAL_22K_TO_1K: false
EVAL_FREQ: 1
EVAL_MODE: false
LOCAL_RANK: 0
MODEL:
  DROP_PATH_RATE: 0.5
  DROP_PATH_TYPE: linear
  DROP_RATE: 0.0
  INTERN_IMAGE:
    CENTER_FEATURE_SCALE: false
    CHANNELS: 112
    CORE_OP: DCNv3
    DEPTHS:
    - 4
    - 4
    - 21
    - 4
    DW_KERNEL_SIZE: null
    GROUPS:
    - 7
    - 14
    - 28
    - 56
    LAYER_SCALE: 1.0e-05
    LEVEL2_POST_NORM: false
    LEVEL2_POST_NORM_BLOCK_IDS: null
    MLP_RATIO: 4.0
    OFFSET_SCALE: 1.0
    POST_NORM: true
    REMOVE_CENTER: false
    RES_POST_NORM: false
    USE_CLIP_PROJECTOR: false
  LABEL_SMOOTHING: 0.0
  NAME: internimage_b_mimic_cxr_224
  NUM_CLASSES: 14
  PRETRAINED: pretrained/internimage_b_1k_224.pth
  RESUME: ''
  TYPE: intern_image
OUTPUT: output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224
PRINT_FREQ: 50
SAVE_CKPT_NUM: 1
SAVE_FREQ: 1
SEED: 42
TAG: run1
TEST:
  CROP: true
  SEQUENTIAL: false
THROUGHPUT_MODE: false
TRAIN:
  ACCUMULATION_STEPS: 1
  AUTO_RESUME: true
  BASE_LR: 0.0001
  CLIP_GRAD: 5.0
  EMA:
    DECAY: 0.9999
    ENABLE: true
  EPOCHS: 20
  LR_LAYER_DECAY: true
  LR_LAYER_DECAY_RATIO: 0.875
  LR_SCHEDULER:
    DECAY_EPOCHS: 30
    DECAY_RATE: 0.1
    NAME: cosine
  MIN_LR: 1.0e-06
  OPTIMIZER:
    BETAS:
    - 0.9
    - 0.999
    DCN_LR_MUL: null
    EPS: 1.0e-08
    FREEZE_BACKBONE: null
    MOMENTUM: 0.9
    NAME: adamw
    USE_ZERO: false
  RAND_INIT_FT_HEAD: true
  START_EPOCH: 0
  USE_CHECKPOINT: false
  WARMUP_EPOCHS: 2
  WARMUP_LR: 5.0e-07
  WEIGHT_DECAY: 0.05

[2025-11-19 02:31:54 internimage_b_mimic_cxr_224] (main.py 175): INFO Creating model:intern_image/internimage_b_mimic_cxr_224
[2025-11-19 02:31:56 internimage_b_mimic_cxr_224] (main.py 178): INFO InternImage(
  (patch_embed): StemLayer(
    (conv1): Conv2d(3, 56, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm1): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((56,), eps=1e-06, elementwise_affine=True)
      (2): to_channels_first()
    )
    (act): GELU(approximate='none')
    (conv2): Conv2d(56, 112, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm2): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
    )
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (levels): ModuleList(
    (0): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): Identity()
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.016)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.031)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.047)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (1): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.062)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.078)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.094)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.109)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (2): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.125)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.141)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.156)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.172)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (4): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.188)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (5): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.203)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (6): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.219)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (7): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.234)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (8): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.250)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (9): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.266)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (10): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.281)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (11): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.297)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (12): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.312)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (13): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.328)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (14): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.344)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (15): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.359)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (16): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.375)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (17): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.391)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (18): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.406)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (19): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.422)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (20): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.438)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(448, 896, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (3): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.453)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.469)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.484)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.500)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (conv_head): Sequential(
    (0): Conv2d(896, 1344, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (1): Sequential(
      (0): BatchNorm2d(1344, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): GELU(approximate='none')
  )
  (head): Linear(in_features=1344, out_features=14, bias=True)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
[2025-11-19 02:31:56 internimage_b_mimic_cxr_224] (main.py 214): INFO Using native Torch AMP. Training in mixed precision.
[2025-11-19 02:31:56 internimage_b_mimic_cxr_224] (main.py 226): INFO using fp16_compress_hook!
[2025-11-19 02:31:56 internimage_b_mimic_cxr_224] (main.py 234): INFO number of params: 96135662
[2025-11-19 02:31:56 internimage_b_mimic_cxr_224] (main.py 247): INFO Using BCEWithLogitsLoss for multi-label classification
[2025-11-19 02:31:56 internimage_b_mimic_cxr_224] (main.py 270): INFO auto resuming from output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_1.pth
[2025-11-19 02:31:56 internimage_b_mimic_cxr_224] (utils.py 60): INFO ==============> Resuming form output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_1.pth....................
[2025-11-19 02:31:59 internimage_b_mimic_cxr_224] (utils.py 92): INFO <All keys matched successfully>
[2025-11-19 02:32:00 internimage_b_mimic_cxr_224] (utils.py 110): INFO => loaded successfully output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_1.pth (epoch 1)
[2025-11-19 02:32:52 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 52.030 (52.030)	Loss 0.2850 (0.2850)	Mem 4564MB
[2025-11-19 02:33:45 internimage_b_mimic_cxr_224] (utils_multilabel.py 141): INFO  * Mean AUC-ROC 0.7640 Loss 0.2478
[2025-11-19 02:33:45 internimage_b_mimic_cxr_224] (utils_multilabel.py 142): INFO  * Per-class AUC-ROC: ['0.8065', '0.7917', '0.7718', '0.8881', '0.6979', '0.5621', '0.6628', '0.7247', '0.8409', '0.8988', '0.6852', '0.7169', '0.7489', '0.8997']
[2025-11-19 02:33:45 internimage_b_mimic_cxr_224] (main.py 283): INFO AUC-ROC of the network on the 2991 val images: 0.7640
[2025-11-19 02:33:45 internimage_b_mimic_cxr_224] (utils.py 24): INFO ==============> Resuming form output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_1.pth....................
[2025-11-19 02:43:03 internimage_b_mimic_cxr_224] (main.py 729): INFO Full config saved to output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/config.json
[2025-11-19 02:43:03 internimage_b_mimic_cxr_224] (main.py 732): INFO AMP_OPT_LEVEL: O1
AMP_TYPE: float16
AUG:
  AUTO_AUGMENT: none
  COLOR_JITTER: 0.0
  CUTMIX: 0.0
  CUTMIX_MINMAX: null
  MEAN:
  - 0.485
  - 0.456
  - 0.406
  MIXUP: 0.0
  MIXUP_MODE: batch
  MIXUP_PROB: 0.0
  MIXUP_SWITCH_PROB: 0.0
  RANDOM_RESIZED_CROP: false
  RECOUNT: 1
  REMODE: pixel
  REPROB: 0.1
  STD:
  - 0.229
  - 0.224
  - 0.225
BASE:
- ''
DATA:
  BATCH_SIZE: 128
  CACHE_MODE: part
  DATASET: mimic_cxr
  DATA_PATH: /scratch/smehta90/mimic_splits
  IMG_ON_MEMORY: false
  IMG_SIZE: 224
  INTERPOLATION: bicubic
  NUM_WORKERS: 12
  PIN_MEMORY: true
  ZIP_MODE: false
EVAL_22K_TO_1K: false
EVAL_FREQ: 1
EVAL_MODE: false
LOCAL_RANK: 0
MODEL:
  DROP_PATH_RATE: 0.5
  DROP_PATH_TYPE: linear
  DROP_RATE: 0.0
  INTERN_IMAGE:
    CENTER_FEATURE_SCALE: false
    CHANNELS: 112
    CORE_OP: DCNv3
    DEPTHS:
    - 4
    - 4
    - 21
    - 4
    DW_KERNEL_SIZE: null
    GROUPS:
    - 7
    - 14
    - 28
    - 56
    LAYER_SCALE: 1.0e-05
    LEVEL2_POST_NORM: false
    LEVEL2_POST_NORM_BLOCK_IDS: null
    MLP_RATIO: 4.0
    OFFSET_SCALE: 1.0
    POST_NORM: true
    REMOVE_CENTER: false
    RES_POST_NORM: false
    USE_CLIP_PROJECTOR: false
  LABEL_SMOOTHING: 0.0
  NAME: internimage_b_mimic_cxr_224
  NUM_CLASSES: 14
  PRETRAINED: pretrained/internimage_b_1k_224.pth
  RESUME: ''
  TYPE: intern_image
OUTPUT: output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224
PRINT_FREQ: 50
SAVE_CKPT_NUM: 1
SAVE_FREQ: 1
SEED: 42
TAG: run1
TEST:
  CROP: true
  SEQUENTIAL: false
THROUGHPUT_MODE: false
TRAIN:
  ACCUMULATION_STEPS: 1
  AUTO_RESUME: true
  BASE_LR: 0.0001
  CLIP_GRAD: 5.0
  EMA:
    DECAY: 0.9999
    ENABLE: true
  EPOCHS: 20
  LR_LAYER_DECAY: true
  LR_LAYER_DECAY_RATIO: 0.875
  LR_SCHEDULER:
    DECAY_EPOCHS: 30
    DECAY_RATE: 0.1
    NAME: cosine
  MIN_LR: 1.0e-06
  OPTIMIZER:
    BETAS:
    - 0.9
    - 0.999
    DCN_LR_MUL: null
    EPS: 1.0e-08
    FREEZE_BACKBONE: null
    MOMENTUM: 0.9
    NAME: adamw
    USE_ZERO: false
  RAND_INIT_FT_HEAD: true
  START_EPOCH: 0
  USE_CHECKPOINT: false
  WARMUP_EPOCHS: 2
  WARMUP_LR: 5.0e-07
  WEIGHT_DECAY: 0.05

[2025-11-19 02:43:04 internimage_b_mimic_cxr_224] (main.py 175): INFO Creating model:intern_image/internimage_b_mimic_cxr_224
[2025-11-19 02:43:05 internimage_b_mimic_cxr_224] (main.py 178): INFO InternImage(
  (patch_embed): StemLayer(
    (conv1): Conv2d(3, 56, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm1): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((56,), eps=1e-06, elementwise_affine=True)
      (2): to_channels_first()
    )
    (act): GELU(approximate='none')
    (conv2): Conv2d(56, 112, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm2): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
    )
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (levels): ModuleList(
    (0): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): Identity()
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.016)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.031)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.047)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (1): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.062)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.078)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.094)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.109)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (2): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.125)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.141)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.156)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.172)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (4): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.188)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (5): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.203)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (6): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.219)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (7): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.234)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (8): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.250)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (9): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.266)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (10): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.281)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (11): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.297)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (12): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.312)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (13): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.328)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (14): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.344)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (15): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.359)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (16): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.375)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (17): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.391)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (18): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.406)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (19): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.422)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (20): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.438)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(448, 896, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (3): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.453)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.469)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.484)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.500)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (conv_head): Sequential(
    (0): Conv2d(896, 1344, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (1): Sequential(
      (0): BatchNorm2d(1344, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): GELU(approximate='none')
  )
  (head): Linear(in_features=1344, out_features=14, bias=True)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
[2025-11-19 02:43:05 internimage_b_mimic_cxr_224] (main.py 214): INFO Using native Torch AMP. Training in mixed precision.
[2025-11-19 02:43:05 internimage_b_mimic_cxr_224] (main.py 226): INFO using fp16_compress_hook!
[2025-11-19 02:43:05 internimage_b_mimic_cxr_224] (main.py 234): INFO number of params: 96135662
[2025-11-19 02:43:05 internimage_b_mimic_cxr_224] (main.py 247): INFO Using BCEWithLogitsLoss for multi-label classification
[2025-11-19 02:43:05 internimage_b_mimic_cxr_224] (main.py 270): INFO auto resuming from output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_1.pth
[2025-11-19 02:43:05 internimage_b_mimic_cxr_224] (utils.py 60): INFO ==============> Resuming form output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_1.pth....................
[2025-11-19 02:43:08 internimage_b_mimic_cxr_224] (utils.py 92): INFO <All keys matched successfully>
[2025-11-19 02:43:08 internimage_b_mimic_cxr_224] (utils.py 110): INFO => loaded successfully output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_1.pth (epoch 1)
[2025-11-19 02:43:34 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 25.423 (25.423)	Loss 0.2850 (0.2850)	Mem 4564MB
[2025-11-19 02:43:54 internimage_b_mimic_cxr_224] (utils_multilabel.py 141): INFO  * Mean AUC-ROC 0.7640 Loss 0.2478
[2025-11-19 02:43:54 internimage_b_mimic_cxr_224] (utils_multilabel.py 142): INFO  * Per-class AUC-ROC: ['0.8065', '0.7917', '0.7718', '0.8881', '0.6979', '0.5621', '0.6628', '0.7247', '0.8409', '0.8988', '0.6852', '0.7169', '0.7489', '0.8997']
[2025-11-19 02:43:54 internimage_b_mimic_cxr_224] (main.py 283): INFO AUC-ROC of the network on the 2991 val images: 0.7640
[2025-11-19 02:43:54 internimage_b_mimic_cxr_224] (utils.py 24): INFO ==============> Resuming form output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_1.pth....................
[2025-11-19 02:43:56 internimage_b_mimic_cxr_224] (utils.py 44): INFO <All keys matched successfully>
[2025-11-19 02:43:56 internimage_b_mimic_cxr_224] (utils.py 45): INFO Loaded state_dict_ema
[2025-11-19 02:44:06 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 9.438 (9.438)	Loss 0.4714 (0.4714)	Mem 4564MB
[2025-11-19 02:44:18 internimage_b_mimic_cxr_224] (utils_multilabel.py 141): INFO  * Mean AUC-ROC 0.6757 Loss 0.4496
[2025-11-19 02:44:18 internimage_b_mimic_cxr_224] (utils_multilabel.py 142): INFO  * Per-class AUC-ROC: ['0.7060', '0.7052', '0.7025', '0.8033', '0.6157', '0.4255', '0.6111', '0.6759', '0.7917', '0.7843', '0.6070', '0.5901', '0.5978', '0.8441']
[2025-11-19 02:44:18 internimage_b_mimic_cxr_224] (main.py 315): INFO AUC-ROC of the ema network on the 2991 val images: 0.6757
[2025-11-19 02:44:18 internimage_b_mimic_cxr_224] (main.py 331): INFO Start training
[2025-11-19 02:45:23 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][0/2882]	eta 2 days, 4:09:30 lr 0.000001	time 65.1530 (65.1530)	model_time 18.6039 (18.6039)	loss 0.2585 (0.2585)	grad_norm 1.2948 (1.2948/0.0000)	mem 34249MB
[2025-11-19 02:47:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][50/2882]	eta 3:01:24 lr 0.000001	time 2.7280 (3.8435)	model_time 0.6414 (0.9937)	loss 0.2385 (0.2485)	grad_norm 0.6038 (0.8927/0.2369)	mem 34628MB
[2025-11-19 02:49:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][100/2882]	eta 2:36:09 lr 0.000001	time 0.6348 (3.3679)	model_time 0.6344 (0.8186)	loss 0.2683 (0.2478)	grad_norm 0.7635 (0.8902/0.2307)	mem 34628MB
[2025-11-19 02:52:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][150/2882]	eta 2:23:05 lr 0.000001	time 0.6297 (3.1426)	model_time 0.6295 (0.7579)	loss 0.2291 (0.2482)	grad_norm 0.8161 (0.8837/0.2254)	mem 34628MB
[2025-11-19 02:54:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][200/2882]	eta 2:17:46 lr 0.000001	time 0.6297 (3.0821)	model_time 0.6295 (0.7283)	loss 0.2573 (0.2493)	grad_norm 0.9257 (0.8722/0.2225)	mem 34628MB
[2025-11-19 02:57:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][250/2882]	eta 2:15:39 lr 0.000001	time 0.6388 (3.0923)	model_time 0.6386 (0.7088)	loss 0.2426 (0.2496)	grad_norm 0.6211 (0.8735/0.2295)	mem 34628MB
[2025-11-19 03:00:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][300/2882]	eta 2:16:01 lr 0.000001	time 13.1004 (3.1607)	model_time 0.6380 (0.6970)	loss 0.2433 (0.2504)	grad_norm 0.4853 (0.8719/0.2306)	mem 34628MB
[2025-11-19 03:02:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][350/2882]	eta 2:10:34 lr 0.000001	time 0.6358 (3.0943)	model_time 0.6356 (0.6894)	loss 0.2661 (0.2501)	grad_norm 0.7619 (0.8604/0.2273)	mem 34628MB
[2025-11-19 03:04:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][400/2882]	eta 2:05:44 lr 0.000001	time 0.6357 (3.0397)	model_time 0.6355 (0.6827)	loss 0.2816 (0.2497)	grad_norm 0.9494 (0.8560/0.2245)	mem 34628MB
[2025-11-19 03:07:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][450/2882]	eta 2:03:17 lr 0.000001	time 6.3107 (3.0419)	model_time 0.6389 (0.6781)	loss 0.2239 (0.2498)	grad_norm 1.0196 (0.8439/0.2297)	mem 34628MB
[2025-11-19 03:09:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][500/2882]	eta 2:00:58 lr 0.000001	time 0.6405 (3.0473)	model_time 0.6402 (0.6743)	loss 0.2382 (0.2496)	grad_norm 0.8302 (0.8478/0.2327)	mem 34628MB
[2025-11-19 03:12:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][550/2882]	eta 1:57:16 lr 0.000001	time 0.6380 (3.0172)	model_time 0.6378 (0.6715)	loss 0.2213 (0.2494)	grad_norm 0.5923 (0.8429/0.2350)	mem 34628MB
[2025-11-19 03:14:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][600/2882]	eta 1:55:07 lr 0.000001	time 24.0910 (3.0269)	model_time 0.6415 (0.6691)	loss 0.2402 (0.2493)	grad_norm 1.1011 (0.8431/0.2294)	mem 34628MB
[2025-11-19 03:16:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][650/2882]	eta 1:51:30 lr 0.000001	time 0.6314 (2.9973)	model_time 0.6311 (0.6669)	loss 0.2534 (0.2493)	grad_norm 0.9420 (0.8424/0.2258)	mem 34628MB
[2025-11-19 03:19:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][700/2882]	eta 1:48:55 lr 0.000001	time 0.6313 (2.9950)	model_time 0.6312 (0.6643)	loss 0.2594 (0.2495)	grad_norm 1.0239 (0.8373/0.2256)	mem 34628MB
[2025-11-19 03:21:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][750/2882]	eta 1:45:54 lr 0.000001	time 17.4389 (2.9807)	model_time 0.6420 (0.6621)	loss 0.2464 (0.2495)	grad_norm 1.1162 (0.8490/0.2212)	mem 34628MB
[2025-11-19 03:23:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][800/2882]	eta 1:42:41 lr 0.000001	time 0.6308 (2.9593)	model_time 0.6305 (0.6608)	loss 0.2515 (0.2492)	grad_norm 1.0114 (0.8495/0.2182)	mem 34629MB
[2025-11-19 03:26:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][850/2882]	eta 1:39:46 lr 0.000001	time 0.6302 (2.9461)	model_time 0.6299 (0.6590)	loss 0.2410 (0.2491)	grad_norm 0.6176 (0.8536/0.2067)	mem 34629MB
[2025-11-19 03:28:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][900/2882]	eta 1:37:45 lr 0.000001	time 10.5268 (2.9596)	model_time 0.6275 (0.6573)	loss 0.2248 (0.2491)	grad_norm 0.6796 (0.8460/0.2109)	mem 34629MB
[2025-11-19 03:31:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][950/2882]	eta 1:35:06 lr 0.000001	time 0.6405 (2.9538)	model_time 0.6402 (0.6560)	loss 0.2425 (0.2490)	grad_norm 0.8004 (0.8506/0.2159)	mem 34629MB
[2025-11-19 03:33:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1000/2882]	eta 1:32:07 lr 0.000001	time 0.6400 (2.9369)	model_time 0.6397 (0.6555)	loss 0.2716 (0.2492)	grad_norm 1.1526 (0.8600/0.2124)	mem 34629MB
[2025-11-19 03:35:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1050/2882]	eta 1:30:00 lr 0.000001	time 24.5991 (2.9478)	model_time 0.6385 (0.6548)	loss 0.2652 (0.2491)	grad_norm 1.2914 (0.8624/0.2099)	mem 34629MB
[2025-11-19 03:38:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1100/2882]	eta 1:27:23 lr 0.000001	time 0.6307 (2.9427)	model_time 0.6302 (0.6539)	loss 0.2688 (0.2491)	grad_norm 1.5078 (0.8631/0.2141)	mem 34629MB
[2025-11-19 03:40:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1150/2882]	eta 1:25:11 lr 0.000001	time 0.6298 (2.9512)	model_time 0.6295 (0.6530)	loss 0.2273 (0.2491)	grad_norm 1.2529 (0.8637/0.2199)	mem 34629MB
[2025-11-19 03:43:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1200/2882]	eta 1:22:13 lr 0.000001	time 0.6278 (2.9330)	model_time 0.6276 (0.6520)	loss 0.2504 (0.2492)	grad_norm 0.7290 (0.8699/0.2241)	mem 34629MB
[2025-11-19 03:45:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1250/2882]	eta 1:19:29 lr 0.000001	time 1.2084 (2.9224)	model_time 0.6333 (0.6511)	loss 0.2535 (0.2491)	grad_norm 1.0138 (0.8857/0.2295)	mem 34629MB
[2025-11-19 03:47:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1300/2882]	eta 1:16:53 lr 0.000001	time 0.6288 (2.9163)	model_time 0.6286 (0.6504)	loss 0.2386 (0.2492)	grad_norm 0.9284 (0.8844/0.2421)	mem 34629MB
[2025-11-19 03:50:22 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1350/2882]	eta 1:14:55 lr 0.000001	time 29.1754 (2.9343)	model_time 0.6319 (0.6496)	loss 0.2242 (0.2490)	grad_norm 0.8546 (0.8780/0.2505)	mem 34629MB
[2025-11-19 03:52:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1400/2882]	eta 1:12:18 lr 0.000001	time 0.6269 (2.9273)	model_time 0.6266 (0.6489)	loss 0.2412 (0.2491)	grad_norm 0.8515 (0.8775/0.2565)	mem 34629MB
[2025-11-19 03:54:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1450/2882]	eta 1:09:44 lr 0.000001	time 0.6293 (2.9219)	model_time 0.6290 (0.6483)	loss 0.2520 (0.2491)	grad_norm 1.1305 (0.8786/0.2483)	mem 34629MB
[2025-11-19 03:57:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1500/2882]	eta 1:07:09 lr 0.000001	time 0.6307 (2.9160)	model_time 0.6305 (0.6477)	loss 0.2667 (0.2491)	grad_norm 0.7867 (0.8842/0.2499)	mem 34629MB
[2025-11-19 03:59:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1550/2882]	eta 1:04:47 lr 0.000001	time 0.6318 (2.9182)	model_time 0.6316 (0.6473)	loss 0.2324 (0.2491)	grad_norm 0.5868 (0.8721/0.2450)	mem 34629MB
[2025-11-19 04:01:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1600/2882]	eta 1:02:10 lr 0.000001	time 0.6312 (2.9103)	model_time 0.6310 (0.6468)	loss 0.2524 (0.2489)	grad_norm 0.9303 (0.8797/0.2405)	mem 34629MB
[2025-11-19 04:04:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1650/2882]	eta 0:59:43 lr 0.000001	time 10.5356 (2.9088)	model_time 0.6298 (0.6463)	loss 0.2383 (0.2489)	grad_norm 0.6812 (0.8769/0.2326)	mem 34629MB
[2025-11-19 04:06:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1700/2882]	eta 0:57:20 lr 0.000001	time 0.6402 (2.9111)	model_time 0.6399 (0.6460)	loss 0.2302 (0.2489)	grad_norm 0.8835 (0.8784/0.2272)	mem 34629MB
[2025-11-19 04:09:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1750/2882]	eta 0:54:51 lr 0.000001	time 0.6389 (2.9077)	model_time 0.6386 (0.6458)	loss 0.2385 (0.2488)	grad_norm 0.6548 (0.8726/0.2268)	mem 34629MB
[2025-11-19 04:11:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1800/2882]	eta 0:52:17 lr 0.000001	time 0.6274 (2.9001)	model_time 0.6271 (0.6455)	loss 0.2402 (0.2487)	grad_norm 0.9299 (0.8689/0.2275)	mem 34629MB
[2025-11-19 04:13:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1850/2882]	eta 0:49:48 lr 0.000001	time 13.1654 (2.8958)	model_time 0.6316 (0.6451)	loss 0.2336 (0.2487)	grad_norm 0.8566 (0.8757/0.2353)	mem 34629MB
[2025-11-19 04:15:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1900/2882]	eta 0:47:12 lr 0.000001	time 0.6290 (2.8846)	model_time 0.6288 (0.6447)	loss 0.2308 (0.2486)	grad_norm 0.5503 (0.8642/0.2348)	mem 34629MB
[2025-11-19 04:18:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][1950/2882]	eta 0:44:46 lr 0.000001	time 10.3846 (2.8826)	model_time 0.6295 (0.6444)	loss 0.2462 (0.2487)	grad_norm 0.7868 (0.8738/0.2374)	mem 34629MB
[2025-11-19 04:20:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2000/2882]	eta 0:42:29 lr 0.000001	time 0.6286 (2.8904)	model_time 0.6284 (0.6440)	loss 0.2462 (0.2487)	grad_norm 1.2741 (0.8829/0.2418)	mem 34629MB
[2025-11-19 04:22:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2050/2882]	eta 0:39:55 lr 0.000001	time 0.6280 (2.8791)	model_time 0.6277 (0.6436)	loss 0.2490 (0.2485)	grad_norm 0.6709 (0.8884/0.2421)	mem 34629MB
[2025-11-19 04:24:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2100/2882]	eta 0:37:25 lr 0.000001	time 0.6385 (2.8709)	model_time 0.6379 (0.6433)	loss 0.2317 (0.2485)	grad_norm 0.6114 (0.8839/0.2290)	mem 34629MB
[2025-11-19 04:27:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2150/2882]	eta 0:34:56 lr 0.000001	time 6.5885 (2.8647)	model_time 0.6409 (0.6434)	loss 0.2422 (0.2485)	grad_norm 1.5730 (0.8899/0.2272)	mem 34629MB
[2025-11-19 04:29:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2200/2882]	eta 0:32:27 lr 0.000001	time 0.6390 (2.8561)	model_time 0.6385 (0.6433)	loss 0.2541 (0.2485)	grad_norm 0.6159 (0.8900/0.2248)	mem 34629MB
[2025-11-19 04:31:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2250/2882]	eta 0:30:04 lr 0.000001	time 7.8477 (2.8546)	model_time 0.6409 (0.6433)	loss 0.2200 (0.2485)	grad_norm 0.8509 (0.8891/0.2254)	mem 34629MB
[2025-11-19 04:33:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2300/2882]	eta 0:27:43 lr 0.000001	time 0.6366 (2.8583)	model_time 0.6363 (0.6433)	loss 0.2467 (0.2484)	grad_norm 0.7358 (0.8879/0.2210)	mem 34629MB
[2025-11-19 04:35:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2350/2882]	eta 0:25:16 lr 0.000001	time 0.6370 (2.8503)	model_time 0.6367 (0.6433)	loss 0.2530 (0.2484)	grad_norm 0.9269 (0.8761/0.2219)	mem 34629MB
[2025-11-19 04:38:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2400/2882]	eta 0:22:50 lr 0.000001	time 0.6316 (2.8429)	model_time 0.6313 (0.6431)	loss 0.2319 (0.2483)	grad_norm 0.8865 (0.8714/0.2243)	mem 34629MB
[2025-11-19 04:40:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2450/2882]	eta 0:20:26 lr 0.000001	time 0.6335 (2.8389)	model_time 0.6331 (0.6429)	loss 0.2291 (0.2483)	grad_norm 1.1478 (0.8580/0.2230)	mem 34629MB
[2025-11-19 04:42:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2500/2882]	eta 0:18:05 lr 0.000001	time 0.6245 (2.8410)	model_time 0.6244 (0.6427)	loss 0.2416 (0.2482)	grad_norm 0.9074 (0.8619/0.2150)	mem 34629MB
[2025-11-19 04:44:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2550/2882]	eta 0:15:40 lr 0.000001	time 1.4182 (2.8331)	model_time 0.6281 (0.6425)	loss 0.2223 (0.2481)	grad_norm 0.7622 (0.8636/0.2296)	mem 34629MB
[2025-11-19 04:47:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2600/2882]	eta 0:13:19 lr 0.000001	time 0.6308 (2.8344)	model_time 0.6304 (0.6423)	loss 0.2748 (0.2482)	grad_norm 0.8257 (0.8617/0.2214)	mem 34629MB
[2025-11-19 04:49:17 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2650/2882]	eta 0:10:56 lr 0.000001	time 0.6285 (2.8289)	model_time 0.6283 (0.6420)	loss 0.3056 (0.2481)	grad_norm 1.7354 (0.8709/0.2315)	mem 34629MB
[2025-11-19 04:51:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2700/2882]	eta 0:08:34 lr 0.000001	time 0.6308 (2.8259)	model_time 0.6305 (0.6418)	loss 0.2432 (0.2481)	grad_norm 0.7337 (0.8734/0.2426)	mem 34629MB
[2025-11-19 04:53:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2750/2882]	eta 0:06:12 lr 0.000001	time 0.6279 (2.8254)	model_time 0.6277 (0.6417)	loss 0.2539 (0.2481)	grad_norm 1.0305 (0.8798/0.2390)	mem 34629MB
[2025-11-19 04:55:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2800/2882]	eta 0:03:51 lr 0.000001	time 0.6344 (2.8207)	model_time 0.6341 (0.6415)	loss 0.2585 (0.2480)	grad_norm 0.8733 (0.8788/0.2451)	mem 34629MB
[2025-11-19 04:58:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [2/20][2850/2882]	eta 0:01:30 lr 0.000001	time 0.6385 (2.8152)	model_time 0.6382 (0.6414)	loss 0.2205 (0.2480)	grad_norm 0.8214 (0.8694/0.2293)	mem 34629MB
[2025-11-19 04:59:36 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 2 training takes 2:15:18
[2025-11-19 04:59:36 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_2.pth saving......
[2025-11-19 04:59:39 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_2.pth saved !!!
[2025-11-19 05:00:14 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 35.261 (35.261)	Loss 0.2801 (0.2801)	Mem 34629MB
[2025-11-19 05:00:57 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:2] * Mean AUC-ROC 0.7789 Loss 0.2422
[2025-11-19 05:00:57 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:2] * Per-class AUC-ROC: ['0.8186', '0.8084', '0.7902', '0.8967', '0.7150', '0.5838', '0.6677', '0.7274', '0.8473', '0.9105', '0.7053', '0.7299', '0.7970', '0.9072']
[2025-11-19 05:00:57 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.7789
[2025-11-19 05:00:57 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-19 05:01:01 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-19 05:01:01 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.7789
[2025-11-19 05:01:09 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 8.631 (8.631)	Loss 0.3828 (0.3828)	Mem 34629MB
[2025-11-19 05:01:22 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:2] * Mean AUC-ROC 0.7124 Loss 0.3594
[2025-11-19 05:01:22 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:2] * Per-class AUC-ROC: ['0.7509', '0.7456', '0.7422', '0.8531', '0.6581', '0.4023', '0.6690', '0.7011', '0.8181', '0.8364', '0.6330', '0.6503', '0.6394', '0.8736']
[2025-11-19 05:01:22 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.7124
[2025-11-19 05:01:22 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-19 05:01:25 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-19 05:01:25 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.7124
[2025-11-19 05:01:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][0/2882]	eta 1 day, 3:23:03 lr 0.000001	time 34.2067 (34.2067)	model_time 0.6286 (0.6286)	loss 0.2593 (0.2593)	grad_norm 0.9125 (0.9125/0.0000)	mem 34629MB
[2025-11-19 05:04:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][50/2882]	eta 2:31:43 lr 0.000001	time 6.8249 (3.2145)	model_time 0.6246 (0.6285)	loss 0.2328 (0.2530)	grad_norm 0.5709 (0.8723/0.2147)	mem 34629MB
[2025-11-19 05:06:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][100/2882]	eta 2:10:16 lr 0.000001	time 0.6367 (2.8097)	model_time 0.6364 (0.6311)	loss 0.2601 (0.2486)	grad_norm 0.6457 (0.8360/0.2058)	mem 34629MB
[2025-11-19 05:08:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][150/2882]	eta 2:13:01 lr 0.000001	time 0.6399 (2.9214)	model_time 0.6396 (0.6346)	loss 0.2354 (0.2485)	grad_norm 0.7760 (0.8542/0.2100)	mem 34629MB
[2025-11-19 05:11:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][200/2882]	eta 2:09:48 lr 0.000001	time 0.6447 (2.9041)	model_time 0.6443 (0.6362)	loss 0.2375 (0.2482)	grad_norm 0.6326 (0.8757/0.2195)	mem 34629MB
[2025-11-19 05:13:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][250/2882]	eta 2:07:07 lr 0.000001	time 0.6394 (2.8979)	model_time 0.6392 (0.6367)	loss 0.2251 (0.2474)	grad_norm 0.7184 (0.8767/0.2316)	mem 34629MB
[2025-11-19 05:16:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][300/2882]	eta 2:05:06 lr 0.000001	time 7.5609 (2.9074)	model_time 0.6286 (0.6369)	loss 0.2326 (0.2471)	grad_norm 0.8371 (0.8744/0.2376)	mem 34629MB
[2025-11-19 05:18:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][350/2882]	eta 2:05:56 lr 0.000001	time 21.7794 (2.9843)	model_time 0.6322 (0.6360)	loss 0.2486 (0.2466)	grad_norm 1.1706 (0.8782/0.2431)	mem 34629MB
[2025-11-19 05:21:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][400/2882]	eta 2:02:37 lr 0.000001	time 0.6324 (2.9644)	model_time 0.6322 (0.6356)	loss 0.2407 (0.2460)	grad_norm 0.5418 (0.8886/0.2521)	mem 34629MB
[2025-11-19 05:23:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][450/2882]	eta 2:00:01 lr 0.000001	time 0.6308 (2.9612)	model_time 0.6306 (0.6351)	loss 0.2436 (0.2459)	grad_norm 1.1610 (0.8880/0.2501)	mem 34629MB
[2025-11-19 05:26:23 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][500/2882]	eta 1:58:40 lr 0.000001	time 0.6426 (2.9895)	model_time 0.6422 (0.6355)	loss 0.2682 (0.2453)	grad_norm 0.8953 (0.8726/0.2501)	mem 34629MB
[2025-11-19 05:28:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][550/2882]	eta 1:55:11 lr 0.000001	time 0.6387 (2.9638)	model_time 0.6384 (0.6365)	loss 0.2608 (0.2454)	grad_norm 1.2505 (0.8769/0.2540)	mem 34629MB
[2025-11-19 05:31:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][600/2882]	eta 1:53:11 lr 0.000001	time 17.4958 (2.9763)	model_time 0.6378 (0.6368)	loss 0.2370 (0.2455)	grad_norm 0.8166 (0.8695/0.2510)	mem 34629MB
[2025-11-19 05:33:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][650/2882]	eta 1:49:47 lr 0.000001	time 0.6382 (2.9515)	model_time 0.6378 (0.6371)	loss 0.2545 (0.2454)	grad_norm 1.1832 (0.8849/0.2556)	mem 34629MB
[2025-11-19 05:35:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][700/2882]	eta 1:46:20 lr 0.000001	time 0.6443 (2.9241)	model_time 0.6438 (0.6377)	loss 0.2163 (0.2453)	grad_norm 0.8874 (0.8862/0.2509)	mem 34629MB
[2025-11-19 05:37:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][750/2882]	eta 1:43:17 lr 0.000001	time 0.6375 (2.9069)	model_time 0.6372 (0.6379)	loss 0.2353 (0.2452)	grad_norm 1.1407 (0.8840/0.2515)	mem 34629MB
[2025-11-19 05:40:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][800/2882]	eta 1:41:30 lr 0.000001	time 0.6346 (2.9254)	model_time 0.6344 (0.6376)	loss 0.2679 (0.2449)	grad_norm 0.9250 (0.8866/0.2476)	mem 34629MB
[2025-11-19 05:42:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][850/2882]	eta 1:38:16 lr 0.000001	time 0.6304 (2.9016)	model_time 0.6301 (0.6373)	loss 0.2338 (0.2449)	grad_norm 0.7157 (0.8738/0.2306)	mem 34629MB
[2025-11-19 05:45:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][900/2882]	eta 1:36:01 lr 0.000001	time 21.0644 (2.9070)	model_time 0.6261 (0.6366)	loss 0.2451 (0.2448)	grad_norm 1.0663 (0.8882/0.2359)	mem 34629MB
[2025-11-19 05:47:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][950/2882]	eta 1:32:55 lr 0.000001	time 0.6363 (2.8856)	model_time 0.6360 (0.6366)	loss 0.2200 (0.2447)	grad_norm 0.6043 (0.8720/0.2268)	mem 34629MB
[2025-11-19 05:49:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1000/2882]	eta 1:31:06 lr 0.000001	time 0.6372 (2.9047)	model_time 0.6370 (0.6371)	loss 0.2000 (0.2446)	grad_norm 0.8668 (0.8744/0.2342)	mem 34629MB
[2025-11-19 05:51:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1050/2882]	eta 1:27:56 lr 0.000001	time 0.6391 (2.8802)	model_time 0.6382 (0.6372)	loss 0.2444 (0.2446)	grad_norm 1.1815 (0.8719/0.2371)	mem 34629MB
[2025-11-19 05:54:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1100/2882]	eta 1:25:09 lr 0.000001	time 0.6365 (2.8675)	model_time 0.6362 (0.6375)	loss 0.2469 (0.2447)	grad_norm 0.7907 (0.8679/0.2340)	mem 34629MB
[2025-11-19 05:56:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1150/2882]	eta 1:22:26 lr 0.000001	time 0.6342 (2.8558)	model_time 0.6339 (0.6376)	loss 0.2354 (0.2445)	grad_norm 0.6924 (0.8723/0.2348)	mem 34629MB
[2025-11-19 05:58:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1200/2882]	eta 1:20:24 lr 0.000001	time 23.7799 (2.8680)	model_time 0.6468 (0.6374)	loss 0.2110 (0.2445)	grad_norm 1.1512 (0.8688/0.2228)	mem 34629MB
[2025-11-19 06:01:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1250/2882]	eta 1:17:58 lr 0.000001	time 0.6392 (2.8670)	model_time 0.6389 (0.6376)	loss 0.2642 (0.2445)	grad_norm 0.9378 (0.8738/0.2251)	mem 34629MB
[2025-11-19 06:03:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1300/2882]	eta 1:15:17 lr 0.000001	time 0.6412 (2.8556)	model_time 0.6408 (0.6377)	loss 0.2562 (0.2444)	grad_norm 0.7359 (0.8665/0.2153)	mem 34629MB
[2025-11-19 06:05:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1350/2882]	eta 1:12:35 lr 0.000001	time 0.6428 (2.8433)	model_time 0.6423 (0.6379)	loss 0.2372 (0.2444)	grad_norm 0.8039 (0.8623/0.2138)	mem 34629MB
[2025-11-19 06:07:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1400/2882]	eta 1:10:04 lr 0.000001	time 0.6364 (2.8370)	model_time 0.6361 (0.6381)	loss 0.2142 (0.2443)	grad_norm 0.7248 (0.8634/0.2128)	mem 34629MB
[2025-11-19 06:09:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1450/2882]	eta 1:07:38 lr 0.000001	time 0.6296 (2.8344)	model_time 0.6294 (0.6378)	loss 0.2274 (0.2442)	grad_norm 0.9963 (0.8569/0.2183)	mem 34629MB
[2025-11-19 06:12:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1500/2882]	eta 1:05:32 lr 0.000001	time 9.8217 (2.8457)	model_time 0.6292 (0.6377)	loss 0.2536 (0.2443)	grad_norm 1.2280 (0.8479/0.2163)	mem 34629MB
[2025-11-19 06:14:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1550/2882]	eta 1:02:57 lr 0.000001	time 0.6297 (2.8359)	model_time 0.6294 (0.6375)	loss 0.2425 (0.2443)	grad_norm 0.7100 (0.8424/0.2216)	mem 34629MB
[2025-11-19 06:16:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1600/2882]	eta 1:00:23 lr 0.000001	time 0.6319 (2.8268)	model_time 0.6316 (0.6373)	loss 0.2483 (0.2442)	grad_norm 1.0719 (0.8485/0.2192)	mem 34629MB
[2025-11-19 06:19:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1650/2882]	eta 0:57:56 lr 0.000001	time 0.6312 (2.8217)	model_time 0.6309 (0.6372)	loss 0.2105 (0.2442)	grad_norm 0.9387 (0.8663/0.2318)	mem 34629MB
[2025-11-19 06:21:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1700/2882]	eta 0:55:39 lr 0.000001	time 0.6385 (2.8252)	model_time 0.6380 (0.6373)	loss 0.2644 (0.2443)	grad_norm 0.9159 (0.8636/0.2372)	mem 34629MB
[2025-11-19 06:23:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1750/2882]	eta 0:53:12 lr 0.000001	time 0.6382 (2.8199)	model_time 0.6380 (0.6374)	loss 0.2507 (0.2442)	grad_norm 0.8746 (0.8717/0.2406)	mem 34629MB
[2025-11-19 06:25:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1800/2882]	eta 0:50:38 lr 0.000001	time 5.0860 (2.8081)	model_time 0.6344 (0.6375)	loss 0.2619 (0.2442)	grad_norm 0.6197 (0.8726/0.2391)	mem 34629MB
[2025-11-19 06:27:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1850/2882]	eta 0:48:05 lr 0.000001	time 0.6386 (2.7956)	model_time 0.6383 (0.6377)	loss 0.2339 (0.2441)	grad_norm 0.6748 (0.8669/0.2367)	mem 34629MB
[2025-11-19 06:29:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1900/2882]	eta 0:45:41 lr 0.000001	time 0.6385 (2.7913)	model_time 0.6381 (0.6377)	loss 0.2547 (0.2441)	grad_norm 1.0240 (0.8725/0.2484)	mem 34629MB
[2025-11-19 06:32:08 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][1950/2882]	eta 0:43:20 lr 0.000001	time 0.6360 (2.7899)	model_time 0.6358 (0.6377)	loss 0.2388 (0.2441)	grad_norm 0.8811 (0.8541/0.2333)	mem 34629MB
[2025-11-19 06:34:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2000/2882]	eta 0:41:04 lr 0.000001	time 0.6310 (2.7938)	model_time 0.6308 (0.6377)	loss 0.2554 (0.2441)	grad_norm 0.9352 (0.8575/0.2259)	mem 34629MB
[2025-11-19 06:36:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2050/2882]	eta 0:38:40 lr 0.000001	time 0.6311 (2.7886)	model_time 0.6308 (0.6376)	loss 0.2362 (0.2441)	grad_norm 0.9123 (0.8627/0.2270)	mem 34629MB
[2025-11-19 06:38:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2100/2882]	eta 0:36:15 lr 0.000001	time 0.6308 (2.7817)	model_time 0.6306 (0.6374)	loss 0.2115 (0.2441)	grad_norm 1.0287 (0.8652/0.2284)	mem 34629MB
[2025-11-19 06:40:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2150/2882]	eta 0:33:52 lr 0.000001	time 0.6319 (2.7767)	model_time 0.6316 (0.6373)	loss 0.2477 (0.2440)	grad_norm 0.8904 (0.8571/0.2166)	mem 34629MB
[2025-11-19 06:43:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2200/2882]	eta 0:31:36 lr 0.000001	time 0.6283 (2.7803)	model_time 0.6281 (0.6371)	loss 0.2484 (0.2440)	grad_norm 0.8419 (0.8555/0.2055)	mem 34629MB
[2025-11-19 06:45:33 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2250/2882]	eta 0:29:14 lr 0.000001	time 0.9510 (2.7758)	model_time 0.6265 (0.6370)	loss 0.2177 (0.2439)	grad_norm 0.8790 (0.8633/0.2152)	mem 34629MB
[2025-11-19 06:47:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2300/2882]	eta 0:26:56 lr 0.000001	time 0.6305 (2.7770)	model_time 0.6302 (0.6368)	loss 0.2560 (0.2439)	grad_norm 0.7226 (0.8730/0.2227)	mem 34629MB
[2025-11-19 06:50:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2350/2882]	eta 0:24:36 lr 0.000001	time 0.6302 (2.7750)	model_time 0.6299 (0.6367)	loss 0.2172 (0.2439)	grad_norm 0.6279 (0.8767/0.2175)	mem 34629MB
[2025-11-19 06:52:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2400/2882]	eta 0:22:20 lr 0.000001	time 19.0085 (2.7807)	model_time 0.6314 (0.6366)	loss 0.2629 (0.2439)	grad_norm 1.1231 (0.8748/0.2254)	mem 34629MB
[2025-11-19 06:55:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2450/2882]	eta 0:20:03 lr 0.000001	time 0.6290 (2.7859)	model_time 0.6287 (0.6365)	loss 0.2397 (0.2438)	grad_norm 0.8915 (0.8837/0.2249)	mem 34629MB
[2025-11-19 06:57:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2500/2882]	eta 0:17:42 lr 0.000001	time 0.6347 (2.7824)	model_time 0.6345 (0.6365)	loss 0.2506 (0.2438)	grad_norm 0.9503 (0.8817/0.2256)	mem 34629MB
[2025-11-19 06:59:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2550/2882]	eta 0:15:22 lr 0.000001	time 0.6310 (2.7796)	model_time 0.6308 (0.6364)	loss 0.2421 (0.2438)	grad_norm 0.6976 (0.8710/0.2253)	mem 34629MB
[2025-11-19 07:01:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2600/2882]	eta 0:13:03 lr 0.000001	time 0.6274 (2.7782)	model_time 0.6271 (0.6363)	loss 0.2515 (0.2437)	grad_norm 0.5318 (0.8639/0.2253)	mem 34629MB
[2025-11-19 07:04:23 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2650/2882]	eta 0:10:45 lr 0.000001	time 0.6297 (2.7830)	model_time 0.6294 (0.6362)	loss 0.2684 (0.2437)	grad_norm 0.6616 (0.8659/0.2289)	mem 34629MB
[2025-11-19 07:06:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2700/2882]	eta 0:08:27 lr 0.000001	time 20.1684 (2.7893)	model_time 0.6290 (0.6362)	loss 0.2352 (0.2437)	grad_norm 0.9588 (0.8673/0.2252)	mem 34629MB
[2025-11-19 07:09:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2750/2882]	eta 0:06:08 lr 0.000001	time 0.6315 (2.7900)	model_time 0.6312 (0.6361)	loss 0.2408 (0.2437)	grad_norm 0.5393 (0.8628/0.2288)	mem 34629MB
[2025-11-19 07:11:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2800/2882]	eta 0:03:48 lr 0.000001	time 0.6366 (2.7887)	model_time 0.6363 (0.6360)	loss 0.2158 (0.2437)	grad_norm 1.6266 (0.8616/0.2341)	mem 34629MB
[2025-11-19 07:14:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [3/20][2850/2882]	eta 0:01:29 lr 0.000001	time 0.6303 (2.7910)	model_time 0.6300 (0.6359)	loss 0.2449 (0.2437)	grad_norm 0.8606 (0.8751/0.2420)	mem 34629MB
[2025-11-19 07:15:56 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 3 training takes 2:14:30
[2025-11-19 07:15:56 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_3.pth saving......
[2025-11-19 07:15:58 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_3.pth saved !!!
[2025-11-19 07:16:33 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 34.535 (34.535)	Loss 0.2777 (0.2777)	Mem 34629MB
[2025-11-19 07:17:15 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:3] * Mean AUC-ROC 0.7900 Loss 0.2397
[2025-11-19 07:17:15 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:3] * Per-class AUC-ROC: ['0.8235', '0.8162', '0.7963', '0.8998', '0.7269', '0.5744', '0.7002', '0.7323', '0.8526', '0.9154', '0.7332', '0.7409', '0.8358', '0.9125']
[2025-11-19 07:17:15 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.7900
[2025-11-19 07:17:15 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-19 07:17:19 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-19 07:17:19 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.7900
[2025-11-19 07:17:28 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 9.388 (9.388)	Loss 0.3394 (0.3394)	Mem 34629MB
[2025-11-19 07:17:40 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:3] * Mean AUC-ROC 0.7427 Loss 0.3142
[2025-11-19 07:17:40 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:3] * Per-class AUC-ROC: ['0.7812', '0.7649', '0.7635', '0.8751', '0.6788', '0.4835', '0.6836', '0.7127', '0.8316', '0.8686', '0.6738', '0.6911', '0.6988', '0.8906']
[2025-11-19 07:17:40 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.7427
[2025-11-19 07:17:41 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-19 07:17:43 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-19 07:17:43 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.7427
[2025-11-19 07:18:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][0/2882]	eta 1 day, 4:52:17 lr 0.000001	time 36.0642 (36.0642)	model_time 0.6313 (0.6313)	loss 0.2421 (0.2421)	grad_norm 0.9876 (0.9876/0.0000)	mem 34629MB
[2025-11-19 07:20:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][50/2882]	eta 2:21:33 lr 0.000001	time 0.6283 (2.9991)	model_time 0.6280 (0.6331)	loss 0.2340 (0.2418)	grad_norm 1.0459 (0.8709/0.2379)	mem 34629MB
[2025-11-19 07:22:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][100/2882]	eta 2:09:54 lr 0.000001	time 0.6517 (2.8018)	model_time 0.6514 (0.6375)	loss 0.2367 (0.2431)	grad_norm 0.7778 (0.8921/0.2483)	mem 34629MB
[2025-11-19 07:24:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][150/2882]	eta 2:08:19 lr 0.000001	time 0.6563 (2.8183)	model_time 0.6560 (0.6410)	loss 0.2643 (0.2430)	grad_norm 1.3626 (0.8979/0.2587)	mem 34629MB
[2025-11-19 07:27:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][200/2882]	eta 2:05:27 lr 0.000001	time 0.6419 (2.8068)	model_time 0.6416 (0.6417)	loss 0.2485 (0.2421)	grad_norm 0.9656 (0.8978/0.2544)	mem 34629MB
[2025-11-19 07:29:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][250/2882]	eta 2:00:42 lr 0.000001	time 0.6357 (2.7517)	model_time 0.6354 (0.6403)	loss 0.2332 (0.2417)	grad_norm 1.1729 (0.9004/0.2511)	mem 34629MB
[2025-11-19 07:31:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][300/2882]	eta 1:59:45 lr 0.000001	time 5.1217 (2.7828)	model_time 0.6451 (0.6403)	loss 0.2401 (0.2413)	grad_norm 1.0916 (0.8969/0.2484)	mem 34629MB
[2025-11-19 07:34:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][350/2882]	eta 1:58:37 lr 0.000001	time 8.1684 (2.8110)	model_time 0.6414 (0.6402)	loss 0.2549 (0.2410)	grad_norm 0.7982 (0.9007/0.2442)	mem 34629MB
[2025-11-19 07:36:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][400/2882]	eta 1:55:52 lr 0.000001	time 0.6368 (2.8014)	model_time 0.6364 (0.6403)	loss 0.2154 (0.2411)	grad_norm 0.6292 (0.8921/0.2398)	mem 34629MB
[2025-11-19 07:39:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][450/2882]	eta 1:54:47 lr 0.000001	time 0.6366 (2.8320)	model_time 0.6364 (0.6402)	loss 0.2386 (0.2412)	grad_norm 0.9116 (0.8934/0.2285)	mem 34629MB
[2025-11-19 07:41:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][500/2882]	eta 1:51:44 lr 0.000001	time 0.6270 (2.8146)	model_time 0.6268 (0.6393)	loss 0.2540 (0.2411)	grad_norm 0.9189 (0.8885/0.2276)	mem 34629MB
[2025-11-19 07:43:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][550/2882]	eta 1:49:16 lr 0.000001	time 0.6356 (2.8115)	model_time 0.6353 (0.6386)	loss 0.2469 (0.2411)	grad_norm 0.9835 (0.8809/0.2225)	mem 34629MB
[2025-11-19 07:46:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][600/2882]	eta 1:48:34 lr 0.000001	time 0.6273 (2.8549)	model_time 0.6271 (0.6377)	loss 0.2712 (0.2413)	grad_norm 0.7939 (0.8844/0.2211)	mem 34629MB
[2025-11-19 07:48:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][650/2882]	eta 1:46:02 lr 0.000001	time 5.8841 (2.8504)	model_time 0.6404 (0.6370)	loss 0.2456 (0.2412)	grad_norm 0.9552 (0.8805/0.2213)	mem 34629MB
[2025-11-19 07:50:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][700/2882]	eta 1:42:27 lr 0.000001	time 0.6314 (2.8173)	model_time 0.6311 (0.6375)	loss 0.2689 (0.2413)	grad_norm 1.2077 (0.8811/0.2200)	mem 34629MB
[2025-11-19 07:52:47 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][750/2882]	eta 1:39:32 lr 0.000001	time 0.6297 (2.8012)	model_time 0.6295 (0.6370)	loss 0.2324 (0.2409)	grad_norm 0.5622 (0.8646/0.2186)	mem 34629MB
[2025-11-19 07:54:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][800/2882]	eta 1:36:38 lr 0.000001	time 0.6382 (2.7850)	model_time 0.6379 (0.6368)	loss 0.2405 (0.2410)	grad_norm 0.6386 (0.8725/0.2166)	mem 34629MB
[2025-11-19 07:56:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][850/2882]	eta 1:33:42 lr 0.000001	time 0.6410 (2.7668)	model_time 0.6407 (0.6371)	loss 0.2150 (0.2411)	grad_norm 0.9853 (0.8718/0.2207)	mem 34629MB
[2025-11-19 07:59:22 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][900/2882]	eta 1:31:36 lr 0.000001	time 0.6379 (2.7733)	model_time 0.6376 (0.6373)	loss 0.2376 (0.2413)	grad_norm 0.8754 (0.8769/0.2212)	mem 34629MB
[2025-11-19 08:01:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][950/2882]	eta 1:29:08 lr 0.000001	time 6.6492 (2.7684)	model_time 0.6376 (0.6375)	loss 0.2711 (0.2411)	grad_norm 0.6106 (0.8730/0.2214)	mem 34629MB
[2025-11-19 08:03:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1000/2882]	eta 1:26:28 lr 0.000001	time 0.6382 (2.7571)	model_time 0.6379 (0.6376)	loss 0.2298 (0.2411)	grad_norm 0.9024 (0.8768/0.2230)	mem 34629MB
[2025-11-19 08:05:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1050/2882]	eta 1:23:42 lr 0.000001	time 0.6507 (2.7417)	model_time 0.6502 (0.6378)	loss 0.2408 (0.2410)	grad_norm 0.5577 (0.8904/0.2363)	mem 34629MB
[2025-11-19 08:07:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1100/2882]	eta 1:21:20 lr 0.000001	time 0.6331 (2.7389)	model_time 0.6328 (0.6378)	loss 0.2698 (0.2411)	grad_norm 0.8203 (0.8828/0.2325)	mem 34629MB
[2025-11-19 08:10:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1150/2882]	eta 1:18:44 lr 0.000001	time 0.6382 (2.7280)	model_time 0.6380 (0.6377)	loss 0.2545 (0.2411)	grad_norm 0.8568 (0.8779/0.2305)	mem 34629MB
[2025-11-19 08:12:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1200/2882]	eta 1:16:35 lr 0.000001	time 0.6391 (2.7322)	model_time 0.6388 (0.6380)	loss 0.2544 (0.2411)	grad_norm 1.0561 (0.8574/0.2297)	mem 34629MB
[2025-11-19 08:14:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1250/2882]	eta 1:14:23 lr 0.000001	time 0.6336 (2.7348)	model_time 0.6333 (0.6380)	loss 0.2392 (0.2411)	grad_norm 0.7107 (0.8535/0.2339)	mem 34629MB
[2025-11-19 08:17:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1300/2882]	eta 1:12:27 lr 0.000001	time 0.6311 (2.7479)	model_time 0.6308 (0.6378)	loss 0.2388 (0.2412)	grad_norm 0.9042 (0.8557/0.2327)	mem 34629MB
[2025-11-19 08:19:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1350/2882]	eta 1:10:32 lr 0.000001	time 0.6312 (2.7626)	model_time 0.6309 (0.6376)	loss 0.2421 (0.2412)	grad_norm 0.5978 (0.8497/0.2252)	mem 34629MB
[2025-11-19 08:22:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1400/2882]	eta 1:08:43 lr 0.000001	time 0.6303 (2.7821)	model_time 0.6300 (0.6374)	loss 0.2343 (0.2411)	grad_norm 1.0149 (0.8506/0.2357)	mem 34629MB
[2025-11-19 08:25:22 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1450/2882]	eta 1:06:46 lr 0.000001	time 0.6270 (2.7977)	model_time 0.6268 (0.6373)	loss 0.2345 (0.2411)	grad_norm 0.8680 (0.8588/0.2417)	mem 34629MB
[2025-11-19 08:28:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1500/2882]	eta 1:05:34 lr 0.000001	time 0.6323 (2.8471)	model_time 0.6320 (0.6370)	loss 0.2409 (0.2411)	grad_norm 0.9593 (0.8696/0.2405)	mem 34629MB
[2025-11-19 08:31:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1550/2882]	eta 1:03:13 lr 0.000001	time 0.6396 (2.8477)	model_time 0.6393 (0.6369)	loss 0.2501 (0.2412)	grad_norm 0.8398 (0.8793/0.2373)	mem 34629MB
[2025-11-19 08:33:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1600/2882]	eta 1:00:52 lr 0.000001	time 0.6357 (2.8488)	model_time 0.6354 (0.6370)	loss 0.2498 (0.2412)	grad_norm 0.8979 (0.8770/0.2445)	mem 34629MB
[2025-11-19 08:35:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1650/2882]	eta 0:58:18 lr 0.000001	time 0.6346 (2.8399)	model_time 0.6343 (0.6371)	loss 0.2103 (0.2411)	grad_norm 0.5613 (0.8768/0.2475)	mem 34629MB
[2025-11-19 08:38:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1700/2882]	eta 0:55:47 lr 0.000001	time 0.6350 (2.8323)	model_time 0.6346 (0.6372)	loss 0.2377 (0.2411)	grad_norm 1.0188 (0.8876/0.2449)	mem 34629MB
[2025-11-19 08:40:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1750/2882]	eta 0:53:12 lr 0.000001	time 0.6287 (2.8203)	model_time 0.6285 (0.6371)	loss 0.2413 (0.2411)	grad_norm 0.9606 (0.8962/0.2539)	mem 34629MB
[2025-11-19 08:42:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1800/2882]	eta 0:50:55 lr 0.000001	time 0.6293 (2.8243)	model_time 0.6290 (0.6369)	loss 0.2610 (0.2411)	grad_norm 1.0157 (0.8990/0.2574)	mem 34629MB
[2025-11-19 08:44:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1850/2882]	eta 0:48:23 lr 0.000001	time 0.6311 (2.8130)	model_time 0.6308 (0.6368)	loss 0.2356 (0.2411)	grad_norm 0.7500 (0.8978/0.2551)	mem 34629MB
[2025-11-19 08:46:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1900/2882]	eta 0:45:50 lr 0.000001	time 0.6293 (2.8010)	model_time 0.6284 (0.6366)	loss 0.2390 (0.2411)	grad_norm 0.9147 (0.8926/0.2453)	mem 34629MB
[2025-11-19 08:48:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][1950/2882]	eta 0:43:22 lr 0.000001	time 0.6289 (2.7921)	model_time 0.6287 (0.6365)	loss 0.2372 (0.2411)	grad_norm 0.9231 (0.8938/0.2408)	mem 34629MB
[2025-11-19 08:50:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2000/2882]	eta 0:40:55 lr 0.000001	time 0.6357 (2.7844)	model_time 0.6355 (0.6364)	loss 0.2399 (0.2410)	grad_norm 0.7555 (0.8843/0.2341)	mem 34629MB
[2025-11-19 08:52:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2050/2882]	eta 0:38:29 lr 0.000001	time 0.6290 (2.7757)	model_time 0.6288 (0.6363)	loss 0.2533 (0.2409)	grad_norm 0.7789 (0.8754/0.2204)	mem 34629MB
[2025-11-19 08:55:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2100/2882]	eta 0:36:12 lr 0.000001	time 0.6296 (2.7788)	model_time 0.6293 (0.6362)	loss 0.2096 (0.2409)	grad_norm 1.1467 (0.8843/0.2316)	mem 34629MB
[2025-11-19 08:57:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2150/2882]	eta 0:33:48 lr 0.000001	time 0.6276 (2.7718)	model_time 0.6274 (0.6360)	loss 0.2530 (0.2410)	grad_norm 0.5879 (0.8855/0.2406)	mem 34629MB
[2025-11-19 08:59:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2200/2882]	eta 0:31:24 lr 0.000001	time 0.6302 (2.7626)	model_time 0.6300 (0.6359)	loss 0.2312 (0.2410)	grad_norm 0.8281 (0.8965/0.2468)	mem 34629MB
[2025-11-19 09:00:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2250/2882]	eta 0:28:58 lr 0.000001	time 0.6298 (2.7514)	model_time 0.6295 (0.6358)	loss 0.2276 (0.2410)	grad_norm 0.6702 (0.9130/0.2476)	mem 34629MB
[2025-11-19 09:02:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2300/2882]	eta 0:26:35 lr 0.000001	time 0.6279 (2.7415)	model_time 0.6277 (0.6358)	loss 0.2302 (0.2409)	grad_norm 0.7265 (0.9160/0.2601)	mem 34629MB
[2025-11-19 09:04:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2350/2882]	eta 0:24:14 lr 0.000001	time 0.6319 (2.7335)	model_time 0.6316 (0.6356)	loss 0.2385 (0.2410)	grad_norm 0.6110 (0.9171/0.2566)	mem 34629MB
[2025-11-19 09:07:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2400/2882]	eta 0:21:57 lr 0.000001	time 0.6342 (2.7326)	model_time 0.6336 (0.6356)	loss 0.2200 (0.2410)	grad_norm 0.8027 (0.8979/0.2428)	mem 34629MB
[2025-11-19 09:09:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2450/2882]	eta 0:19:37 lr 0.000001	time 0.6308 (2.7247)	model_time 0.6305 (0.6355)	loss 0.2337 (0.2409)	grad_norm 1.0029 (0.8902/0.2354)	mem 34629MB
[2025-11-19 09:10:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2500/2882]	eta 0:17:17 lr 0.000001	time 0.6292 (2.7172)	model_time 0.6289 (0.6354)	loss 0.2448 (0.2410)	grad_norm 0.9635 (0.8809/0.2318)	mem 34629MB
[2025-11-19 09:12:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2550/2882]	eta 0:14:59 lr 0.000001	time 0.6337 (2.7083)	model_time 0.6335 (0.6352)	loss 0.2661 (0.2410)	grad_norm 1.5575 (0.8605/0.2310)	mem 34629MB
[2025-11-19 09:14:47 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2600/2882]	eta 0:12:41 lr 0.000001	time 0.6323 (2.7004)	model_time 0.6320 (0.6352)	loss 0.2331 (0.2409)	grad_norm 1.1791 (0.8653/0.2256)	mem 34629MB
[2025-11-19 09:16:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2650/2882]	eta 0:10:25 lr 0.000001	time 0.6299 (2.6956)	model_time 0.6297 (0.6351)	loss 0.2321 (0.2408)	grad_norm 0.7800 (0.8700/0.2296)	mem 34629MB
[2025-11-19 09:19:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2700/2882]	eta 0:08:10 lr 0.000001	time 0.6338 (2.6958)	model_time 0.6335 (0.6351)	loss 0.2323 (0.2409)	grad_norm 0.9461 (0.8907/0.2451)	mem 34629MB
[2025-11-19 09:20:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2750/2882]	eta 0:05:54 lr 0.000001	time 0.6317 (2.6872)	model_time 0.6314 (0.6350)	loss 0.2193 (0.2409)	grad_norm 0.6286 (0.8949/0.2511)	mem 34629MB
[2025-11-19 09:22:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2800/2882]	eta 0:03:39 lr 0.000001	time 0.6331 (2.6799)	model_time 0.6328 (0.6350)	loss 0.2606 (0.2408)	grad_norm 0.6846 (0.8943/0.2515)	mem 34629MB
[2025-11-19 09:24:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [4/20][2850/2882]	eta 0:01:25 lr 0.000001	time 0.6278 (2.6722)	model_time 0.6276 (0.6350)	loss 0.2352 (0.2408)	grad_norm 0.8379 (0.9077/0.2537)	mem 34629MB
[2025-11-19 09:26:05 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 4 training takes 2:08:22
[2025-11-19 09:26:05 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_4.pth saving......
[2025-11-19 09:26:08 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_4.pth saved !!!
[2025-11-19 09:26:39 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 30.958 (30.958)	Loss 0.2762 (0.2762)	Mem 34629MB
[2025-11-19 09:27:15 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:4] * Mean AUC-ROC 0.7919 Loss 0.2370
[2025-11-19 09:27:15 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:4] * Per-class AUC-ROC: ['0.8278', '0.8199', '0.8090', '0.9012', '0.7253', '0.5916', '0.6876', '0.7341', '0.8562', '0.9191', '0.7033', '0.7417', '0.8556', '0.9137']
[2025-11-19 09:27:15 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.7919
[2025-11-19 09:27:15 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-19 09:27:17 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-19 09:27:17 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.7919
[2025-11-19 09:27:26 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 8.481 (8.481)	Loss 0.3147 (0.3147)	Mem 34629MB
[2025-11-19 09:27:38 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:4] * Mean AUC-ROC 0.7638 Loss 0.2864
[2025-11-19 09:27:38 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:4] * Per-class AUC-ROC: ['0.8014', '0.7816', '0.7776', '0.8864', '0.6932', '0.5610', '0.6802', '0.7206', '0.8401', '0.8890', '0.6979', '0.7121', '0.7519', '0.9005']
[2025-11-19 09:27:38 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.7638
[2025-11-19 09:27:38 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-19 09:27:40 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-19 09:27:40 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.7638
[2025-11-19 09:28:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][0/2882]	eta 22:34:44 lr 0.000001	time 28.2041 (28.2041)	model_time 0.6283 (0.6283)	loss 0.2232 (0.2232)	grad_norm 1.2029 (1.2029/0.0000)	mem 34629MB
[2025-11-19 09:29:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][50/2882]	eta 2:06:21 lr 0.000001	time 0.6311 (2.6771)	model_time 0.6308 (0.6331)	loss 0.2294 (0.2381)	grad_norm 0.9751 (0.9422/0.2287)	mem 34629MB
[2025-11-19 09:31:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][100/2882]	eta 1:53:42 lr 0.000001	time 0.6308 (2.4524)	model_time 0.6306 (0.6316)	loss 0.2683 (0.2394)	grad_norm 1.2702 (0.9240/0.2412)	mem 34629MB
[2025-11-19 09:33:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][150/2882]	eta 1:47:17 lr 0.000001	time 0.6319 (2.3562)	model_time 0.6317 (0.6317)	loss 0.2402 (0.2381)	grad_norm 0.7424 (0.9080/0.2321)	mem 34629MB
[2025-11-19 09:35:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][200/2882]	eta 1:43:38 lr 0.000001	time 0.6293 (2.3186)	model_time 0.6290 (0.6317)	loss 0.2316 (0.2371)	grad_norm 1.3202 (0.9063/0.2274)	mem 34629MB
[2025-11-19 09:37:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][250/2882]	eta 1:40:18 lr 0.000001	time 0.6430 (2.2867)	model_time 0.6427 (0.6343)	loss 0.2350 (0.2379)	grad_norm 1.0375 (0.8968/0.2290)	mem 34629MB
[2025-11-19 09:39:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][300/2882]	eta 1:38:23 lr 0.000001	time 10.5552 (2.2864)	model_time 0.5472 (0.6350)	loss 0.2290 (0.2375)	grad_norm inf (0.8913/0.2328)	mem 34629MB
[2025-11-19 09:41:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][350/2882]	eta 1:36:42 lr 0.000001	time 0.6281 (2.2919)	model_time 0.6278 (0.6343)	loss 0.2500 (0.2384)	grad_norm 0.8473 (0.8813/0.2292)	mem 34629MB
[2025-11-19 09:42:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][400/2882]	eta 1:34:15 lr 0.000001	time 0.6294 (2.2788)	model_time 0.6292 (0.6340)	loss 0.2397 (0.2387)	grad_norm 0.4420 (0.8832/0.2210)	mem 34629MB
[2025-11-19 09:44:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][450/2882]	eta 1:31:46 lr 0.000001	time 0.6289 (2.2644)	model_time 0.6287 (0.6335)	loss 0.2489 (0.2387)	grad_norm 1.0450 (0.8808/0.2247)	mem 34629MB
[2025-11-19 09:46:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][500/2882]	eta 1:29:40 lr 0.000001	time 2.9194 (2.2586)	model_time 0.6313 (0.6332)	loss 0.2315 (0.2384)	grad_norm 0.9296 (0.8902/0.2337)	mem 34629MB
[2025-11-19 09:48:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][550/2882]	eta 1:28:37 lr 0.000001	time 0.6340 (2.2803)	model_time 0.6337 (0.6331)	loss 0.2425 (0.2387)	grad_norm 0.6200 (0.8952/0.2273)	mem 34629MB
[2025-11-19 09:50:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][600/2882]	eta 1:27:36 lr 0.000001	time 11.1776 (2.3034)	model_time 0.6282 (0.6327)	loss 0.2619 (0.2386)	grad_norm 0.7058 (0.8906/0.2231)	mem 34629MB
[2025-11-19 09:53:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][650/2882]	eta 1:26:49 lr 0.000001	time 0.6276 (2.3339)	model_time 0.6273 (0.6325)	loss 0.2160 (0.2387)	grad_norm 0.7206 (0.8812/0.2261)	mem 34629MB
[2025-11-19 09:54:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][700/2882]	eta 1:24:59 lr 0.000001	time 0.6278 (2.3371)	model_time 0.6276 (0.6323)	loss 0.2283 (0.2389)	grad_norm 0.8405 (0.8759/0.2298)	mem 34629MB
[2025-11-19 09:57:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][750/2882]	eta 1:23:23 lr 0.000001	time 0.6328 (2.3469)	model_time 0.6325 (0.6321)	loss 0.2291 (0.2389)	grad_norm 0.6208 (0.8732/0.2267)	mem 34629MB
[2025-11-19 09:59:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][800/2882]	eta 1:21:41 lr 0.000001	time 3.8601 (2.3542)	model_time 0.6293 (0.6320)	loss 0.2329 (0.2391)	grad_norm 0.8026 (0.8632/0.2225)	mem 34629MB
[2025-11-19 10:00:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][850/2882]	eta 1:19:26 lr 0.000001	time 0.6289 (2.3455)	model_time 0.6287 (0.6318)	loss 0.2267 (0.2390)	grad_norm 0.6482 (0.8667/0.2250)	mem 34629MB
[2025-11-19 10:03:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][900/2882]	eta 1:18:02 lr 0.000001	time 21.1703 (2.3628)	model_time 0.6321 (0.6318)	loss 0.2365 (0.2388)	grad_norm 0.6422 (0.8753/0.2326)	mem 34629MB
[2025-11-19 10:05:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][950/2882]	eta 1:15:59 lr 0.000001	time 0.6381 (2.3601)	model_time 0.6378 (0.6319)	loss 0.2413 (0.2388)	grad_norm 1.0270 (0.8774/0.2290)	mem 34629MB
[2025-11-19 10:07:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1000/2882]	eta 1:14:03 lr 0.000001	time 0.6365 (2.3610)	model_time 0.6361 (0.6323)	loss 0.2137 (0.2388)	grad_norm 0.9633 (0.8880/0.2410)	mem 34629MB
[2025-11-19 10:09:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1050/2882]	eta 1:12:12 lr 0.000001	time 0.6355 (2.3647)	model_time 0.6352 (0.6326)	loss 0.2549 (0.2389)	grad_norm 1.1176 (0.8996/0.2455)	mem 34629MB
[2025-11-19 10:11:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1100/2882]	eta 1:10:10 lr 0.000001	time 0.6361 (2.3628)	model_time 0.6358 (0.6326)	loss 0.2396 (0.2389)	grad_norm 1.3679 (0.8897/0.2504)	mem 34629MB
[2025-11-19 10:12:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1150/2882]	eta 1:08:03 lr 0.000001	time 0.6309 (2.3579)	model_time 0.6306 (0.6325)	loss 0.2536 (0.2389)	grad_norm 1.2880 (0.8809/0.2489)	mem 34629MB
[2025-11-19 10:15:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1200/2882]	eta 1:06:23 lr 0.000001	time 9.5681 (2.3684)	model_time 0.6310 (0.6324)	loss 0.2541 (0.2390)	grad_norm 0.7214 (0.8783/0.2349)	mem 34629MB
[2025-11-19 10:16:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1250/2882]	eta 1:04:16 lr 0.000001	time 0.6338 (2.3630)	model_time 0.6335 (0.6324)	loss 0.2316 (0.2390)	grad_norm 0.6676 (0.8898/0.2342)	mem 34629MB
[2025-11-19 10:18:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1300/2882]	eta 1:02:15 lr 0.000001	time 0.6296 (2.3610)	model_time 0.6294 (0.6324)	loss 0.2288 (0.2390)	grad_norm 0.7473 (0.8695/0.2195)	mem 34629MB
[2025-11-19 10:20:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1350/2882]	eta 1:00:24 lr 0.000001	time 0.6359 (2.3658)	model_time 0.6356 (0.6325)	loss 0.2441 (0.2389)	grad_norm 1.1337 (0.8601/0.2160)	mem 34629MB
[2025-11-19 10:22:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1400/2882]	eta 0:58:20 lr 0.000001	time 0.6400 (2.3622)	model_time 0.6397 (0.6330)	loss 0.2153 (0.2390)	grad_norm 1.2547 (0.8680/0.2021)	mem 34629MB
[2025-11-19 10:24:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1450/2882]	eta 0:56:19 lr 0.000001	time 0.6428 (2.3603)	model_time 0.6425 (0.6332)	loss 0.2487 (0.2389)	grad_norm 1.0454 (0.8709/0.2039)	mem 34630MB
[2025-11-19 10:26:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1500/2882]	eta 0:54:28 lr 0.000001	time 10.5387 (2.3654)	model_time 0.6326 (0.6332)	loss 0.2374 (0.2389)	grad_norm 0.6130 (0.8648/0.2167)	mem 34630MB
[2025-11-19 10:29:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1550/2882]	eta 0:52:43 lr 0.000001	time 7.4401 (2.3751)	model_time 0.6293 (0.6332)	loss 0.2352 (0.2389)	grad_norm 0.6758 (0.8582/0.2230)	mem 34630MB
[2025-11-19 10:31:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1600/2882]	eta 0:50:59 lr 0.000001	time 0.6289 (2.3863)	model_time 0.6287 (0.6332)	loss 0.2554 (0.2391)	grad_norm 1.1032 (0.8788/0.2286)	mem 34630MB
[2025-11-19 10:33:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1650/2882]	eta 0:49:00 lr 0.000001	time 0.6299 (2.3869)	model_time 0.6296 (0.6331)	loss 0.2503 (0.2390)	grad_norm 0.9697 (0.8822/0.2284)	mem 34630MB
[2025-11-19 10:35:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1700/2882]	eta 0:47:05 lr 0.000001	time 0.6352 (2.3907)	model_time 0.6350 (0.6330)	loss 0.2048 (0.2388)	grad_norm 1.0260 (0.8899/0.2333)	mem 34630MB
[2025-11-19 10:37:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1750/2882]	eta 0:45:15 lr 0.000001	time 0.6323 (2.3992)	model_time 0.6321 (0.6329)	loss 0.2158 (0.2388)	grad_norm 0.7833 (0.8931/0.2335)	mem 34630MB
[2025-11-19 10:39:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1800/2882]	eta 0:43:18 lr 0.000001	time 0.6892 (2.4012)	model_time 0.6295 (0.6328)	loss 0.2521 (0.2387)	grad_norm 1.1490 (0.9019/0.2337)	mem 34630MB
[2025-11-19 10:42:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1850/2882]	eta 0:41:31 lr 0.000001	time 21.5386 (2.4140)	model_time 0.6357 (0.6327)	loss 0.2166 (0.2388)	grad_norm 0.6668 (0.9062/0.2312)	mem 34630MB
[2025-11-19 10:44:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1900/2882]	eta 0:39:30 lr 0.000001	time 0.6320 (2.4138)	model_time 0.6318 (0.6327)	loss 0.2364 (0.2387)	grad_norm 0.9061 (0.8891/0.2242)	mem 34630MB
[2025-11-19 10:46:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][1950/2882]	eta 0:37:34 lr 0.000001	time 0.6301 (2.4191)	model_time 0.6297 (0.6326)	loss 0.2480 (0.2387)	grad_norm 0.6834 (0.8858/0.2293)	mem 34630MB
[2025-11-19 10:48:25 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2000/2882]	eta 0:35:35 lr 0.000001	time 0.6330 (2.4210)	model_time 0.6328 (0.6326)	loss 0.2860 (0.2387)	grad_norm 1.0935 (0.8780/0.2283)	mem 34630MB
[2025-11-19 10:50:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2050/2882]	eta 0:33:36 lr 0.000001	time 0.6296 (2.4241)	model_time 0.6293 (0.6326)	loss 0.2297 (0.2387)	grad_norm 0.7820 (0.8755/0.2351)	mem 34630MB
[2025-11-19 10:52:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2100/2882]	eta 0:31:33 lr 0.000001	time 0.6274 (2.4218)	model_time 0.6272 (0.6326)	loss 0.2555 (0.2387)	grad_norm 0.9333 (0.8707/0.2328)	mem 34630MB
[2025-11-19 10:54:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2150/2882]	eta 0:29:36 lr 0.000001	time 21.2003 (2.4269)	model_time 0.6315 (0.6325)	loss 0.2323 (0.2387)	grad_norm 1.3433 (0.8743/0.2428)	mem 34630MB
[2025-11-19 10:56:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2200/2882]	eta 0:27:33 lr 0.000001	time 0.6308 (2.4238)	model_time 0.6305 (0.6325)	loss 0.2608 (0.2387)	grad_norm 1.0703 (0.8868/0.2513)	mem 34630MB
[2025-11-19 10:58:33 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2250/2882]	eta 0:25:30 lr 0.000001	time 0.6472 (2.4224)	model_time 0.6468 (0.6326)	loss 0.2465 (0.2387)	grad_norm 0.8807 (0.8940/0.2442)	mem 34630MB
[2025-11-19 11:00:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2300/2882]	eta 0:23:29 lr 0.000001	time 0.6325 (2.4210)	model_time 0.6323 (0.6327)	loss 0.2606 (0.2387)	grad_norm 0.8350 (0.8957/0.2484)	mem 34630MB
[2025-11-19 11:02:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2350/2882]	eta 0:21:26 lr 0.000001	time 0.6319 (2.4186)	model_time 0.6316 (0.6327)	loss 0.2319 (0.2387)	grad_norm 0.8502 (0.8938/0.2467)	mem 34630MB
[2025-11-19 11:04:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2400/2882]	eta 0:19:25 lr 0.000001	time 0.6286 (2.4171)	model_time 0.6284 (0.6328)	loss 0.2683 (0.2388)	grad_norm 1.0140 (0.8953/0.2411)	mem 34630MB
[2025-11-19 11:06:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2450/2882]	eta 0:17:29 lr 0.000001	time 23.1793 (2.4288)	model_time 0.6294 (0.6327)	loss 0.2606 (0.2388)	grad_norm 0.7216 (0.8994/0.2405)	mem 34630MB
[2025-11-19 11:08:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2500/2882]	eta 0:15:27 lr 0.000001	time 0.6288 (2.4267)	model_time 0.6286 (0.6327)	loss 0.2472 (0.2388)	grad_norm 0.5386 (0.8979/0.2402)	mem 34630MB
[2025-11-19 11:10:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2550/2882]	eta 0:13:25 lr 0.000001	time 0.6284 (2.4255)	model_time 0.6281 (0.6326)	loss 0.2218 (0.2388)	grad_norm 0.8871 (0.8996/0.2449)	mem 34630MB
[2025-11-19 11:12:47 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2600/2882]	eta 0:11:23 lr 0.000001	time 0.6305 (2.4247)	model_time 0.6303 (0.6326)	loss 0.2353 (0.2388)	grad_norm 0.9025 (0.9001/0.2452)	mem 34630MB
[2025-11-19 11:14:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2650/2882]	eta 0:09:22 lr 0.000001	time 0.6353 (2.4236)	model_time 0.6350 (0.6326)	loss 0.2306 (0.2388)	grad_norm 0.7308 (0.8989/0.2486)	mem 34630MB
[2025-11-19 11:16:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2700/2882]	eta 0:07:20 lr 0.000001	time 0.6296 (2.4220)	model_time 0.6293 (0.6325)	loss 0.2171 (0.2388)	grad_norm 0.5434 (0.9057/0.2565)	mem 34630MB
[2025-11-19 11:19:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2750/2882]	eta 0:05:20 lr 0.000001	time 20.1009 (2.4281)	model_time 0.6298 (0.6325)	loss 0.2290 (0.2388)	grad_norm 1.1137 (0.8907/0.2447)	mem 34630MB
[2025-11-19 11:20:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2800/2882]	eta 0:03:18 lr 0.000001	time 0.6280 (2.4257)	model_time 0.6278 (0.6324)	loss 0.2253 (0.2387)	grad_norm 0.8639 (0.8830/0.2428)	mem 34630MB
[2025-11-19 11:22:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [5/20][2850/2882]	eta 0:01:17 lr 0.000001	time 0.6296 (2.4231)	model_time 0.6294 (0.6324)	loss 0.2269 (0.2388)	grad_norm 0.7054 (0.8697/0.2345)	mem 34630MB
[2025-11-19 11:23:47 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 5 training takes 1:56:06
[2025-11-19 11:23:47 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_5.pth saving......
[2025-11-19 11:23:49 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_5.pth saved !!!
[2025-11-19 11:24:18 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 28.461 (28.461)	Loss 0.2743 (0.2743)	Mem 34630MB
[2025-11-19 11:24:57 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:5] * Mean AUC-ROC 0.7970 Loss 0.2356
[2025-11-19 11:24:57 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:5] * Per-class AUC-ROC: ['0.8318', '0.8213', '0.8100', '0.9015', '0.7320', '0.5923', '0.7087', '0.7366', '0.8589', '0.9200', '0.7343', '0.7421', '0.8525', '0.9162']
[2025-11-19 11:24:57 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.7970
[2025-11-19 11:24:57 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-19 11:24:59 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-19 11:24:59 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.7970
[2025-11-19 11:25:08 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 8.555 (8.555)	Loss 0.2990 (0.2990)	Mem 34630MB
[2025-11-19 11:25:20 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:5] * Mean AUC-ROC 0.7768 Loss 0.2681
[2025-11-19 11:25:20 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:5] * Per-class AUC-ROC: ['0.8141', '0.7955', '0.7894', '0.8928', '0.7049', '0.5904', '0.6837', '0.7257', '0.8459', '0.9014', '0.7127', '0.7232', '0.7883', '0.9071']
[2025-11-19 11:25:20 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.7768
[2025-11-19 11:25:20 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-19 11:25:22 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-19 11:25:22 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.7768
[2025-11-19 11:25:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][0/2882]	eta 23:18:11 lr 0.000001	time 29.1089 (29.1089)	model_time 0.6354 (0.6354)	loss 0.2320 (0.2320)	grad_norm 0.8906 (0.8906/0.0000)	mem 34630MB
[2025-11-19 11:27:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][50/2882]	eta 2:06:51 lr 0.000001	time 0.6318 (2.6875)	model_time 0.6315 (0.6302)	loss 0.2696 (0.2351)	grad_norm 0.9859 (0.8717/0.2791)	mem 34630MB
[2025-11-19 11:29:22 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][100/2882]	eta 1:50:12 lr 0.000001	time 0.6285 (2.3769)	model_time 0.6282 (0.6319)	loss 0.2037 (0.2340)	grad_norm 0.6925 (0.8490/0.2451)	mem 34630MB
[2025-11-19 11:31:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][150/2882]	eta 1:43:08 lr 0.000001	time 0.6271 (2.2652)	model_time 0.6269 (0.6310)	loss 0.2407 (0.2357)	grad_norm 1.2551 (0.8703/0.2300)	mem 34630MB
[2025-11-19 11:32:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][200/2882]	eta 1:40:11 lr 0.000001	time 0.6315 (2.2413)	model_time 0.6313 (0.6311)	loss 0.2614 (0.2368)	grad_norm 1.0823 (0.8543/0.2345)	mem 34630MB
[2025-11-19 11:34:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][250/2882]	eta 1:40:01 lr 0.000001	time 0.6337 (2.2802)	model_time 0.6334 (0.6308)	loss 0.2596 (0.2370)	grad_norm 0.8747 (0.8632/0.2476)	mem 34630MB
[2025-11-19 11:37:22 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][300/2882]	eta 1:42:56 lr 0.000001	time 20.5355 (2.3921)	model_time 0.6297 (0.6307)	loss 0.2512 (0.2370)	grad_norm 0.9746 (0.8646/0.2438)	mem 34630MB
[2025-11-19 11:39:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][350/2882]	eta 1:39:38 lr 0.000001	time 0.6327 (2.3612)	model_time 0.6323 (0.6307)	loss 0.2709 (0.2372)	grad_norm 0.9118 (0.8656/0.2357)	mem 34630MB
[2025-11-19 11:41:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][400/2882]	eta 1:38:03 lr 0.000001	time 0.6326 (2.3705)	model_time 0.6324 (0.6314)	loss 0.2516 (0.2375)	grad_norm 0.8865 (0.8763/0.2371)	mem 34630MB
[2025-11-19 11:43:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][450/2882]	eta 1:36:43 lr 0.000001	time 0.6281 (2.3864)	model_time 0.6279 (0.6314)	loss 0.2210 (0.2376)	grad_norm 1.0054 (0.8703/0.2440)	mem 34630MB
[2025-11-19 11:45:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][500/2882]	eta 1:34:58 lr 0.000001	time 0.6288 (2.3923)	model_time 0.6286 (0.6312)	loss 0.2305 (0.2374)	grad_norm 1.2831 (0.8884/0.2433)	mem 34630MB
[2025-11-19 11:47:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][550/2882]	eta 1:32:41 lr 0.000001	time 0.6344 (2.3847)	model_time 0.6338 (0.6311)	loss 0.2346 (0.2374)	grad_norm 1.0621 (0.8929/0.2336)	mem 34630MB
[2025-11-19 11:49:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][600/2882]	eta 1:31:29 lr 0.000001	time 19.0884 (2.4056)	model_time 0.6335 (0.6312)	loss 0.2188 (0.2373)	grad_norm 0.6952 (0.8918/0.2349)	mem 34630MB
[2025-11-19 11:51:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][650/2882]	eta 1:29:28 lr 0.000001	time 0.6333 (2.4050)	model_time 0.6330 (0.6311)	loss 0.2509 (0.2377)	grad_norm 0.7602 (0.8970/0.2393)	mem 34630MB
[2025-11-19 11:53:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][700/2882]	eta 1:26:58 lr 0.000001	time 0.6293 (2.3915)	model_time 0.6290 (0.6311)	loss 0.2441 (0.2375)	grad_norm 0.9583 (0.8910/0.2412)	mem 34630MB
[2025-11-19 11:55:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][750/2882]	eta 1:24:48 lr 0.000001	time 0.6291 (2.3867)	model_time 0.6290 (0.6310)	loss 0.2497 (0.2372)	grad_norm 1.1472 (0.8908/0.2412)	mem 34630MB
[2025-11-19 11:57:08 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][800/2882]	eta 1:22:34 lr 0.000001	time 0.6358 (2.3795)	model_time 0.6355 (0.6316)	loss 0.2240 (0.2375)	grad_norm 0.8497 (0.8830/0.2441)	mem 34630MB
[2025-11-19 11:59:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][850/2882]	eta 1:20:18 lr 0.000001	time 0.6296 (2.3714)	model_time 0.6287 (0.6316)	loss 0.2476 (0.2375)	grad_norm 1.0215 (0.8740/0.2467)	mem 34630MB
[2025-11-19 12:01:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][900/2882]	eta 1:18:58 lr 0.000001	time 21.7420 (2.3910)	model_time 0.6290 (0.6315)	loss 0.2650 (0.2376)	grad_norm 0.7218 (0.8805/0.2457)	mem 34630MB
[2025-11-19 12:03:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][950/2882]	eta 1:16:49 lr 0.000001	time 0.6330 (2.3861)	model_time 0.6328 (0.6316)	loss 0.2591 (0.2375)	grad_norm 0.5891 (0.8733/0.2408)	mem 34630MB
[2025-11-19 12:05:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1000/2882]	eta 1:14:44 lr 0.000001	time 0.6280 (2.3826)	model_time 0.6278 (0.6315)	loss 0.2376 (0.2375)	grad_norm 0.9042 (0.8788/0.2391)	mem 34630MB
[2025-11-19 12:07:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1050/2882]	eta 1:12:41 lr 0.000001	time 0.6291 (2.3808)	model_time 0.6288 (0.6317)	loss 0.2509 (0.2375)	grad_norm 1.1147 (0.8844/0.2348)	mem 34630MB
[2025-11-19 12:09:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1100/2882]	eta 1:10:36 lr 0.000001	time 0.6465 (2.3775)	model_time 0.6461 (0.6319)	loss 0.2166 (0.2376)	grad_norm 0.5360 (0.8841/0.2339)	mem 34630MB
[2025-11-19 12:11:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1150/2882]	eta 1:08:43 lr 0.000001	time 0.6313 (2.3805)	model_time 0.6310 (0.6324)	loss 0.2137 (0.2376)	grad_norm 0.7230 (0.8894/0.2261)	mem 34630MB
[2025-11-19 12:13:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1200/2882]	eta 1:07:28 lr 0.000001	time 22.4586 (2.4068)	model_time 0.6279 (0.6323)	loss 0.2280 (0.2376)	grad_norm 0.4955 (0.8850/0.2196)	mem 34630MB
[2025-11-19 12:15:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1250/2882]	eta 1:05:26 lr 0.000001	time 0.6333 (2.4060)	model_time 0.6331 (0.6323)	loss 0.2499 (0.2377)	grad_norm 0.7966 (0.8878/0.2230)	mem 34630MB
[2025-11-19 12:17:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1300/2882]	eta 1:03:35 lr 0.000001	time 0.6306 (2.4117)	model_time 0.6303 (0.6324)	loss 0.2291 (0.2378)	grad_norm 0.7732 (0.8880/0.2215)	mem 34630MB
[2025-11-19 12:19:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1350/2882]	eta 1:01:36 lr 0.000001	time 0.6284 (2.4131)	model_time 0.6281 (0.6323)	loss 0.2424 (0.2379)	grad_norm 0.7776 (0.8777/0.2211)	mem 34630MB
[2025-11-19 12:21:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1400/2882]	eta 0:59:28 lr 0.000001	time 0.6309 (2.4078)	model_time 0.6307 (0.6323)	loss 0.2262 (0.2378)	grad_norm 0.9165 (0.8828/0.2184)	mem 34630MB
[2025-11-19 12:23:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1450/2882]	eta 0:57:21 lr 0.000001	time 0.6283 (2.4032)	model_time 0.6281 (0.6322)	loss 0.2476 (0.2379)	grad_norm 0.8332 (0.8779/0.2233)	mem 34630MB
[2025-11-19 12:25:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1500/2882]	eta 0:55:40 lr 0.000001	time 23.4574 (2.4170)	model_time 0.6391 (0.6322)	loss 0.2451 (0.2379)	grad_norm 0.5651 (0.8790/0.2354)	mem 34630MB
[2025-11-19 12:27:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1550/2882]	eta 0:53:40 lr 0.000001	time 0.6463 (2.4179)	model_time 0.6460 (0.6325)	loss 0.2314 (0.2379)	grad_norm 0.5355 (0.8899/0.2339)	mem 34630MB
[2025-11-19 12:29:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1600/2882]	eta 0:51:40 lr 0.000001	time 0.6283 (2.4185)	model_time 0.6281 (0.6328)	loss 0.2205 (0.2378)	grad_norm 0.8376 (0.8938/0.2329)	mem 34630MB
[2025-11-19 12:32:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1650/2882]	eta 0:49:45 lr 0.000001	time 0.6437 (2.4232)	model_time 0.6434 (0.6331)	loss 0.2317 (0.2377)	grad_norm 0.7337 (0.9039/0.2326)	mem 34630MB
[2025-11-19 12:34:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1700/2882]	eta 0:47:41 lr 0.000001	time 0.6419 (2.4212)	model_time 0.6416 (0.6333)	loss 0.2126 (0.2377)	grad_norm 0.6106 (0.9005/0.2309)	mem 34630MB
[2025-11-19 12:35:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1750/2882]	eta 0:45:39 lr 0.000001	time 0.6391 (2.4199)	model_time 0.6388 (0.6335)	loss 0.2551 (0.2377)	grad_norm 0.8970 (0.9113/0.2317)	mem 34630MB
[2025-11-19 12:38:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1800/2882]	eta 0:43:46 lr 0.000001	time 17.6610 (2.4272)	model_time 0.6359 (0.6338)	loss 0.2322 (0.2376)	grad_norm 0.6798 (0.9088/0.2249)	mem 34630MB
[2025-11-19 12:40:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1850/2882]	eta 0:41:44 lr 0.000001	time 0.6286 (2.4267)	model_time 0.6284 (0.6338)	loss 0.2428 (0.2376)	grad_norm 0.6322 (0.8950/0.2172)	mem 34630MB
[2025-11-19 12:42:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1900/2882]	eta 0:39:40 lr 0.000001	time 0.6308 (2.4240)	model_time 0.6305 (0.6337)	loss 0.2384 (0.2376)	grad_norm 1.1264 (0.8800/0.2242)	mem 34630MB
[2025-11-19 12:44:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][1950/2882]	eta 0:37:39 lr 0.000001	time 0.6405 (2.4243)	model_time 0.6403 (0.6338)	loss 0.2442 (0.2376)	grad_norm 1.2070 (0.8775/0.2257)	mem 34630MB
[2025-11-19 12:46:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2000/2882]	eta 0:35:35 lr 0.000001	time 0.6288 (2.4211)	model_time 0.6286 (0.6337)	loss 0.2219 (0.2374)	grad_norm 1.0655 (0.8776/0.2257)	mem 34630MB
[2025-11-19 12:48:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2050/2882]	eta 0:33:33 lr 0.000001	time 0.6307 (2.4196)	model_time 0.6304 (0.6337)	loss 0.2305 (0.2375)	grad_norm 0.7022 (0.8700/0.2206)	mem 34630MB
[2025-11-19 12:50:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2100/2882]	eta 0:31:34 lr 0.000001	time 14.9769 (2.4232)	model_time 0.6340 (0.6337)	loss 0.2118 (0.2374)	grad_norm 0.9875 (0.8774/0.2212)	mem 34630MB
[2025-11-19 12:52:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2150/2882]	eta 0:29:36 lr 0.000001	time 0.6315 (2.4263)	model_time 0.6313 (0.6337)	loss 0.2257 (0.2374)	grad_norm 1.1783 (0.8883/0.2227)	mem 34630MB
[2025-11-19 12:54:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2200/2882]	eta 0:27:34 lr 0.000001	time 0.6298 (2.4252)	model_time 0.6296 (0.6336)	loss 0.2421 (0.2373)	grad_norm 0.9284 (0.9049/0.2205)	mem 34630MB
[2025-11-19 12:56:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2250/2882]	eta 0:25:30 lr 0.000001	time 0.6293 (2.4221)	model_time 0.6290 (0.6335)	loss 0.2310 (0.2372)	grad_norm 0.7769 (0.8984/0.2188)	mem 34630MB
[2025-11-19 12:58:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2300/2882]	eta 0:23:27 lr 0.000001	time 0.6297 (2.4181)	model_time 0.6295 (0.6335)	loss 0.2393 (0.2372)	grad_norm 0.9357 (0.9050/0.2209)	mem 34630MB
[2025-11-19 13:00:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2350/2882]	eta 0:21:24 lr 0.000001	time 0.6447 (2.4154)	model_time 0.6444 (0.6336)	loss 0.2274 (0.2372)	grad_norm 1.0067 (0.9048/0.2241)	mem 34630MB
[2025-11-19 13:01:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2400/2882]	eta 0:19:23 lr 0.000001	time 4.4700 (2.4138)	model_time 0.6314 (0.6337)	loss 0.2233 (0.2372)	grad_norm 0.8644 (0.9077/0.2354)	mem 34630MB
[2025-11-19 13:04:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2450/2882]	eta 0:17:23 lr 0.000001	time 0.6350 (2.4164)	model_time 0.6347 (0.6337)	loss 0.2282 (0.2372)	grad_norm 1.0758 (0.9077/0.2509)	mem 34630MB
[2025-11-19 13:05:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2500/2882]	eta 0:15:21 lr 0.000001	time 0.6330 (2.4125)	model_time 0.6327 (0.6337)	loss 0.2439 (0.2372)	grad_norm 0.6924 (0.9000/0.2452)	mem 34630MB
[2025-11-19 13:08:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2550/2882]	eta 0:13:21 lr 0.000001	time 0.6295 (2.4151)	model_time 0.6292 (0.6336)	loss 0.2538 (0.2373)	grad_norm 0.5382 (0.9101/0.2506)	mem 34630MB
[2025-11-19 13:09:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2600/2882]	eta 0:11:20 lr 0.000001	time 0.6318 (2.4133)	model_time 0.6315 (0.6336)	loss 0.2151 (0.2372)	grad_norm 0.9718 (0.9012/0.2500)	mem 34630MB
[2025-11-19 13:12:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2650/2882]	eta 0:09:19 lr 0.000001	time 0.6428 (2.4134)	model_time 0.6424 (0.6337)	loss 0.2472 (0.2372)	grad_norm 0.8993 (0.8996/0.2465)	mem 34630MB
[2025-11-19 13:14:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2700/2882]	eta 0:07:19 lr 0.000001	time 0.6390 (2.4136)	model_time 0.6386 (0.6338)	loss 0.2409 (0.2372)	grad_norm 1.8299 (0.9015/0.2514)	mem 34630MB
[2025-11-19 13:16:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2750/2882]	eta 0:05:19 lr 0.000001	time 0.6363 (2.4238)	model_time 0.6361 (0.6340)	loss 0.2507 (0.2372)	grad_norm 1.2500 (0.8890/0.2337)	mem 34630MB
[2025-11-19 13:18:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2800/2882]	eta 0:03:18 lr 0.000001	time 0.6396 (2.4239)	model_time 0.6394 (0.6342)	loss 0.2520 (0.2372)	grad_norm 0.8928 (0.8983/0.2429)	mem 34630MB
[2025-11-19 13:20:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [6/20][2850/2882]	eta 0:01:17 lr 0.000001	time 0.6398 (2.4234)	model_time 0.6393 (0.6342)	loss 0.2367 (0.2372)	grad_norm 1.0396 (0.8893/0.2370)	mem 34630MB
[2025-11-19 13:22:01 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 6 training takes 1:56:39
[2025-11-19 13:22:01 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_6.pth saving......
[2025-11-19 13:22:03 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_6.pth saved !!!
[2025-11-19 13:22:33 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 29.935 (29.935)	Loss 0.2706 (0.2706)	Mem 34630MB
[2025-11-19 13:23:11 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:6] * Mean AUC-ROC 0.7978 Loss 0.2338
[2025-11-19 13:23:11 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:6] * Per-class AUC-ROC: ['0.8328', '0.8229', '0.8154', '0.9030', '0.7326', '0.5805', '0.7014', '0.7365', '0.8590', '0.9215', '0.7390', '0.7458', '0.8601', '0.9183']
[2025-11-19 13:23:11 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.7978
[2025-11-19 13:23:11 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-19 13:23:13 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-19 13:23:13 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.7978
[2025-11-19 13:23:23 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 10.243 (10.243)	Loss 0.2888 (0.2888)	Mem 34630MB
[2025-11-19 13:23:37 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:6] * Mean AUC-ROC 0.7852 Loss 0.2556
[2025-11-19 13:23:37 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:6] * Per-class AUC-ROC: ['0.8217', '0.8061', '0.7981', '0.8968', '0.7141', '0.6002', '0.6895', '0.7293', '0.8503', '0.9089', '0.7230', '0.7309', '0.8128', '0.9110']
[2025-11-19 13:23:37 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.7852
[2025-11-19 13:23:37 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-19 13:23:38 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-19 13:23:38 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.7852
[2025-11-19 13:24:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][0/2882]	eta 1 day, 0:33:24 lr 0.000001	time 30.6748 (30.6748)	model_time 0.6298 (0.6298)	loss 0.2571 (0.2571)	grad_norm 0.8743 (0.8743/0.0000)	mem 34630MB
[2025-11-19 13:26:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][50/2882]	eta 2:17:13 lr 0.000001	time 4.4663 (2.9071)	model_time 0.6286 (0.6304)	loss 0.2500 (0.2377)	grad_norm 0.8103 (0.9736/0.2451)	mem 34630MB
[2025-11-19 13:28:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][100/2882]	eta 2:01:08 lr 0.000001	time 0.6316 (2.6127)	model_time 0.6312 (0.6320)	loss 0.2562 (0.2370)	grad_norm 1.1432 (0.9152/0.2480)	mem 34630MB
[2025-11-19 13:30:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][150/2882]	eta 1:59:12 lr 0.000001	time 0.6292 (2.6180)	model_time 0.6287 (0.6318)	loss 0.2262 (0.2371)	grad_norm 0.7947 (0.8948/0.2490)	mem 34630MB
[2025-11-19 13:32:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][200/2882]	eta 1:55:45 lr 0.000001	time 0.6317 (2.5896)	model_time 0.6315 (0.6317)	loss 0.2313 (0.2369)	grad_norm 0.9298 (0.8823/0.2343)	mem 34630MB
[2025-11-19 13:34:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][250/2882]	eta 1:54:35 lr 0.000001	time 0.6339 (2.6123)	model_time 0.6335 (0.6317)	loss 0.2266 (0.2375)	grad_norm 0.9898 (0.8991/0.2341)	mem 34630MB
[2025-11-19 13:37:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][300/2882]	eta 1:55:38 lr 0.000001	time 21.4213 (2.6871)	model_time 0.6388 (0.6322)	loss 0.2203 (0.2364)	grad_norm 0.9619 (0.8973/0.2356)	mem 34630MB
[2025-11-19 13:39:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][350/2882]	eta 1:53:10 lr 0.000001	time 5.1906 (2.6818)	model_time 0.6356 (0.6323)	loss 0.2314 (0.2359)	grad_norm 0.8162 (0.8869/0.2302)	mem 34630MB
[2025-11-19 13:41:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][400/2882]	eta 1:50:40 lr 0.000001	time 0.6341 (2.6756)	model_time 0.6339 (0.6323)	loss 0.2060 (0.2357)	grad_norm 0.8294 (0.8955/0.2329)	mem 34630MB
[2025-11-19 13:43:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][450/2882]	eta 1:47:45 lr 0.000001	time 0.6394 (2.6583)	model_time 0.6392 (0.6326)	loss 0.2511 (0.2354)	grad_norm 0.8801 (0.9072/0.2428)	mem 34630MB
[2025-11-19 13:45:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][500/2882]	eta 1:44:47 lr 0.000001	time 0.6298 (2.6397)	model_time 0.6295 (0.6325)	loss 0.2375 (0.2355)	grad_norm 0.9571 (0.9258/0.2549)	mem 34630MB
[2025-11-19 13:47:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][550/2882]	eta 1:41:24 lr 0.000001	time 0.6309 (2.6092)	model_time 0.6306 (0.6324)	loss 0.2066 (0.2354)	grad_norm 0.7280 (0.9192/0.2574)	mem 34630MB
[2025-11-19 13:49:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][600/2882]	eta 1:39:17 lr 0.000001	time 11.5928 (2.6108)	model_time 0.6344 (0.6325)	loss 0.2330 (0.2355)	grad_norm 0.5941 (0.9061/0.2572)	mem 34630MB
[2025-11-19 13:52:17 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][650/2882]	eta 1:38:12 lr 0.000001	time 12.4309 (2.6398)	model_time 0.6337 (0.6325)	loss 0.2221 (0.2356)	grad_norm 0.7040 (0.8978/0.2546)	mem 34630MB
[2025-11-19 13:54:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][700/2882]	eta 1:36:24 lr 0.000001	time 0.6321 (2.6511)	model_time 0.6317 (0.6327)	loss 0.2445 (0.2358)	grad_norm 0.4845 (0.9009/0.2537)	mem 34630MB
[2025-11-19 13:56:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][750/2882]	eta 1:33:39 lr 0.000001	time 0.6324 (2.6358)	model_time 0.6322 (0.6325)	loss 0.2347 (0.2362)	grad_norm 1.2294 (0.8972/0.2354)	mem 34630MB
[2025-11-19 13:58:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][800/2882]	eta 1:30:59 lr 0.000001	time 0.6314 (2.6222)	model_time 0.6310 (0.6323)	loss 0.2502 (0.2362)	grad_norm 0.9354 (0.8864/0.2253)	mem 34630MB
[2025-11-19 14:00:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][850/2882]	eta 1:28:33 lr 0.000001	time 0.6279 (2.6149)	model_time 0.6278 (0.6322)	loss 0.2384 (0.2363)	grad_norm 0.9759 (0.8791/0.2204)	mem 34630MB
[2025-11-19 14:03:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][900/2882]	eta 1:26:57 lr 0.000001	time 11.0102 (2.6324)	model_time 0.6263 (0.6320)	loss 0.2888 (0.2363)	grad_norm 0.8909 (0.8963/0.2119)	mem 34630MB
[2025-11-19 14:05:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][950/2882]	eta 1:25:21 lr 0.000001	time 9.0585 (2.6508)	model_time 0.6351 (0.6321)	loss 0.2320 (0.2364)	grad_norm 0.4666 (0.9103/0.2328)	mem 34630MB
[2025-11-19 14:07:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1000/2882]	eta 1:23:06 lr 0.000001	time 0.6293 (2.6493)	model_time 0.6290 (0.6320)	loss 0.2450 (0.2363)	grad_norm 0.7545 (0.9043/0.2293)	mem 34630MB
[2025-11-19 14:09:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1050/2882]	eta 1:20:41 lr 0.000001	time 0.6339 (2.6427)	model_time 0.6337 (0.6319)	loss 0.2654 (0.2364)	grad_norm 0.8212 (0.9011/0.2294)	mem 34630MB
[2025-11-19 14:12:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1100/2882]	eta 1:18:28 lr 0.000001	time 0.6256 (2.6420)	model_time 0.6254 (0.6319)	loss 0.2300 (0.2363)	grad_norm 0.7605 (0.9095/0.2312)	mem 34630MB
[2025-11-19 14:14:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1150/2882]	eta 1:16:26 lr 0.000001	time 0.6302 (2.6484)	model_time 0.6299 (0.6318)	loss 0.2450 (0.2363)	grad_norm 0.7493 (0.9018/0.2329)	mem 34630MB
[2025-11-19 14:16:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1200/2882]	eta 1:14:38 lr 0.000001	time 7.1833 (2.6628)	model_time 0.6294 (0.6316)	loss 0.2402 (0.2364)	grad_norm 0.9259 (0.8894/0.2358)	mem 34630MB
[2025-11-19 14:19:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1250/2882]	eta 1:13:03 lr 0.000001	time 20.7188 (2.6858)	model_time 0.6283 (0.6315)	loss 0.2202 (0.2362)	grad_norm 0.8284 (0.8747/0.2206)	mem 34630MB
[2025-11-19 14:22:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1300/2882]	eta 1:11:01 lr 0.000001	time 0.6294 (2.6936)	model_time 0.6291 (0.6316)	loss 0.2480 (0.2362)	grad_norm 1.3213 (0.8880/0.2344)	mem 34630MB
[2025-11-19 14:24:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1350/2882]	eta 1:08:57 lr 0.000001	time 0.6319 (2.7005)	model_time 0.6317 (0.6315)	loss 0.2271 (0.2362)	grad_norm 0.6638 (0.8858/0.2418)	mem 34630MB
[2025-11-19 14:26:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1400/2882]	eta 1:06:41 lr 0.000001	time 0.6328 (2.7002)	model_time 0.6323 (0.6314)	loss 0.2374 (0.2363)	grad_norm 0.8266 (0.8682/0.2394)	mem 34630MB
[2025-11-19 14:28:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1450/2882]	eta 1:04:23 lr 0.000001	time 0.6304 (2.6983)	model_time 0.6303 (0.6315)	loss 0.2365 (0.2362)	grad_norm 0.6439 (0.8822/0.2422)	mem 34630MB
[2025-11-19 14:31:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1500/2882]	eta 1:02:29 lr 0.000001	time 16.9297 (2.7133)	model_time 0.6299 (0.6314)	loss 0.2520 (0.2361)	grad_norm 0.6744 (0.8810/0.2470)	mem 34630MB
[2025-11-19 14:33:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1550/2882]	eta 1:00:19 lr 0.000001	time 4.1511 (2.7170)	model_time 0.6320 (0.6315)	loss 0.2231 (0.2361)	grad_norm 0.6336 (0.8875/0.2369)	mem 34630MB
[2025-11-19 14:36:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1600/2882]	eta 0:58:00 lr 0.000001	time 0.6304 (2.7151)	model_time 0.6302 (0.6315)	loss 0.2482 (0.2362)	grad_norm 1.0658 (0.8758/0.2345)	mem 34630MB
[2025-11-19 14:38:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1650/2882]	eta 0:55:43 lr 0.000001	time 0.6317 (2.7142)	model_time 0.6315 (0.6315)	loss 0.2379 (0.2362)	grad_norm 0.8560 (0.8793/0.2340)	mem 34630MB
[2025-11-19 14:40:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1700/2882]	eta 0:53:37 lr 0.000001	time 0.6312 (2.7220)	model_time 0.6310 (0.6316)	loss 0.2146 (0.2362)	grad_norm 0.5993 (0.8879/0.2340)	mem 34630MB
[2025-11-19 15:08:25 internimage_b_mimic_cxr_224] (main.py 729): INFO Full config saved to output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/config.json
[2025-11-19 15:08:25 internimage_b_mimic_cxr_224] (main.py 732): INFO AMP_OPT_LEVEL: O1
AMP_TYPE: float16
AUG:
  AUTO_AUGMENT: none
  COLOR_JITTER: 0.0
  CUTMIX: 0.0
  CUTMIX_MINMAX: null
  MEAN:
  - 0.485
  - 0.456
  - 0.406
  MIXUP: 0.0
  MIXUP_MODE: batch
  MIXUP_PROB: 0.0
  MIXUP_SWITCH_PROB: 0.0
  RANDOM_RESIZED_CROP: false
  RECOUNT: 1
  REMODE: pixel
  REPROB: 0.1
  STD:
  - 0.229
  - 0.224
  - 0.225
BASE:
- ''
DATA:
  BATCH_SIZE: 128
  CACHE_MODE: part
  DATASET: mimic_cxr
  DATA_PATH: /scratch/smehta90/mimic_splits
  IMG_ON_MEMORY: false
  IMG_SIZE: 224
  INTERPOLATION: bicubic
  NUM_WORKERS: 12
  PIN_MEMORY: true
  ZIP_MODE: false
EVAL_22K_TO_1K: false
EVAL_FREQ: 1
EVAL_MODE: false
LOCAL_RANK: 0
MODEL:
  DROP_PATH_RATE: 0.5
  DROP_PATH_TYPE: linear
  DROP_RATE: 0.0
  INTERN_IMAGE:
    CENTER_FEATURE_SCALE: false
    CHANNELS: 112
    CORE_OP: DCNv3
    DEPTHS:
    - 4
    - 4
    - 21
    - 4
    DW_KERNEL_SIZE: null
    GROUPS:
    - 7
    - 14
    - 28
    - 56
    LAYER_SCALE: 1.0e-05
    LEVEL2_POST_NORM: false
    LEVEL2_POST_NORM_BLOCK_IDS: null
    MLP_RATIO: 4.0
    OFFSET_SCALE: 1.0
    POST_NORM: true
    REMOVE_CENTER: false
    RES_POST_NORM: false
    USE_CLIP_PROJECTOR: false
  LABEL_SMOOTHING: 0.0
  NAME: internimage_b_mimic_cxr_224
  NUM_CLASSES: 14
  PRETRAINED: pretrained/internimage_b_1k_224.pth
  RESUME: ''
  TYPE: intern_image
OUTPUT: output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224
PRINT_FREQ: 50
SAVE_CKPT_NUM: 1
SAVE_FREQ: 1
SEED: 42
TAG: run1
TEST:
  CROP: true
  SEQUENTIAL: false
THROUGHPUT_MODE: false
TRAIN:
  ACCUMULATION_STEPS: 1
  AUTO_RESUME: true
  BASE_LR: 0.0001
  CLIP_GRAD: 5.0
  EMA:
    DECAY: 0.9999
    ENABLE: true
  EPOCHS: 20
  LR_LAYER_DECAY: true
  LR_LAYER_DECAY_RATIO: 0.875
  LR_SCHEDULER:
    DECAY_EPOCHS: 30
    DECAY_RATE: 0.1
    NAME: cosine
  MIN_LR: 1.0e-06
  OPTIMIZER:
    BETAS:
    - 0.9
    - 0.999
    DCN_LR_MUL: null
    EPS: 1.0e-08
    FREEZE_BACKBONE: null
    MOMENTUM: 0.9
    NAME: adamw
    USE_ZERO: false
  RAND_INIT_FT_HEAD: true
  START_EPOCH: 0
  USE_CHECKPOINT: false
  WARMUP_EPOCHS: 2
  WARMUP_LR: 5.0e-07
  WEIGHT_DECAY: 0.05

[2025-11-19 15:08:27 internimage_b_mimic_cxr_224] (main.py 175): INFO Creating model:intern_image/internimage_b_mimic_cxr_224
[2025-11-19 15:08:29 internimage_b_mimic_cxr_224] (main.py 178): INFO InternImage(
  (patch_embed): StemLayer(
    (conv1): Conv2d(3, 56, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm1): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((56,), eps=1e-06, elementwise_affine=True)
      (2): to_channels_first()
    )
    (act): GELU(approximate='none')
    (conv2): Conv2d(56, 112, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm2): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
    )
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (levels): ModuleList(
    (0): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): Identity()
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.016)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.031)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.047)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (1): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.062)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.078)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.094)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.109)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (2): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.125)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.141)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.156)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.172)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (4): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.188)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (5): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.203)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (6): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.219)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (7): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.234)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (8): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.250)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (9): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.266)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (10): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.281)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (11): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.297)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (12): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.312)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (13): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.328)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (14): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.344)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (15): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.359)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (16): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.375)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (17): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.391)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (18): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.406)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (19): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.422)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (20): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.438)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(448, 896, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (3): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.453)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.469)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.484)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.500)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (conv_head): Sequential(
    (0): Conv2d(896, 1344, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (1): Sequential(
      (0): BatchNorm2d(1344, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): GELU(approximate='none')
  )
  (head): Linear(in_features=1344, out_features=14, bias=True)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
[2025-11-19 15:08:29 internimage_b_mimic_cxr_224] (main.py 214): INFO Using native Torch AMP. Training in mixed precision.
[2025-11-19 15:08:29 internimage_b_mimic_cxr_224] (main.py 226): INFO using fp16_compress_hook!
[2025-11-19 15:08:29 internimage_b_mimic_cxr_224] (main.py 234): INFO number of params: 96135662
[2025-11-19 15:08:29 internimage_b_mimic_cxr_224] (main.py 247): INFO Using BCEWithLogitsLoss for multi-label classification
[2025-11-19 15:08:29 internimage_b_mimic_cxr_224] (main.py 270): INFO auto resuming from output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_6.pth
[2025-11-19 15:08:29 internimage_b_mimic_cxr_224] (utils.py 60): INFO ==============> Resuming form output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_6.pth....................
[2025-11-19 15:08:33 internimage_b_mimic_cxr_224] (utils.py 92): INFO <All keys matched successfully>
[2025-11-19 15:08:33 internimage_b_mimic_cxr_224] (utils.py 110): INFO => loaded successfully output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_6.pth (epoch 6)
[2025-11-19 15:09:18 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 44.996 (44.996)	Loss 0.2706 (0.2706)	Mem 4564MB
[2025-11-19 15:10:00 internimage_b_mimic_cxr_224] (utils_multilabel.py 141): INFO  * Mean AUC-ROC 0.7978 Loss 0.2338
[2025-11-19 15:10:00 internimage_b_mimic_cxr_224] (utils_multilabel.py 142): INFO  * Per-class AUC-ROC: ['0.8328', '0.8229', '0.8154', '0.9030', '0.7326', '0.5805', '0.7014', '0.7365', '0.8590', '0.9215', '0.7390', '0.7458', '0.8601', '0.9183']
[2025-11-19 15:10:00 internimage_b_mimic_cxr_224] (main.py 283): INFO AUC-ROC of the network on the 2991 val images: 0.7978
[2025-11-19 15:10:01 internimage_b_mimic_cxr_224] (utils.py 24): INFO ==============> Resuming form output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_6.pth....................
[2025-11-19 15:10:02 internimage_b_mimic_cxr_224] (utils.py 44): INFO <All keys matched successfully>
[2025-11-19 15:10:02 internimage_b_mimic_cxr_224] (utils.py 45): INFO Loaded state_dict_ema
[2025-11-19 15:10:11 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 8.631 (8.631)	Loss 0.2888 (0.2888)	Mem 4564MB
[2025-11-19 15:10:23 internimage_b_mimic_cxr_224] (utils_multilabel.py 141): INFO  * Mean AUC-ROC 0.7852 Loss 0.2556
[2025-11-19 15:10:23 internimage_b_mimic_cxr_224] (utils_multilabel.py 142): INFO  * Per-class AUC-ROC: ['0.8217', '0.8061', '0.7981', '0.8968', '0.7141', '0.6002', '0.6895', '0.7293', '0.8503', '0.9089', '0.7230', '0.7309', '0.8128', '0.9110']
[2025-11-19 15:10:23 internimage_b_mimic_cxr_224] (main.py 315): INFO AUC-ROC of the ema network on the 2991 val images: 0.7852
[2025-11-19 15:10:23 internimage_b_mimic_cxr_224] (main.py 331): INFO Start training
[2025-11-19 15:11:25 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][0/2882]	eta 2 days, 1:06:54 lr 0.000001	time 61.3514 (61.3514)	model_time 18.2880 (18.2880)	loss 0.2514 (0.2514)	grad_norm 0.5459 (0.5459/0.0000)	mem 34249MB
[2025-11-19 15:13:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][50/2882]	eta 2:53:50 lr 0.000001	time 0.6278 (3.6832)	model_time 0.6276 (0.9778)	loss 0.2531 (0.2381)	grad_norm 0.7327 (0.9594/0.2118)	mem 34631MB
[2025-11-19 15:15:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][100/2882]	eta 2:26:47 lr 0.000001	time 0.6326 (3.1658)	model_time 0.6323 (0.8054)	loss 0.2605 (0.2369)	grad_norm 1.1799 (0.9185/0.2321)	mem 34631MB
[2025-11-19 15:17:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][150/2882]	eta 2:14:38 lr 0.000001	time 0.6290 (2.9570)	model_time 0.6288 (0.7473)	loss 0.2294 (0.2367)	grad_norm 1.4800 (0.9170/0.2300)	mem 34631MB
[2025-11-19 15:19:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][200/2882]	eta 2:07:11 lr 0.000001	time 0.6343 (2.8453)	model_time 0.6340 (0.7191)	loss 0.2399 (0.2365)	grad_norm 1.0266 (0.9289/0.2257)	mem 34631MB
[2025-11-19 15:22:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][250/2882]	eta 2:01:50 lr 0.000001	time 0.6308 (2.7777)	model_time 0.6305 (0.7015)	loss 0.2203 (0.2371)	grad_norm 0.8607 (0.9200/0.2282)	mem 34631MB
[2025-11-19 15:24:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][300/2882]	eta 2:01:05 lr 0.000001	time 17.8593 (2.8139)	model_time 0.6292 (0.6898)	loss 0.2186 (0.2361)	grad_norm 0.9109 (0.9125/0.2304)	mem 34631MB
[2025-11-19 15:26:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][350/2882]	eta 1:59:28 lr 0.000001	time 1.8395 (2.8311)	model_time 0.6309 (0.6818)	loss 0.2232 (0.2357)	grad_norm 0.7603 (0.9005/0.2358)	mem 34631MB
[2025-11-19 15:29:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][400/2882]	eta 1:56:41 lr 0.000001	time 0.6246 (2.8208)	model_time 0.6244 (0.6754)	loss 0.2135 (0.2356)	grad_norm 1.3137 (0.9108/0.2450)	mem 34631MB
[2025-11-19 15:31:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][450/2882]	eta 1:53:17 lr 0.000001	time 0.7090 (2.7949)	model_time 0.6317 (0.6706)	loss 0.2482 (0.2352)	grad_norm 1.3269 (0.9066/0.2455)	mem 34631MB
[2025-11-19 15:33:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][500/2882]	eta 1:51:31 lr 0.000001	time 0.6301 (2.8091)	model_time 0.6298 (0.6666)	loss 0.2404 (0.2354)	grad_norm 1.2238 (0.8872/0.2430)	mem 34631MB
[2025-11-19 15:36:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][550/2882]	eta 1:49:11 lr 0.000001	time 0.6295 (2.8092)	model_time 0.6292 (0.6636)	loss 0.2078 (0.2354)	grad_norm 1.1824 (0.8910/0.2488)	mem 34631MB
[2025-11-19 15:38:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][600/2882]	eta 1:47:34 lr 0.000001	time 9.3551 (2.8283)	model_time 0.6297 (0.6607)	loss 0.2352 (0.2355)	grad_norm 1.0504 (0.9012/0.2485)	mem 34631MB
[2025-11-19 15:41:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][650/2882]	eta 1:45:09 lr 0.000001	time 0.6321 (2.8269)	model_time 0.6318 (0.6584)	loss 0.2230 (0.2355)	grad_norm 0.8335 (0.9039/0.2473)	mem 34631MB
[2025-11-19 15:43:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][700/2882]	eta 1:42:34 lr 0.000001	time 0.6279 (2.8205)	model_time 0.6277 (0.6564)	loss 0.2460 (0.2358)	grad_norm 1.0286 (0.9046/0.2416)	mem 34631MB
[2025-11-19 15:45:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][750/2882]	eta 1:40:03 lr 0.000001	time 9.5856 (2.8159)	model_time 0.6339 (0.6547)	loss 0.2345 (0.2361)	grad_norm 0.8968 (0.9078/0.2480)	mem 34631MB
[2025-11-19 15:47:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][800/2882]	eta 1:37:06 lr 0.000001	time 0.6366 (2.7986)	model_time 0.6359 (0.6532)	loss 0.2461 (0.2363)	grad_norm 0.7534 (0.9183/0.2569)	mem 34631MB
[2025-11-19 15:49:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][850/2882]	eta 1:34:31 lr 0.000001	time 0.6365 (2.7909)	model_time 0.6362 (0.6521)	loss 0.2435 (0.2363)	grad_norm 0.8920 (0.9127/0.2470)	mem 34631MB
[2025-11-19 15:52:08 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][900/2882]	eta 1:31:48 lr 0.000001	time 0.6303 (2.7795)	model_time 0.6300 (0.6510)	loss 0.2818 (0.2363)	grad_norm 1.7221 (0.9042/0.2453)	mem 34631MB
[2025-11-19 15:54:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][950/2882]	eta 1:30:19 lr 0.000001	time 6.9053 (2.8053)	model_time 0.6317 (0.6500)	loss 0.2321 (0.2363)	grad_norm 0.7987 (0.9087/0.2463)	mem 34631MB
[2025-11-19 15:57:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1000/2882]	eta 1:27:48 lr 0.000001	time 0.6317 (2.7994)	model_time 0.6314 (0.6492)	loss 0.2462 (0.2362)	grad_norm 1.0639 (0.9010/0.2390)	mem 34631MB
[2025-11-19 15:59:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1050/2882]	eta 1:25:26 lr 0.000001	time 13.9631 (2.7982)	model_time 0.6317 (0.6485)	loss 0.2526 (0.2363)	grad_norm 1.0285 (0.8970/0.2237)	mem 34631MB
[2025-11-19 16:01:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1100/2882]	eta 1:23:08 lr 0.000001	time 0.6299 (2.7991)	model_time 0.6297 (0.6477)	loss 0.2345 (0.2362)	grad_norm 1.2987 (0.8958/0.2137)	mem 34631MB
[2025-11-19 16:04:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1150/2882]	eta 1:20:40 lr 0.000001	time 0.6311 (2.7949)	model_time 0.6309 (0.6472)	loss 0.2472 (0.2362)	grad_norm 0.6855 (0.8916/0.2189)	mem 34631MB
[2025-11-19 16:06:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1200/2882]	eta 1:18:34 lr 0.000001	time 0.6369 (2.8029)	model_time 0.6366 (0.6466)	loss 0.2344 (0.2363)	grad_norm 0.4583 (0.8883/0.2158)	mem 34631MB
[2025-11-19 16:09:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1250/2882]	eta 1:16:35 lr 0.000001	time 1.8816 (2.8159)	model_time 0.6343 (0.6461)	loss 0.2147 (0.2361)	grad_norm 0.4830 (0.8724/0.2149)	mem 34631MB
[2025-11-19 16:11:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1300/2882]	eta 1:14:18 lr 0.000001	time 0.6309 (2.8183)	model_time 0.6307 (0.6457)	loss 0.2502 (0.2361)	grad_norm 1.1329 (0.8689/0.2156)	mem 34631MB
[2025-11-19 16:14:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1350/2882]	eta 1:12:32 lr 0.000001	time 27.4322 (2.8408)	model_time 0.6292 (0.6453)	loss 0.2356 (0.2361)	grad_norm 0.7954 (0.8690/0.2248)	mem 34631MB
[2025-11-19 16:16:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1400/2882]	eta 1:10:04 lr 0.000001	time 0.6323 (2.8370)	model_time 0.6321 (0.6448)	loss 0.2361 (0.2362)	grad_norm 0.9847 (0.8692/0.2208)	mem 34631MB
[2025-11-19 16:19:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1450/2882]	eta 1:07:45 lr 0.000001	time 0.6286 (2.8389)	model_time 0.6284 (0.6445)	loss 0.2291 (0.2362)	grad_norm 0.4845 (0.8692/0.2209)	mem 34631MB
[2025-11-19 16:21:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1500/2882]	eta 1:05:22 lr 0.000001	time 0.6290 (2.8385)	model_time 0.6285 (0.6440)	loss 0.2555 (0.2361)	grad_norm 1.0143 (0.8801/0.2254)	mem 34631MB
[2025-11-19 16:23:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1550/2882]	eta 1:03:06 lr 0.000001	time 0.6362 (2.8426)	model_time 0.6359 (0.6438)	loss 0.2261 (0.2361)	grad_norm 1.2530 (0.8873/0.2184)	mem 34631MB
[2025-11-19 16:26:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1600/2882]	eta 1:00:57 lr 0.000001	time 0.6268 (2.8532)	model_time 0.6266 (0.6433)	loss 0.2493 (0.2361)	grad_norm 1.0573 (0.8823/0.2112)	mem 34631MB
[2025-11-19 16:29:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1650/2882]	eta 0:59:10 lr 0.000001	time 34.6042 (2.8819)	model_time 0.6352 (0.6430)	loss 0.2332 (0.2362)	grad_norm 0.8065 (0.8723/0.2055)	mem 34631MB
[2025-11-19 16:32:17 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1700/2882]	eta 0:56:54 lr 0.000001	time 0.6310 (2.8885)	model_time 0.6307 (0.6427)	loss 0.2201 (0.2361)	grad_norm 0.8273 (0.8683/0.2098)	mem 34631MB
[2025-11-19 16:34:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1750/2882]	eta 0:54:36 lr 0.000001	time 0.6323 (2.8942)	model_time 0.6321 (0.6424)	loss 0.2155 (0.2361)	grad_norm 1.1780 (0.8815/0.2100)	mem 34631MB
[2025-11-19 16:37:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1800/2882]	eta 0:52:16 lr 0.000001	time 0.6297 (2.8989)	model_time 0.6295 (0.6421)	loss 0.2523 (0.2361)	grad_norm 0.9464 (0.8727/0.2090)	mem 34631MB
[2025-11-19 16:39:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1850/2882]	eta 0:49:52 lr 0.000001	time 0.6302 (2.8995)	model_time 0.6300 (0.6419)	loss 0.2369 (0.2360)	grad_norm 1.1067 (0.8639/0.2161)	mem 34631MB
[2025-11-19 16:42:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1900/2882]	eta 0:47:36 lr 0.000001	time 0.6317 (2.9093)	model_time 0.6313 (0.6416)	loss 0.2352 (0.2359)	grad_norm 0.8288 (0.8850/0.2324)	mem 34631MB
[2025-11-19 16:45:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][1950/2882]	eta 0:45:39 lr 0.000001	time 32.7423 (2.9393)	model_time 0.6320 (0.6414)	loss 0.2360 (0.2360)	grad_norm 0.6122 (0.9061/0.2465)	mem 34631MB
[2025-11-19 16:48:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2000/2882]	eta 0:43:21 lr 0.000001	time 0.6264 (2.9500)	model_time 0.6261 (0.6411)	loss 0.2391 (0.2360)	grad_norm 0.8459 (0.9068/0.2493)	mem 34631MB
[2025-11-19 16:51:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2050/2882]	eta 0:41:11 lr 0.000001	time 0.6287 (2.9709)	model_time 0.6284 (0.6409)	loss 0.2733 (0.2359)	grad_norm 1.2537 (0.8974/0.2495)	mem 34631MB
[2025-11-19 16:55:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2100/2882]	eta 0:38:56 lr 0.000001	time 0.6355 (2.9875)	model_time 0.6350 (0.6407)	loss 0.2584 (0.2359)	grad_norm 0.6014 (0.8873/0.2459)	mem 34631MB
[2025-11-19 16:58:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2150/2882]	eta 0:36:38 lr 0.000001	time 0.6323 (3.0028)	model_time 0.6321 (0.6405)	loss 0.2328 (0.2360)	grad_norm 1.1188 (0.8984/0.2379)	mem 34631MB
[2025-11-19 17:00:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2200/2882]	eta 0:34:15 lr 0.000001	time 0.6335 (3.0135)	model_time 0.6333 (0.6403)	loss 0.2316 (0.2360)	grad_norm 0.9768 (0.8868/0.2322)	mem 34631MB
[2025-11-19 17:04:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2250/2882]	eta 0:31:57 lr 0.000001	time 33.4490 (3.0343)	model_time 0.6303 (0.6402)	loss 0.2052 (0.2359)	grad_norm 0.8097 (0.8762/0.2223)	mem 34631MB
[2025-11-19 17:07:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2300/2882]	eta 0:29:32 lr 0.000001	time 0.6358 (3.0458)	model_time 0.6354 (0.6401)	loss 0.2338 (0.2360)	grad_norm 0.5017 (0.8780/0.2350)	mem 34631MB
[2025-11-19 17:09:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2350/2882]	eta 0:27:02 lr 0.000001	time 0.6246 (3.0507)	model_time 0.6243 (0.6400)	loss 0.2475 (0.2360)	grad_norm 0.6018 (0.8863/0.2361)	mem 34631MB
[2025-11-19 17:12:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2400/2882]	eta 0:24:34 lr 0.000001	time 0.6287 (3.0598)	model_time 0.6285 (0.6400)	loss 0.2370 (0.2360)	grad_norm 1.3874 (0.8967/0.2406)	mem 34631MB
[2025-11-19 17:15:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2450/2882]	eta 0:22:07 lr 0.000001	time 0.6303 (3.0726)	model_time 0.6298 (0.6399)	loss 0.2433 (0.2360)	grad_norm 1.0200 (0.8932/0.2475)	mem 34631MB
[2025-11-19 17:18:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2500/2882]	eta 0:19:37 lr 0.000001	time 0.6294 (3.0821)	model_time 0.6292 (0.6397)	loss 0.2275 (0.2360)	grad_norm 0.5301 (0.9009/0.2510)	mem 34631MB
[2025-11-19 17:22:23 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2550/2882]	eta 0:17:10 lr 0.000001	time 37.0692 (3.1044)	model_time 0.6330 (0.6396)	loss 0.2463 (0.2361)	grad_norm 1.0227 (0.9084/0.2465)	mem 34631MB
[2025-11-19 17:25:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2600/2882]	eta 0:14:37 lr 0.000001	time 0.6258 (3.1108)	model_time 0.6256 (0.6394)	loss 0.2371 (0.2360)	grad_norm 0.7027 (0.9130/0.2346)	mem 34631MB
[2025-11-19 17:28:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2650/2882]	eta 0:12:03 lr 0.000001	time 0.6294 (3.1164)	model_time 0.6292 (0.6393)	loss 0.2399 (0.2360)	grad_norm 0.9554 (0.9058/0.2284)	mem 34631MB
[2025-11-19 17:31:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2700/2882]	eta 0:09:28 lr 0.000001	time 0.6330 (3.1257)	model_time 0.6328 (0.6391)	loss 0.2173 (0.2361)	grad_norm 0.8226 (0.9161/0.2233)	mem 34631MB
[2025-11-19 17:34:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2750/2882]	eta 0:06:53 lr 0.000001	time 0.6330 (3.1320)	model_time 0.6328 (0.6389)	loss 0.2442 (0.2361)	grad_norm 0.6490 (0.9031/0.2216)	mem 34631MB
[2025-11-19 17:36:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2800/2882]	eta 0:04:16 lr 0.000001	time 0.6329 (3.1284)	model_time 0.6327 (0.6388)	loss 0.2725 (0.2361)	grad_norm 1.8505 (0.8987/0.2194)	mem 34631MB
[2025-11-19 17:39:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [7/20][2850/2882]	eta 0:01:40 lr 0.000001	time 29.0855 (3.1401)	model_time 0.6320 (0.6387)	loss 0.2481 (0.2360)	grad_norm 0.8129 (0.8955/0.2225)	mem 34631MB
[2025-11-19 17:41:00 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 7 training takes 2:30:36
[2025-11-19 17:41:00 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_7.pth saving......
[2025-11-19 17:41:02 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_7.pth saved !!!
[2025-11-19 17:41:37 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 35.155 (35.155)	Loss 0.2722 (0.2722)	Mem 34631MB
[2025-11-19 17:42:22 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:7] * Mean AUC-ROC 0.8030 Loss 0.2332
[2025-11-19 17:42:22 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:7] * Per-class AUC-ROC: ['0.8359', '0.8253', '0.8131', '0.9014', '0.7388', '0.5818', '0.7270', '0.7395', '0.8597', '0.9215', '0.7533', '0.7553', '0.8690', '0.9203']
[2025-11-19 17:42:22 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.8030
[2025-11-19 17:42:22 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-19 17:42:24 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-19 17:42:24 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.8030
[2025-11-19 17:42:34 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 9.496 (9.496)	Loss 0.2826 (0.2826)	Mem 34631MB
[2025-11-19 17:42:50 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:7] * Mean AUC-ROC 0.7909 Loss 0.2476
[2025-11-19 17:42:50 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:7] * Per-class AUC-ROC: ['0.8265', '0.8136', '0.8044', '0.8991', '0.7216', '0.6022', '0.6949', '0.7323', '0.8534', '0.9138', '0.7286', '0.7369', '0.8314', '0.9137']
[2025-11-19 17:42:50 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.7909
[2025-11-19 17:42:50 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-19 17:42:52 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-19 17:42:52 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.7909
[2025-11-19 17:43:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][0/2882]	eta 1 day, 9:59:45 lr 0.000001	time 42.4653 (42.4653)	model_time 0.6347 (0.6347)	loss 0.2426 (0.2426)	grad_norm 1.2685 (1.2685/0.0000)	mem 34631MB
[2025-11-19 17:46:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][50/2882]	eta 2:59:29 lr 0.000001	time 0.6304 (3.8029)	model_time 0.6301 (0.6324)	loss 0.2140 (0.2326)	grad_norm 0.9988 (0.8711/0.2176)	mem 34631MB
[2025-11-19 17:48:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][100/2882]	eta 2:41:27 lr 0.000001	time 0.6326 (3.4823)	model_time 0.6323 (0.6341)	loss 0.2298 (0.2337)	grad_norm 0.8501 (0.8839/0.2333)	mem 34631MB
[2025-11-19 17:51:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][150/2882]	eta 2:29:11 lr 0.000001	time 0.6362 (3.2766)	model_time 0.6356 (0.6335)	loss 0.2309 (0.2323)	grad_norm 0.8458 (0.8769/0.2352)	mem 34631MB
[2025-11-19 17:53:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][200/2882]	eta 2:22:54 lr 0.000001	time 0.6360 (3.1970)	model_time 0.6357 (0.6334)	loss 0.2362 (0.2334)	grad_norm 1.1175 (0.8949/0.2357)	mem 34631MB
[2025-11-19 17:56:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][250/2882]	eta 2:19:01 lr 0.000001	time 0.6362 (3.1693)	model_time 0.6360 (0.6333)	loss 0.2320 (0.2344)	grad_norm 0.6658 (0.8834/0.2295)	mem 34631MB
[2025-11-19 17:59:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][300/2882]	eta 2:20:40 lr 0.000001	time 30.8327 (3.2691)	model_time 0.6369 (0.6333)	loss 0.2468 (0.2356)	grad_norm 1.1478 (0.8833/0.2246)	mem 34631MB
[2025-11-19 18:01:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][350/2882]	eta 2:17:11 lr 0.000001	time 0.6306 (3.2510)	model_time 0.6303 (0.6333)	loss 0.2219 (0.2350)	grad_norm 0.5708 (0.8851/0.2308)	mem 34631MB
[2025-11-19 18:04:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][400/2882]	eta 2:15:09 lr 0.000001	time 0.6349 (3.2674)	model_time 0.6346 (0.6335)	loss 0.2404 (0.2355)	grad_norm 1.1749 (0.8826/0.2324)	mem 34631MB
[2025-11-19 18:07:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][450/2882]	eta 2:11:59 lr 0.000001	time 0.6286 (3.2563)	model_time 0.6283 (0.6335)	loss 0.2180 (0.2352)	grad_norm 0.7841 (0.8900/0.2286)	mem 34631MB
[2025-11-19 18:10:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][500/2882]	eta 2:09:50 lr 0.000001	time 10.8198 (3.2707)	model_time 0.6317 (0.6337)	loss 0.2475 (0.2356)	grad_norm 0.7154 (0.8877/0.2342)	mem 34631MB
[2025-11-19 18:12:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][550/2882]	eta 2:06:58 lr 0.000001	time 0.6356 (3.2668)	model_time 0.6352 (0.6338)	loss 0.2182 (0.2356)	grad_norm 0.7033 (0.8974/0.2463)	mem 34631MB
[2025-11-19 18:15:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][600/2882]	eta 2:04:28 lr 0.000001	time 5.0846 (3.2726)	model_time 0.6334 (0.6337)	loss 0.2323 (0.2356)	grad_norm 0.8386 (0.9039/0.2590)	mem 34631MB
[2025-11-19 18:18:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][650/2882]	eta 2:02:08 lr 0.000001	time 0.6547 (3.2832)	model_time 0.6545 (0.6340)	loss 0.2386 (0.2355)	grad_norm 0.4963 (0.9119/0.2544)	mem 34631MB
[2025-11-19 18:21:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][700/2882]	eta 1:59:27 lr 0.000001	time 0.6353 (3.2849)	model_time 0.6350 (0.6344)	loss 0.2426 (0.2355)	grad_norm 0.9094 (0.9113/0.2499)	mem 34631MB
[2025-11-19 18:24:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][750/2882]	eta 1:57:06 lr 0.000001	time 0.6338 (3.2955)	model_time 0.6336 (0.6345)	loss 0.2273 (0.2358)	grad_norm 1.0090 (0.9055/0.2538)	mem 34631MB
[2025-11-19 18:27:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][800/2882]	eta 1:55:26 lr 0.000001	time 14.9864 (3.3266)	model_time 0.6331 (0.6345)	loss 0.2451 (0.2357)	grad_norm 1.0437 (0.8940/0.2406)	mem 34631MB
[2025-11-19 18:30:08 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][850/2882]	eta 1:52:52 lr 0.000001	time 0.6276 (3.3328)	model_time 0.6274 (0.6346)	loss 0.2466 (0.2355)	grad_norm 0.9091 (0.8975/0.2334)	mem 34631MB
[2025-11-19 18:32:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][900/2882]	eta 1:50:09 lr 0.000001	time 10.2402 (3.3349)	model_time 0.6335 (0.6345)	loss 0.2300 (0.2355)	grad_norm 1.2689 (0.8898/0.2219)	mem 34631MB
[2025-11-19 18:35:17 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][950/2882]	eta 1:46:30 lr 0.000001	time 0.6318 (3.3077)	model_time 0.6316 (0.6344)	loss 0.2369 (0.2355)	grad_norm 1.4820 (0.8825/0.2209)	mem 34631MB
[2025-11-19 18:37:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1000/2882]	eta 1:43:10 lr 0.000001	time 9.3148 (3.2891)	model_time 0.6324 (0.6345)	loss 0.2277 (0.2354)	grad_norm 1.0436 (0.8900/0.2218)	mem 34631MB
[2025-11-19 18:40:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1050/2882]	eta 1:39:43 lr 0.000001	time 4.0032 (3.2663)	model_time 0.6338 (0.6344)	loss 0.2328 (0.2354)	grad_norm 0.8337 (0.8941/0.2197)	mem 34631MB
[2025-11-19 18:42:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1100/2882]	eta 1:36:58 lr 0.000001	time 15.6111 (3.2650)	model_time 0.6301 (0.6343)	loss 0.2368 (0.2354)	grad_norm 0.7869 (0.8845/0.2298)	mem 34631MB
[2025-11-19 18:45:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1150/2882]	eta 1:33:37 lr 0.000001	time 0.6319 (3.2432)	model_time 0.6316 (0.6343)	loss 0.2076 (0.2354)	grad_norm 0.7722 (0.8796/0.2251)	mem 34631MB
[2025-11-19 18:47:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1200/2882]	eta 1:30:26 lr 0.000001	time 0.6358 (3.2263)	model_time 0.6355 (0.6342)	loss 0.2428 (0.2355)	grad_norm 0.8124 (0.8727/0.2210)	mem 34631MB
[2025-11-19 18:49:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1250/2882]	eta 1:27:25 lr 0.000001	time 0.6347 (3.2142)	model_time 0.6344 (0.6342)	loss 0.2196 (0.2353)	grad_norm 0.7210 (0.8681/0.2214)	mem 34631MB
[2025-11-19 18:52:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1300/2882]	eta 1:24:38 lr 0.000001	time 3.7545 (3.2102)	model_time 0.6321 (0.6341)	loss 0.2448 (0.2354)	grad_norm 0.7238 (0.8594/0.2201)	mem 34631MB
[2025-11-19 18:55:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1350/2882]	eta 1:21:50 lr 0.000001	time 9.7467 (3.2054)	model_time 0.6318 (0.6340)	loss 0.2214 (0.2355)	grad_norm 0.8100 (0.8549/0.2198)	mem 34631MB
[2025-11-19 18:57:25 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1400/2882]	eta 1:18:52 lr 0.000001	time 4.8251 (3.1933)	model_time 0.6308 (0.6340)	loss 0.2262 (0.2355)	grad_norm 1.7085 (0.8622/0.2245)	mem 34631MB
[2025-11-19 18:59:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1450/2882]	eta 1:15:48 lr 0.000001	time 0.6387 (3.1761)	model_time 0.6385 (0.6339)	loss 0.2514 (0.2354)	grad_norm 1.4509 (0.8572/0.2261)	mem 34631MB
[2025-11-19 19:02:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1500/2882]	eta 1:12:51 lr 0.000001	time 0.6371 (3.1634)	model_time 0.6368 (0.6340)	loss 0.2399 (0.2354)	grad_norm 0.9431 (0.8665/0.2281)	mem 34631MB
[2025-11-19 19:04:22 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1550/2882]	eta 1:10:00 lr 0.000001	time 3.9086 (3.1534)	model_time 0.6332 (0.6340)	loss 0.2402 (0.2354)	grad_norm 0.5764 (0.8713/0.2288)	mem 34631MB
[2025-11-19 19:06:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1600/2882]	eta 1:07:17 lr 0.000001	time 0.6315 (3.1491)	model_time 0.6313 (0.6339)	loss 0.2627 (0.2354)	grad_norm 0.4997 (0.8795/0.2323)	mem 34631MB
[2025-11-19 19:09:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1650/2882]	eta 1:04:30 lr 0.000001	time 2.1151 (3.1413)	model_time 0.6323 (0.6339)	loss 0.2250 (0.2354)	grad_norm 0.8827 (0.8672/0.2340)	mem 34631MB
[2025-11-19 19:11:33 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1700/2882]	eta 1:01:37 lr 0.000001	time 0.9636 (3.1284)	model_time 0.6399 (0.6340)	loss 0.2140 (0.2355)	grad_norm 0.6395 (0.8807/0.2261)	mem 34631MB
[2025-11-19 19:13:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1750/2882]	eta 0:58:52 lr 0.000001	time 0.6294 (3.1208)	model_time 0.6292 (0.6340)	loss 0.2501 (0.2356)	grad_norm 0.6741 (0.8849/0.2204)	mem 34631MB
[2025-11-19 19:16:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1800/2882]	eta 0:56:00 lr 0.000001	time 0.6345 (3.1055)	model_time 0.6342 (0.6340)	loss 0.2142 (0.2355)	grad_norm 0.5362 (0.8817/0.2153)	mem 34631MB
[2025-11-19 19:18:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1850/2882]	eta 0:53:09 lr 0.000001	time 0.6301 (3.0910)	model_time 0.6299 (0.6340)	loss 0.2227 (0.2355)	grad_norm 1.3321 (0.8960/0.2220)	mem 34631MB
[2025-11-19 19:20:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1900/2882]	eta 0:50:33 lr 0.000001	time 0.6308 (3.0894)	model_time 0.6305 (0.6340)	loss 0.2045 (0.2355)	grad_norm 0.6941 (0.8876/0.2253)	mem 34631MB
[2025-11-19 19:23:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][1950/2882]	eta 0:48:04 lr 0.000001	time 17.0741 (3.0945)	model_time 0.8179 (0.6341)	loss 0.2101 (0.2354)	grad_norm 0.8199 (0.8993/0.2147)	mem 34631MB
[2025-11-19 19:26:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2000/2882]	eta 0:45:33 lr 0.000001	time 3.9442 (3.0988)	model_time 0.6327 (0.6341)	loss 0.2141 (0.2354)	grad_norm 1.0292 (0.8951/0.2185)	mem 34631MB
[2025-11-19 19:28:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2050/2882]	eta 0:42:54 lr 0.000001	time 0.6345 (3.0939)	model_time 0.6342 (0.6341)	loss 0.1966 (0.2354)	grad_norm 0.9904 (0.8905/0.2270)	mem 34631MB
[2025-11-19 19:31:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2100/2882]	eta 0:40:19 lr 0.000001	time 0.6295 (3.0945)	model_time 0.6293 (0.6341)	loss 0.2756 (0.2354)	grad_norm 1.0435 (0.9026/0.2350)	mem 34631MB
[2025-11-19 19:33:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2150/2882]	eta 0:37:47 lr 0.000001	time 0.6339 (3.0973)	model_time 0.6336 (0.6341)	loss 0.2138 (0.2353)	grad_norm 1.5906 (0.8999/0.2446)	mem 34631MB
[2025-11-19 19:36:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2200/2882]	eta 0:35:15 lr 0.000001	time 0.6323 (3.1024)	model_time 0.6320 (0.6340)	loss 0.2527 (0.2353)	grad_norm 0.8687 (0.9086/0.2425)	mem 34631MB
[2025-11-19 19:39:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2250/2882]	eta 0:32:48 lr 0.000001	time 27.1653 (3.1140)	model_time 0.6306 (0.6340)	loss 0.2330 (0.2352)	grad_norm 0.7077 (0.9065/0.2454)	mem 34631MB
[2025-11-19 19:42:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2300/2882]	eta 0:30:13 lr 0.000001	time 0.6279 (3.1157)	model_time 0.6277 (0.6340)	loss 0.2325 (0.2352)	grad_norm 0.6666 (0.9066/0.2446)	mem 34631MB
[2025-11-19 19:45:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2350/2882]	eta 0:27:38 lr 0.000001	time 0.6429 (3.1170)	model_time 0.6426 (0.6341)	loss 0.2326 (0.2352)	grad_norm 0.8938 (0.9165/0.2444)	mem 34631MB
[2025-11-19 19:47:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2400/2882]	eta 0:25:02 lr 0.000001	time 0.6413 (3.1180)	model_time 0.6411 (0.6341)	loss 0.2499 (0.2352)	grad_norm 0.7664 (0.9185/0.2560)	mem 34631MB
[2025-11-19 19:50:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2450/2882]	eta 0:22:29 lr 0.000001	time 0.6369 (3.1244)	model_time 0.6366 (0.6341)	loss 0.2185 (0.2351)	grad_norm 0.6878 (0.9127/0.2414)	mem 34631MB
[2025-11-19 19:53:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2500/2882]	eta 0:19:54 lr 0.000001	time 0.6401 (3.1269)	model_time 0.6398 (0.6342)	loss 0.2385 (0.2351)	grad_norm 1.4626 (0.9059/0.2329)	mem 34631MB
[2025-11-19 19:56:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2550/2882]	eta 0:17:20 lr 0.000001	time 26.5767 (3.1354)	model_time 0.6422 (0.6342)	loss 0.2121 (0.2350)	grad_norm 0.7425 (0.9109/0.2333)	mem 34631MB
[2025-11-19 19:58:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2600/2882]	eta 0:14:44 lr 0.000001	time 0.6325 (3.1366)	model_time 0.6322 (0.6342)	loss 0.2509 (0.2350)	grad_norm 0.8805 (0.9071/0.2336)	mem 34631MB
[2025-11-19 20:01:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2650/2882]	eta 0:12:07 lr 0.000001	time 0.6356 (3.1343)	model_time 0.6353 (0.6342)	loss 0.2128 (0.2350)	grad_norm 0.9569 (0.9037/0.2310)	mem 34631MB
[2025-11-19 20:04:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2700/2882]	eta 0:09:30 lr 0.000001	time 0.6389 (3.1364)	model_time 0.6386 (0.6342)	loss 0.2349 (0.2350)	grad_norm 0.9386 (0.9082/0.2210)	mem 34631MB
[2025-11-19 20:06:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2750/2882]	eta 0:06:53 lr 0.000001	time 0.6302 (3.1355)	model_time 0.6300 (0.6342)	loss 0.2411 (0.2351)	grad_norm 0.5487 (0.9059/0.2161)	mem 34631MB
[2025-11-19 20:09:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2800/2882]	eta 0:04:17 lr 0.000001	time 0.6353 (3.1360)	model_time 0.6350 (0.6342)	loss 0.2075 (0.2351)	grad_norm 1.1257 (0.9058/0.2185)	mem 34631MB
[2025-11-19 20:12:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [8/20][2850/2882]	eta 0:01:40 lr 0.000001	time 19.8078 (3.1450)	model_time 0.6317 (0.6342)	loss 0.2184 (0.2351)	grad_norm 0.9762 (0.9100/0.2192)	mem 34631MB
[2025-11-19 20:13:47 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 8 training takes 2:30:55
[2025-11-19 20:13:47 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_8.pth saving......
[2025-11-19 20:13:50 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_8.pth saved !!!
[2025-11-19 20:14:29 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 39.514 (39.514)	Loss 0.2680 (0.2680)	Mem 34631MB
[2025-11-19 20:15:15 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:8] * Mean AUC-ROC 0.8058 Loss 0.2312
[2025-11-19 20:15:15 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:8] * Per-class AUC-ROC: ['0.8366', '0.8265', '0.8128', '0.9031', '0.7386', '0.5782', '0.7410', '0.7422', '0.8624', '0.9229', '0.7603', '0.7553', '0.8791', '0.9220']
[2025-11-19 20:15:15 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.8058
[2025-11-19 20:15:15 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-19 20:15:18 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-19 20:15:18 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.8058
[2025-11-19 20:15:29 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 10.843 (10.843)	Loss 0.2786 (0.2786)	Mem 34631MB
[2025-11-19 20:15:45 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:8] * Mean AUC-ROC 0.7953 Loss 0.2424
[2025-11-19 20:15:45 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:8] * Per-class AUC-ROC: ['0.8298', '0.8189', '0.8092', '0.9008', '0.7274', '0.6019', '0.7004', '0.7350', '0.8559', '0.9169', '0.7340', '0.7428', '0.8459', '0.9157']
[2025-11-19 20:15:45 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.7953
[2025-11-19 20:15:45 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-19 20:15:47 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-19 20:15:47 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.7953
[2025-11-19 20:16:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][0/2882]	eta 1 day, 8:55:03 lr 0.000001	time 41.1184 (41.1184)	model_time 0.6376 (0.6376)	loss 0.2228 (0.2228)	grad_norm 0.6860 (0.6860/0.0000)	mem 34631MB
[2025-11-19 20:19:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][50/2882]	eta 3:13:00 lr 0.000001	time 0.6311 (4.0892)	model_time 0.6309 (0.6307)	loss 0.2316 (0.2332)	grad_norm 0.9216 (0.9052/0.2880)	mem 34631MB
[2025-11-19 20:21:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][100/2882]	eta 2:47:15 lr 0.000001	time 0.6275 (3.6074)	model_time 0.6273 (0.6311)	loss 0.2080 (0.2340)	grad_norm 0.6896 (0.8620/0.2736)	mem 34631MB
[2025-11-19 20:24:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][150/2882]	eta 2:34:50 lr 0.000001	time 0.6313 (3.4006)	model_time 0.6309 (0.6328)	loss 0.2016 (0.2360)	grad_norm 0.9373 (0.8755/0.2583)	mem 34631MB
[2025-11-19 20:26:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][200/2882]	eta 2:27:50 lr 0.000001	time 0.6300 (3.3073)	model_time 0.6298 (0.6329)	loss 0.2318 (0.2353)	grad_norm 0.6347 (0.8749/0.2524)	mem 34631MB
[2025-11-19 20:29:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][250/2882]	eta 2:21:20 lr 0.000001	time 0.6353 (3.2223)	model_time 0.6350 (0.6333)	loss 0.2249 (0.2355)	grad_norm 0.5650 (0.8847/0.2480)	mem 34631MB
[2025-11-19 20:32:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][300/2882]	eta 2:22:06 lr 0.000001	time 32.0597 (3.3024)	model_time 0.6356 (0.6334)	loss 0.2370 (0.2354)	grad_norm 1.2513 (0.8836/0.2439)	mem 34631MB
[2025-11-19 20:34:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][350/2882]	eta 2:17:13 lr 0.000001	time 0.6316 (3.2519)	model_time 0.6314 (0.6333)	loss 0.2315 (0.2347)	grad_norm 1.0189 (0.8817/0.2340)	mem 34631MB
[2025-11-19 20:37:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][400/2882]	eta 2:12:36 lr 0.000001	time 0.6349 (3.2059)	model_time 0.6347 (0.6331)	loss 0.2255 (0.2344)	grad_norm 0.6750 (0.8990/0.2251)	mem 34631MB
[2025-11-19 20:39:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][450/2882]	eta 2:07:46 lr 0.000001	time 0.6285 (3.1521)	model_time 0.6283 (0.6328)	loss 0.2482 (0.2344)	grad_norm 0.8720 (0.8930/0.2257)	mem 34631MB
[2025-11-19 20:41:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][500/2882]	eta 2:03:45 lr 0.000001	time 0.6308 (3.1172)	model_time 0.6306 (0.6326)	loss 0.2458 (0.2346)	grad_norm 0.9952 (0.9019/0.2251)	mem 34631MB
[2025-11-19 20:44:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][550/2882]	eta 1:59:27 lr 0.000001	time 0.6342 (3.0737)	model_time 0.6339 (0.6329)	loss 0.2684 (0.2344)	grad_norm 0.8550 (0.9012/0.2358)	mem 34631MB
[2025-11-19 20:46:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][600/2882]	eta 1:57:13 lr 0.000001	time 25.3175 (3.0824)	model_time 0.6348 (0.6328)	loss 0.2020 (0.2344)	grad_norm 0.9066 (0.9102/0.2436)	mem 34631MB
[2025-11-19 20:48:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][650/2882]	eta 1:53:26 lr 0.000001	time 0.6354 (3.0495)	model_time 0.6351 (0.6328)	loss 0.2227 (0.2345)	grad_norm 0.6829 (0.9113/0.2385)	mem 34631MB
[2025-11-19 20:51:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][700/2882]	eta 1:49:54 lr 0.000001	time 0.6340 (3.0223)	model_time 0.6338 (0.6331)	loss 0.2216 (0.2343)	grad_norm 0.8900 (0.9110/0.2424)	mem 34631MB
[2025-11-19 20:53:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][750/2882]	eta 1:47:02 lr 0.000001	time 0.6337 (3.0125)	model_time 0.6334 (0.6331)	loss 0.2339 (0.2341)	grad_norm 1.0322 (0.9229/0.2491)	mem 34631MB
[2025-11-19 20:55:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][800/2882]	eta 1:43:52 lr 0.000001	time 0.6327 (2.9934)	model_time 0.6324 (0.6330)	loss 0.2626 (0.2342)	grad_norm 1.2934 (0.9249/0.2503)	mem 34631MB
[2025-11-19 20:58:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][850/2882]	eta 1:40:49 lr 0.000001	time 0.6301 (2.9770)	model_time 0.6296 (0.6332)	loss 0.2366 (0.2343)	grad_norm 0.8829 (0.9178/0.2492)	mem 34631MB
[2025-11-19 21:00:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][900/2882]	eta 1:38:36 lr 0.000001	time 25.0820 (2.9850)	model_time 0.5491 (0.6331)	loss 0.2294 (0.2343)	grad_norm inf (0.9073/0.2442)	mem 34631MB
[2025-11-19 21:02:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][950/2882]	eta 1:35:33 lr 0.000001	time 0.6314 (2.9678)	model_time 0.6312 (0.6331)	loss 0.2373 (0.2344)	grad_norm 1.3237 (0.9055/0.2546)	mem 34631MB
[2025-11-19 21:05:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1000/2882]	eta 1:33:26 lr 0.000001	time 0.6287 (2.9792)	model_time 0.6286 (0.6332)	loss 0.2184 (0.2344)	grad_norm 1.1787 (0.9013/0.2583)	mem 34631MB
[2025-11-19 21:07:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1050/2882]	eta 1:31:00 lr 0.000001	time 8.2915 (2.9805)	model_time 0.6370 (0.6332)	loss 0.2101 (0.2347)	grad_norm 0.6133 (0.8967/0.2521)	mem 34631MB
[2025-11-19 21:10:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1100/2882]	eta 1:28:13 lr 0.000001	time 0.6363 (2.9706)	model_time 0.6359 (0.6332)	loss 0.2263 (0.2347)	grad_norm 1.1539 (0.8968/0.2479)	mem 34631MB
[2025-11-19 21:12:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1150/2882]	eta 1:25:18 lr 0.000001	time 0.6359 (2.9553)	model_time 0.6356 (0.6334)	loss 0.2277 (0.2345)	grad_norm 0.6275 (0.8872/0.2346)	mem 34631MB
[2025-11-19 21:14:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1200/2882]	eta 1:22:55 lr 0.000001	time 16.9952 (2.9580)	model_time 0.6365 (0.6334)	loss 0.2264 (0.2343)	grad_norm 1.0123 (0.8897/0.2342)	mem 34631MB
[2025-11-19 21:17:08 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1250/2882]	eta 1:20:02 lr 0.000001	time 0.6304 (2.9425)	model_time 0.6302 (0.6336)	loss 0.2393 (0.2344)	grad_norm 0.7754 (0.8949/0.2377)	mem 34631MB
[2025-11-19 21:19:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1300/2882]	eta 1:17:21 lr 0.000001	time 0.6288 (2.9340)	model_time 0.6286 (0.6336)	loss 0.2128 (0.2344)	grad_norm 0.9771 (0.8913/0.2255)	mem 34631MB
[2025-11-19 21:22:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1350/2882]	eta 1:15:13 lr 0.000001	time 18.7390 (2.9461)	model_time 0.6458 (0.6337)	loss 0.2491 (0.2345)	grad_norm 0.9391 (0.8908/0.2321)	mem 34631MB
[2025-11-19 21:24:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1400/2882]	eta 1:12:48 lr 0.000001	time 0.6314 (2.9479)	model_time 0.6312 (0.6338)	loss 0.2050 (0.2345)	grad_norm 0.8203 (0.8872/0.2344)	mem 34631MB
[2025-11-19 21:27:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1450/2882]	eta 1:10:34 lr 0.000001	time 0.6326 (2.9571)	model_time 0.6323 (0.6337)	loss 0.2241 (0.2345)	grad_norm 0.7039 (0.8925/0.2425)	mem 34631MB
[2025-11-19 21:29:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1500/2882]	eta 1:08:04 lr 0.000001	time 4.4949 (2.9555)	model_time 0.6333 (0.6338)	loss 0.2369 (0.2345)	grad_norm 0.5214 (0.8925/0.2456)	mem 34631MB
[2025-11-19 21:32:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1550/2882]	eta 1:05:27 lr 0.000001	time 0.6326 (2.9489)	model_time 0.6323 (0.6339)	loss 0.2449 (0.2345)	grad_norm 1.2371 (0.8890/0.2347)	mem 34631MB
[2025-11-19 21:34:17 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1600/2882]	eta 1:02:51 lr 0.000001	time 0.6356 (2.9419)	model_time 0.6353 (0.6339)	loss 0.2452 (0.2345)	grad_norm 1.1397 (0.8948/0.2474)	mem 34631MB
[2025-11-19 21:36:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1650/2882]	eta 1:00:33 lr 0.000001	time 12.1238 (2.9496)	model_time 0.6319 (0.6340)	loss 0.2292 (0.2344)	grad_norm 0.6553 (0.8967/0.2487)	mem 34631MB
[2025-11-19 21:39:22 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1700/2882]	eta 0:58:05 lr 0.000001	time 0.6651 (2.9485)	model_time 0.6649 (0.6340)	loss 0.2371 (0.2345)	grad_norm 0.6939 (0.9016/0.2569)	mem 34631MB
[2025-11-19 21:41:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1750/2882]	eta 0:55:37 lr 0.000001	time 0.6303 (2.9487)	model_time 0.6300 (0.6340)	loss 0.2086 (0.2344)	grad_norm 0.9509 (0.9055/0.2495)	mem 34631MB
[2025-11-19 21:44:23 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1800/2882]	eta 0:53:13 lr 0.000001	time 5.9218 (2.9517)	model_time 0.6334 (0.6339)	loss 0.2095 (0.2343)	grad_norm 0.6187 (0.9184/0.2507)	mem 34631MB
[2025-11-19 21:46:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1850/2882]	eta 0:50:45 lr 0.000001	time 0.6359 (2.9507)	model_time 0.6355 (0.6340)	loss 0.2505 (0.2343)	grad_norm 0.9334 (0.9215/0.2504)	mem 34631MB
[2025-11-19 21:49:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1900/2882]	eta 0:48:15 lr 0.000001	time 0.6314 (2.9489)	model_time 0.6312 (0.6340)	loss 0.2310 (0.2343)	grad_norm 0.9631 (0.9259/0.2480)	mem 34631MB
[2025-11-19 21:52:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][1950/2882]	eta 0:46:02 lr 0.000001	time 8.7374 (2.9640)	model_time 0.6331 (0.6339)	loss 0.2326 (0.2342)	grad_norm 0.6882 (0.9245/0.2437)	mem 34631MB
[2025-11-19 21:54:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2000/2882]	eta 0:43:26 lr 0.000001	time 0.6275 (2.9548)	model_time 0.6273 (0.6339)	loss 0.2500 (0.2343)	grad_norm 1.0418 (0.9310/0.2398)	mem 34631MB
[2025-11-19 21:56:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2050/2882]	eta 0:40:56 lr 0.000001	time 0.6333 (2.9520)	model_time 0.6329 (0.6338)	loss 0.2355 (0.2343)	grad_norm 0.8971 (0.9481/0.2497)	mem 34631MB
[2025-11-19 21:59:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2100/2882]	eta 0:38:27 lr 0.000001	time 0.6341 (2.9501)	model_time 0.6338 (0.6339)	loss 0.2242 (0.2342)	grad_norm 0.6025 (0.9350/0.2535)	mem 34631MB
[2025-11-19 22:01:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2150/2882]	eta 0:35:57 lr 0.000001	time 0.6360 (2.9475)	model_time 0.6357 (0.6338)	loss 0.2179 (0.2342)	grad_norm 0.9461 (0.9370/0.2621)	mem 34631MB
[2025-11-19 22:03:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2200/2882]	eta 0:33:26 lr 0.000001	time 0.7525 (2.9418)	model_time 0.7522 (0.6339)	loss 0.2185 (0.2341)	grad_norm 1.0516 (0.9266/0.2608)	mem 34631MB
[2025-11-19 22:06:25 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2250/2882]	eta 0:31:03 lr 0.000001	time 0.6313 (2.9489)	model_time 0.6311 (0.6339)	loss 0.2509 (0.2342)	grad_norm 1.0798 (0.9366/0.2679)	mem 34631MB
[2025-11-19 22:08:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2300/2882]	eta 0:28:34 lr 0.000001	time 0.6320 (2.9455)	model_time 0.6318 (0.6338)	loss 0.2600 (0.2342)	grad_norm 0.9418 (0.9307/0.2680)	mem 34631MB
[2025-11-19 22:11:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2350/2882]	eta 0:26:06 lr 0.000001	time 0.6316 (2.9445)	model_time 0.6313 (0.6338)	loss 0.2223 (0.2342)	grad_norm 0.9716 (0.9137/0.2663)	mem 34631MB
[2025-11-19 22:13:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2400/2882]	eta 0:23:38 lr 0.000001	time 0.6307 (2.9438)	model_time 0.6304 (0.6338)	loss 0.2177 (0.2342)	grad_norm 1.0093 (0.9147/0.2598)	mem 34631MB
[2025-11-19 22:16:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2450/2882]	eta 0:21:12 lr 0.000001	time 0.6313 (2.9452)	model_time 0.6311 (0.6337)	loss 0.2528 (0.2343)	grad_norm 0.6458 (0.9027/0.2499)	mem 34631MB
[2025-11-19 22:18:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2500/2882]	eta 0:18:44 lr 0.000001	time 0.6363 (2.9444)	model_time 0.6360 (0.6337)	loss 0.2511 (0.2342)	grad_norm 0.7200 (0.9091/0.2498)	mem 34631MB
[2025-11-19 22:21:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2550/2882]	eta 0:16:20 lr 0.000001	time 24.1760 (2.9544)	model_time 0.6303 (0.6336)	loss 0.2214 (0.2343)	grad_norm 0.3601 (0.8972/0.2454)	mem 34631MB
[2025-11-19 22:23:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2600/2882]	eta 0:13:52 lr 0.000001	time 0.6313 (2.9514)	model_time 0.6310 (0.6336)	loss 0.2113 (0.2343)	grad_norm 0.4848 (0.8857/0.2421)	mem 34631MB
[2025-11-19 22:26:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2650/2882]	eta 0:11:24 lr 0.000001	time 0.6297 (2.9491)	model_time 0.6294 (0.6336)	loss 0.2629 (0.2342)	grad_norm 0.8910 (0.8920/0.2371)	mem 34631MB
[2025-11-19 22:28:23 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2700/2882]	eta 0:08:56 lr 0.000001	time 0.6295 (2.9458)	model_time 0.6293 (0.6336)	loss 0.2303 (0.2343)	grad_norm 0.7126 (0.9056/0.2427)	mem 34631MB
[2025-11-19 22:30:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2750/2882]	eta 0:06:28 lr 0.000001	time 0.6313 (2.9429)	model_time 0.6311 (0.6336)	loss 0.2469 (0.2342)	grad_norm 0.8282 (0.9090/0.2460)	mem 34631MB
[2025-11-19 22:33:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2800/2882]	eta 0:04:01 lr 0.000001	time 0.6271 (2.9412)	model_time 0.6269 (0.6335)	loss 0.2348 (0.2342)	grad_norm 0.8786 (0.9144/0.2448)	mem 34631MB
[2025-11-19 22:36:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [9/20][2850/2882]	eta 0:01:34 lr 0.000001	time 28.5912 (2.9510)	model_time 0.6295 (0.6335)	loss 0.2594 (0.2341)	grad_norm 1.1671 (0.9009/0.2372)	mem 34631MB
[2025-11-19 22:37:14 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 9 training takes 2:21:27
[2025-11-19 22:37:14 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_9.pth saving......
[2025-11-19 22:37:16 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_9.pth saved !!!
[2025-11-19 22:37:52 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 35.511 (35.511)	Loss 0.2741 (0.2741)	Mem 34631MB
[2025-11-19 22:38:35 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:9] * Mean AUC-ROC 0.8058 Loss 0.2311
[2025-11-19 22:38:35 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:9] * Per-class AUC-ROC: ['0.8373', '0.8273', '0.8171', '0.9035', '0.7339', '0.5899', '0.7196', '0.7426', '0.8634', '0.9230', '0.7617', '0.7526', '0.8861', '0.9225']
[2025-11-19 22:38:35 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.8058
[2025-11-19 22:38:35 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.8058
[2025-11-19 22:38:43 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 8.554 (8.554)	Loss 0.2763 (0.2763)	Mem 34631MB
[2025-11-19 22:38:56 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:9] * Mean AUC-ROC 0.7986 Loss 0.2389
[2025-11-19 22:38:56 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:9] * Per-class AUC-ROC: ['0.8324', '0.8224', '0.8119', '0.9018', '0.7307', '0.5996', '0.7061', '0.7372', '0.8577', '0.9190', '0.7408', '0.7468', '0.8560', '0.9172']
[2025-11-19 22:38:56 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.7986
[2025-11-19 22:38:56 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-19 22:38:58 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-19 22:38:58 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.7986
[2025-11-19 22:39:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][0/2882]	eta 1 day, 5:33:39 lr 0.000001	time 36.9257 (36.9257)	model_time 0.6295 (0.6295)	loss 0.2416 (0.2416)	grad_norm 1.5293 (1.5293/0.0000)	mem 34631MB
[2025-11-19 22:41:47 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][50/2882]	eta 2:36:14 lr 0.000001	time 0.6232 (3.3103)	model_time 0.6230 (0.6318)	loss 0.2549 (0.2349)	grad_norm 1.4852 (0.9501/0.3145)	mem 34631MB
[2025-11-19 22:44:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][100/2882]	eta 2:22:06 lr 0.000001	time 1.3173 (3.0649)	model_time 0.6287 (0.6302)	loss 0.2718 (0.2322)	grad_norm 1.2083 (0.9246/0.2845)	mem 34631MB
[2025-11-19 22:46:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][150/2882]	eta 2:13:44 lr 0.000001	time 0.9401 (2.9371)	model_time 0.6309 (0.6315)	loss 0.2455 (0.2334)	grad_norm 0.8127 (0.9068/0.2811)	mem 34631MB
[2025-11-19 22:48:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][200/2882]	eta 2:06:43 lr 0.000001	time 0.6305 (2.8351)	model_time 0.6302 (0.6313)	loss 0.2341 (0.2330)	grad_norm 0.6556 (0.9046/0.2804)	mem 34631MB
[2025-11-19 22:50:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][250/2882]	eta 2:02:29 lr 0.000001	time 0.6332 (2.7924)	model_time 0.6329 (0.6311)	loss 0.2081 (0.2334)	grad_norm 0.9374 (0.8946/0.2693)	mem 34631MB
[2025-11-19 22:53:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][300/2882]	eta 2:01:08 lr 0.000001	time 16.8392 (2.8149)	model_time 0.6367 (0.6316)	loss 0.2333 (0.2334)	grad_norm 0.8817 (0.8836/0.2578)	mem 34631MB
[2025-11-19 22:55:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][350/2882]	eta 1:57:34 lr 0.000001	time 0.6290 (2.7860)	model_time 0.6288 (0.6314)	loss 0.2299 (0.2334)	grad_norm 0.7079 (0.8789/0.2463)	mem 34631MB
[2025-11-19 22:57:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][400/2882]	eta 1:55:29 lr 0.000001	time 0.6313 (2.7917)	model_time 0.6311 (0.6316)	loss 0.2153 (0.2335)	grad_norm 1.0558 (0.8826/0.2452)	mem 34631MB
[2025-11-19 22:59:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][450/2882]	eta 1:51:55 lr 0.000001	time 2.4373 (2.7611)	model_time 0.6283 (0.6314)	loss 0.2361 (0.2336)	grad_norm 0.8987 (0.8902/0.2475)	mem 34631MB
[2025-11-19 23:02:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][500/2882]	eta 1:49:44 lr 0.000001	time 0.6299 (2.7642)	model_time 0.6296 (0.6314)	loss 0.2250 (0.2338)	grad_norm 0.6015 (0.8899/0.2417)	mem 34631MB
[2025-11-19 23:04:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][550/2882]	eta 1:47:00 lr 0.000001	time 0.6317 (2.7532)	model_time 0.6316 (0.6314)	loss 0.2274 (0.2338)	grad_norm 1.0780 (0.9005/0.2518)	mem 34631MB
[2025-11-19 23:06:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][600/2882]	eta 1:44:33 lr 0.000001	time 6.2821 (2.7491)	model_time 0.6296 (0.6314)	loss 0.2531 (0.2335)	grad_norm 1.0406 (0.9043/0.2498)	mem 34631MB
[2025-11-19 23:08:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][650/2882]	eta 1:42:10 lr 0.000001	time 0.6368 (2.7467)	model_time 0.6365 (0.6314)	loss 0.2424 (0.2336)	grad_norm 0.8963 (0.9186/0.2522)	mem 34631MB
[2025-11-19 23:11:12 internimage_b_mimic_cxr_224] (main.py 729): INFO Full config saved to output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/config.json
[2025-11-19 23:11:12 internimage_b_mimic_cxr_224] (main.py 732): INFO AMP_OPT_LEVEL: O1
AMP_TYPE: float16
AUG:
  AUTO_AUGMENT: none
  COLOR_JITTER: 0.0
  CUTMIX: 0.0
  CUTMIX_MINMAX: null
  MEAN:
  - 0.485
  - 0.456
  - 0.406
  MIXUP: 0.0
  MIXUP_MODE: batch
  MIXUP_PROB: 0.0
  MIXUP_SWITCH_PROB: 0.0
  RANDOM_RESIZED_CROP: false
  RECOUNT: 1
  REMODE: pixel
  REPROB: 0.1
  STD:
  - 0.229
  - 0.224
  - 0.225
BASE:
- ''
DATA:
  BATCH_SIZE: 128
  CACHE_MODE: part
  DATASET: mimic_cxr
  DATA_PATH: /scratch/smehta90/mimic_splits
  IMG_ON_MEMORY: false
  IMG_SIZE: 224
  INTERPOLATION: bicubic
  NUM_WORKERS: 12
  PIN_MEMORY: true
  ZIP_MODE: false
EVAL_22K_TO_1K: false
EVAL_FREQ: 1
EVAL_MODE: false
LOCAL_RANK: 0
MODEL:
  DROP_PATH_RATE: 0.5
  DROP_PATH_TYPE: linear
  DROP_RATE: 0.0
  INTERN_IMAGE:
    CENTER_FEATURE_SCALE: false
    CHANNELS: 112
    CORE_OP: DCNv3
    DEPTHS:
    - 4
    - 4
    - 21
    - 4
    DW_KERNEL_SIZE: null
    GROUPS:
    - 7
    - 14
    - 28
    - 56
    LAYER_SCALE: 1.0e-05
    LEVEL2_POST_NORM: false
    LEVEL2_POST_NORM_BLOCK_IDS: null
    MLP_RATIO: 4.0
    OFFSET_SCALE: 1.0
    POST_NORM: true
    REMOVE_CENTER: false
    RES_POST_NORM: false
    USE_CLIP_PROJECTOR: false
  LABEL_SMOOTHING: 0.0
  NAME: internimage_b_mimic_cxr_224
  NUM_CLASSES: 14
  PRETRAINED: pretrained/internimage_b_1k_224.pth
  RESUME: ''
  TYPE: intern_image
OUTPUT: output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224
PRINT_FREQ: 50
SAVE_CKPT_NUM: 1
SAVE_FREQ: 1
SEED: 42
TAG: run1
TEST:
  CROP: true
  SEQUENTIAL: false
THROUGHPUT_MODE: false
TRAIN:
  ACCUMULATION_STEPS: 1
  AUTO_RESUME: true
  BASE_LR: 0.0001
  CLIP_GRAD: 5.0
  EMA:
    DECAY: 0.9999
    ENABLE: true
  EPOCHS: 20
  LR_LAYER_DECAY: true
  LR_LAYER_DECAY_RATIO: 0.875
  LR_SCHEDULER:
    DECAY_EPOCHS: 30
    DECAY_RATE: 0.1
    NAME: cosine
  MIN_LR: 1.0e-06
  OPTIMIZER:
    BETAS:
    - 0.9
    - 0.999
    DCN_LR_MUL: null
    EPS: 1.0e-08
    FREEZE_BACKBONE: null
    MOMENTUM: 0.9
    NAME: adamw
    USE_ZERO: false
  RAND_INIT_FT_HEAD: true
  START_EPOCH: 0
  USE_CHECKPOINT: false
  WARMUP_EPOCHS: 2
  WARMUP_LR: 5.0e-07
  WEIGHT_DECAY: 0.05

[2025-11-19 23:11:14 internimage_b_mimic_cxr_224] (main.py 175): INFO Creating model:intern_image/internimage_b_mimic_cxr_224
[2025-11-19 23:11:16 internimage_b_mimic_cxr_224] (main.py 178): INFO InternImage(
  (patch_embed): StemLayer(
    (conv1): Conv2d(3, 56, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm1): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((56,), eps=1e-06, elementwise_affine=True)
      (2): to_channels_first()
    )
    (act): GELU(approximate='none')
    (conv2): Conv2d(56, 112, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm2): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
    )
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (levels): ModuleList(
    (0): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): Identity()
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.016)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.031)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.047)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (1): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.062)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.078)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.094)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.109)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (2): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.125)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.141)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.156)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.172)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (4): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.188)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (5): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.203)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (6): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.219)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (7): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.234)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (8): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.250)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (9): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.266)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (10): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.281)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (11): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.297)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (12): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.312)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (13): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.328)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (14): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.344)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (15): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.359)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (16): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.375)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (17): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.391)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (18): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.406)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (19): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.422)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (20): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.438)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(448, 896, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (3): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.453)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.469)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.484)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.500)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (conv_head): Sequential(
    (0): Conv2d(896, 1344, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (1): Sequential(
      (0): BatchNorm2d(1344, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): GELU(approximate='none')
  )
  (head): Linear(in_features=1344, out_features=14, bias=True)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
[2025-11-19 23:11:16 internimage_b_mimic_cxr_224] (main.py 214): INFO Using native Torch AMP. Training in mixed precision.
[2025-11-19 23:11:16 internimage_b_mimic_cxr_224] (main.py 226): INFO using fp16_compress_hook!
[2025-11-19 23:11:16 internimage_b_mimic_cxr_224] (main.py 234): INFO number of params: 96135662
[2025-11-19 23:11:16 internimage_b_mimic_cxr_224] (main.py 247): INFO Using BCEWithLogitsLoss for multi-label classification
[2025-11-19 23:11:16 internimage_b_mimic_cxr_224] (main.py 270): INFO auto resuming from output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_9.pth
[2025-11-19 23:11:16 internimage_b_mimic_cxr_224] (utils.py 60): INFO ==============> Resuming form output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_9.pth....................
[2025-11-19 23:11:19 internimage_b_mimic_cxr_224] (utils.py 92): INFO <All keys matched successfully>
[2025-11-19 23:11:19 internimage_b_mimic_cxr_224] (utils.py 110): INFO => loaded successfully output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_9.pth (epoch 9)
[2025-11-19 23:11:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][700/2882]	eta 1:41:14 lr 0.000001	time 5.9828 (2.7839)	model_time 0.6344 (0.6316)	loss 0.2144 (0.2336)	grad_norm 1.1337 (0.9164/0.2496)	mem 34631MB
[2025-11-19 23:13:47 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][750/2882]	eta 1:38:51 lr 0.000001	time 0.6311 (2.7823)	model_time 0.6309 (0.6316)	loss 0.2562 (0.2336)	grad_norm 0.5445 (0.9085/0.2453)	mem 34631MB
[2025-11-19 23:16:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][800/2882]	eta 1:36:29 lr 0.000001	time 0.6346 (2.7806)	model_time 0.6343 (0.6317)	loss 0.2443 (0.2336)	grad_norm 0.5861 (0.9168/0.2502)	mem 34631MB
[2025-11-19 23:18:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][850/2882]	eta 1:34:13 lr 0.000001	time 0.6302 (2.7823)	model_time 0.6300 (0.6317)	loss 0.2424 (0.2337)	grad_norm 0.7542 (0.9201/0.2493)	mem 34631MB
[2025-11-19 23:20:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][900/2882]	eta 1:32:17 lr 0.000001	time 10.3690 (2.7938)	model_time 0.6307 (0.6316)	loss 0.2390 (0.2335)	grad_norm 0.7602 (0.9251/0.2555)	mem 34631MB
[2025-11-19 23:23:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][950/2882]	eta 1:29:59 lr 0.000001	time 0.6292 (2.7948)	model_time 0.6290 (0.6316)	loss 0.2375 (0.2334)	grad_norm 1.0564 (0.9156/0.2668)	mem 34631MB
[2025-11-19 23:26:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1000/2882]	eta 1:28:33 lr 0.000001	time 9.5593 (2.8232)	model_time 0.6361 (0.6318)	loss 0.2340 (0.2335)	grad_norm 0.6695 (0.9310/0.2712)	mem 34631MB
[2025-11-19 23:28:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1050/2882]	eta 1:26:18 lr 0.000001	time 0.8387 (2.8265)	model_time 0.6324 (0.6318)	loss 0.2631 (0.2334)	grad_norm 1.4390 (0.9364/0.2770)	mem 34631MB
[2025-11-19 23:30:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1100/2882]	eta 1:24:10 lr 0.000001	time 0.6289 (2.8342)	model_time 0.6286 (0.6319)	loss 0.2372 (0.2334)	grad_norm 0.9516 (0.9310/0.2820)	mem 34631MB
[2025-11-19 23:33:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1150/2882]	eta 1:22:01 lr 0.000001	time 0.6351 (2.8413)	model_time 0.6348 (0.6321)	loss 0.2404 (0.2334)	grad_norm 0.7532 (0.9266/0.2795)	mem 34631MB
[2025-11-19 23:35:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1200/2882]	eta 1:19:43 lr 0.000001	time 0.6362 (2.8441)	model_time 0.6359 (0.6321)	loss 0.2541 (0.2335)	grad_norm 0.8767 (0.9255/0.2809)	mem 34631MB
[2025-11-19 23:38:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1250/2882]	eta 1:17:15 lr 0.000001	time 0.6328 (2.8402)	model_time 0.6324 (0.6321)	loss 0.2635 (0.2335)	grad_norm 0.8340 (0.9266/0.2724)	mem 34631MB
[2025-11-19 23:40:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1300/2882]	eta 1:15:03 lr 0.000001	time 8.4465 (2.8468)	model_time 0.6332 (0.6322)	loss 0.2639 (0.2337)	grad_norm 0.6872 (0.9195/0.2761)	mem 34631MB
[2025-11-19 23:42:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1350/2882]	eta 1:12:35 lr 0.000001	time 6.0595 (2.8428)	model_time 0.6333 (0.6321)	loss 0.2095 (0.2336)	grad_norm 0.9818 (0.9239/0.2631)	mem 34631MB
[2025-11-19 23:45:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1400/2882]	eta 1:09:55 lr 0.000001	time 0.6358 (2.8311)	model_time 0.6356 (0.6323)	loss 0.2375 (0.2336)	grad_norm 1.4818 (0.9295/0.2517)	mem 34631MB
[2025-11-19 23:47:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1450/2882]	eta 1:07:17 lr 0.000001	time 0.6316 (2.8195)	model_time 0.6314 (0.6323)	loss 0.2141 (0.2334)	grad_norm 0.9709 (0.9306/0.2551)	mem 34631MB
[2025-11-19 23:49:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1500/2882]	eta 1:04:42 lr 0.000001	time 0.6370 (2.8091)	model_time 0.6368 (0.6324)	loss 0.2671 (0.2335)	grad_norm 0.9644 (0.9337/0.2516)	mem 34631MB
[2025-11-19 23:51:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1550/2882]	eta 1:02:09 lr 0.000001	time 0.6321 (2.7997)	model_time 0.6319 (0.6324)	loss 0.1979 (0.2334)	grad_norm 1.2668 (0.9387/0.2498)	mem 34631MB
[2025-11-19 23:53:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1600/2882]	eta 0:59:55 lr 0.000001	time 0.6324 (2.8047)	model_time 0.6320 (0.6325)	loss 0.2363 (0.2332)	grad_norm 0.6188 (0.9346/0.2470)	mem 34631MB
[2025-11-19 23:56:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1650/2882]	eta 0:57:40 lr 0.000001	time 12.4907 (2.8088)	model_time 0.6361 (0.6326)	loss 0.2377 (0.2333)	grad_norm 1.0141 (0.9297/0.2533)	mem 34631MB
[2025-11-19 23:58:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1700/2882]	eta 0:55:14 lr 0.000001	time 0.6347 (2.8040)	model_time 0.6345 (0.6326)	loss 0.2401 (0.2333)	grad_norm 0.5954 (0.9185/0.2522)	mem 34631MB
[2025-11-20 00:00:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1750/2882]	eta 0:52:43 lr 0.000001	time 0.6286 (2.7947)	model_time 0.6284 (0.6325)	loss 0.2211 (0.2332)	grad_norm 1.0133 (0.9153/0.2428)	mem 34631MB
[2025-11-20 00:02:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1800/2882]	eta 0:50:14 lr 0.000001	time 0.6291 (2.7865)	model_time 0.6288 (0.6324)	loss 0.2293 (0.2332)	grad_norm 1.2444 (0.9040/0.2418)	mem 34631MB
[2025-11-20 00:04:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1850/2882]	eta 0:47:51 lr 0.000001	time 0.6332 (2.7823)	model_time 0.6329 (0.6324)	loss 0.2666 (0.2332)	grad_norm 1.4173 (0.8932/0.2346)	mem 34631MB
[2025-11-20 00:07:08 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1900/2882]	eta 0:45:32 lr 0.000001	time 0.6308 (2.7826)	model_time 0.6304 (0.6323)	loss 0.2387 (0.2332)	grad_norm 1.0304 (0.8876/0.2342)	mem 34631MB
[2025-11-20 00:09:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][1950/2882]	eta 0:43:09 lr 0.000001	time 9.8242 (2.7784)	model_time 0.6263 (0.6323)	loss 0.2312 (0.2331)	grad_norm 0.7848 (0.8887/0.2394)	mem 34631MB
[2025-11-20 00:11:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2000/2882]	eta 0:40:42 lr 0.000001	time 0.6290 (2.7696)	model_time 0.6288 (0.6323)	loss 0.2403 (0.2332)	grad_norm 1.3935 (0.9044/0.2541)	mem 34631MB
[2025-11-20 00:13:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2050/2882]	eta 0:38:17 lr 0.000001	time 0.6296 (2.7609)	model_time 0.6294 (0.6323)	loss 0.2129 (0.2332)	grad_norm 0.7465 (0.9190/0.2647)	mem 34631MB
[2025-11-20 00:15:22 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2100/2882]	eta 0:35:52 lr 0.000001	time 0.6281 (2.7531)	model_time 0.6280 (0.6322)	loss 0.2341 (0.2333)	grad_norm 1.0005 (0.9342/0.2811)	mem 34631MB
[2025-11-20 00:17:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2150/2882]	eta 0:33:29 lr 0.000001	time 0.6347 (2.7446)	model_time 0.6343 (0.6323)	loss 0.2015 (0.2334)	grad_norm 1.1065 (0.9378/0.2777)	mem 34631MB
[2025-11-20 00:19:47 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2200/2882]	eta 0:31:14 lr 0.000001	time 0.6304 (2.7482)	model_time 0.6300 (0.6323)	loss 0.2411 (0.2333)	grad_norm 0.9440 (0.9382/0.2723)	mem 34631MB
[2025-11-20 00:21:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2250/2882]	eta 0:28:53 lr 0.000001	time 0.6328 (2.7423)	model_time 0.6326 (0.6324)	loss 0.2354 (0.2332)	grad_norm 0.8172 (0.9344/0.2697)	mem 34631MB
[2025-11-20 00:24:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2300/2882]	eta 0:26:35 lr 0.000001	time 0.6355 (2.7409)	model_time 0.6352 (0.6324)	loss 0.2566 (0.2333)	grad_norm 1.1747 (0.9220/0.2629)	mem 34631MB
[2025-11-20 00:26:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2350/2882]	eta 0:24:17 lr 0.000001	time 0.6337 (2.7401)	model_time 0.6334 (0.6324)	loss 0.2554 (0.2333)	grad_norm 1.0079 (0.9148/0.2617)	mem 34631MB
[2025-11-20 00:28:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2400/2882]	eta 0:22:00 lr 0.000001	time 0.6312 (2.7399)	model_time 0.6308 (0.6325)	loss 0.2624 (0.2333)	grad_norm 0.9171 (0.9104/0.2430)	mem 34631MB
[2025-11-20 00:30:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2450/2882]	eta 0:19:43 lr 0.000001	time 0.6338 (2.7388)	model_time 0.6336 (0.6325)	loss 0.2369 (0.2333)	grad_norm 0.9178 (0.9103/0.2530)	mem 34631MB
[2025-11-20 00:33:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2500/2882]	eta 0:17:29 lr 0.000001	time 0.6279 (2.7463)	model_time 0.6277 (0.6324)	loss 0.2369 (0.2332)	grad_norm 0.9039 (0.9159/0.2551)	mem 34631MB
[2025-11-20 00:35:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2550/2882]	eta 0:15:11 lr 0.000001	time 0.6346 (2.7456)	model_time 0.6344 (0.6324)	loss 0.2254 (0.2333)	grad_norm 1.2332 (0.9219/0.2517)	mem 34631MB
[2025-11-20 00:37:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2600/2882]	eta 0:12:53 lr 0.000001	time 0.6332 (2.7422)	model_time 0.6330 (0.6324)	loss 0.2211 (0.2332)	grad_norm 1.0890 (0.9176/0.2451)	mem 34631MB
[2025-11-20 00:40:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2650/2882]	eta 0:10:36 lr 0.000001	time 0.6269 (2.7419)	model_time 0.6267 (0.6324)	loss 0.2478 (0.2332)	grad_norm 1.4823 (0.9151/0.2385)	mem 34631MB
[2025-11-20 00:42:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2700/2882]	eta 0:08:19 lr 0.000001	time 0.6343 (2.7429)	model_time 0.6340 (0.6324)	loss 0.2377 (0.2332)	grad_norm 1.0428 (0.9234/0.2425)	mem 34631MB
[2025-11-20 00:44:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2750/2882]	eta 0:06:02 lr 0.000001	time 0.6368 (2.7451)	model_time 0.6365 (0.6324)	loss 0.2447 (0.2332)	grad_norm 0.7464 (0.9317/0.2471)	mem 34631MB
[2025-11-20 00:47:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2800/2882]	eta 0:03:45 lr 0.000001	time 0.6326 (2.7524)	model_time 0.6323 (0.6324)	loss 0.2409 (0.2332)	grad_norm 0.9594 (0.9425/0.2535)	mem 34631MB
[2025-11-20 00:49:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [10/20][2850/2882]	eta 0:01:28 lr 0.000001	time 6.3880 (2.7539)	model_time 0.6366 (0.6325)	loss 0.2449 (0.2332)	grad_norm 0.9564 (0.9397/0.2478)	mem 34631MB
[2025-11-20 00:51:06 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 10 training takes 2:12:08
[2025-11-20 00:51:06 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_10.pth saving......
[2025-11-20 00:51:09 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_10.pth saved !!!
[2025-11-20 00:51:43 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 33.772 (33.772)	Loss 0.2730 (0.2730)	Mem 34631MB
[2025-11-20 00:52:26 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:10] * Mean AUC-ROC 0.8074 Loss 0.2305
[2025-11-20 00:52:26 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:10] * Per-class AUC-ROC: ['0.8381', '0.8278', '0.8179', '0.9035', '0.7365', '0.5942', '0.7262', '0.7458', '0.8640', '0.9237', '0.7579', '0.7548', '0.8898', '0.9243']
[2025-11-20 00:52:26 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.8074
[2025-11-20 00:52:26 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-20 00:52:29 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-20 00:52:29 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.8074
[2025-11-20 00:52:37 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 8.616 (8.616)	Loss 0.2749 (0.2749)	Mem 34631MB
[2025-11-20 00:52:50 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:10] * Mean AUC-ROC 0.8011 Loss 0.2364
[2025-11-20 00:52:50 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:10] * Per-class AUC-ROC: ['0.8343', '0.8245', '0.8138', '0.9025', '0.7327', '0.5981', '0.7115', '0.7395', '0.8594', '0.9206', '0.7448', '0.7508', '0.8633', '0.9188']
[2025-11-20 00:52:50 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.8011
[2025-11-20 00:52:50 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-20 00:52:52 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-20 00:52:52 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.8011
[2025-11-20 00:53:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][0/2882]	eta 1 day, 3:42:11 lr 0.000001	time 34.6051 (34.6051)	model_time 0.6292 (0.6292)	loss 0.2284 (0.2284)	grad_norm 0.8628 (0.8628/0.0000)	mem 34631MB
[2025-11-20 00:55:23 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][50/2882]	eta 2:19:40 lr 0.000001	time 0.6336 (2.9591)	model_time 0.6333 (0.6313)	loss 0.2387 (0.2367)	grad_norm 0.8548 (0.8729/0.2781)	mem 34631MB
[2025-11-20 00:57:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][100/2882]	eta 2:06:05 lr 0.000001	time 0.6345 (2.7196)	model_time 0.6342 (0.6317)	loss 0.2538 (0.2338)	grad_norm 1.0504 (0.8965/0.2684)	mem 34631MB
[2025-11-20 00:59:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][150/2882]	eta 1:57:22 lr 0.000001	time 0.6282 (2.5777)	model_time 0.6279 (0.6320)	loss 0.2033 (0.2335)	grad_norm 1.1560 (0.9102/0.2630)	mem 34631MB
[2025-11-20 01:01:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][200/2882]	eta 1:52:27 lr 0.000001	time 0.6347 (2.5158)	model_time 0.6344 (0.6326)	loss 0.2371 (0.2335)	grad_norm 0.5464 (0.9057/0.2697)	mem 34631MB
[2025-11-20 01:03:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][250/2882]	eta 1:49:01 lr 0.000001	time 0.6324 (2.4855)	model_time 0.6321 (0.6326)	loss 0.2118 (0.2331)	grad_norm 0.6162 (0.9074/0.2766)	mem 34631MB
[2025-11-20 01:05:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][300/2882]	eta 1:46:41 lr 0.000001	time 10.7286 (2.4794)	model_time 0.6279 (0.6326)	loss 0.2557 (0.2330)	grad_norm 1.4185 (0.9128/0.2718)	mem 34631MB
[2025-11-20 01:07:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][350/2882]	eta 1:43:40 lr 0.000001	time 0.6355 (2.4569)	model_time 0.6352 (0.6330)	loss 0.2055 (0.2327)	grad_norm 0.9247 (0.9160/0.2685)	mem 34631MB
[2025-11-20 01:09:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][400/2882]	eta 1:41:25 lr 0.000001	time 0.6330 (2.4519)	model_time 0.6327 (0.6331)	loss 0.1922 (0.2329)	grad_norm 0.8459 (0.9298/0.2763)	mem 34631MB
[2025-11-20 01:11:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][450/2882]	eta 1:39:03 lr 0.000001	time 0.6340 (2.4439)	model_time 0.6336 (0.6330)	loss 0.2049 (0.2328)	grad_norm 1.2996 (0.9314/0.2760)	mem 34631MB
[2025-11-20 01:13:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][500/2882]	eta 1:36:47 lr 0.000001	time 0.6378 (2.4379)	model_time 0.6375 (0.6332)	loss 0.2121 (0.2329)	grad_norm 0.9340 (0.9430/0.2677)	mem 34631MB
[2025-11-20 01:15:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][550/2882]	eta 1:34:26 lr 0.000001	time 0.6356 (2.4299)	model_time 0.6353 (0.6332)	loss 0.2502 (0.2330)	grad_norm 0.9164 (0.9565/0.2647)	mem 34631MB
[2025-11-20 01:17:25 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][600/2882]	eta 1:33:14 lr 0.000001	time 5.9513 (2.4514)	model_time 0.6316 (0.6333)	loss 0.2544 (0.2331)	grad_norm 0.7999 (0.9593/0.2768)	mem 34631MB
[2025-11-20 01:19:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][650/2882]	eta 1:31:04 lr 0.000001	time 4.4814 (2.4481)	model_time 0.6330 (0.6332)	loss 0.2437 (0.2332)	grad_norm 0.8392 (0.9687/0.2775)	mem 34631MB
[2025-11-20 01:21:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][700/2882]	eta 1:29:24 lr 0.000001	time 0.6320 (2.4585)	model_time 0.6317 (0.6331)	loss 0.2221 (0.2333)	grad_norm 1.0877 (0.9575/0.2633)	mem 34631MB
[2025-11-20 01:23:33 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][750/2882]	eta 1:27:06 lr 0.000001	time 0.6315 (2.4513)	model_time 0.6311 (0.6330)	loss 0.2227 (0.2333)	grad_norm 0.3501 (0.9554/0.2641)	mem 34631MB
[2025-11-20 01:25:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][800/2882]	eta 1:24:40 lr 0.000001	time 0.6332 (2.4401)	model_time 0.6330 (0.6329)	loss 0.2231 (0.2332)	grad_norm 0.6799 (0.9480/0.2641)	mem 34631MB
[2025-11-20 01:27:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][850/2882]	eta 1:22:39 lr 0.000001	time 0.6261 (2.4409)	model_time 0.6259 (0.6329)	loss 0.2565 (0.2332)	grad_norm 0.5673 (0.9462/0.2530)	mem 34631MB
[2025-11-20 01:29:33 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][900/2882]	eta 1:20:42 lr 0.000001	time 8.5915 (2.4432)	model_time 0.6310 (0.6330)	loss 0.2512 (0.2333)	grad_norm 0.7682 (0.9444/0.2393)	mem 34631MB
[2025-11-20 01:31:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][950/2882]	eta 1:18:45 lr 0.000001	time 0.6347 (2.4461)	model_time 0.6344 (0.6328)	loss 0.2487 (0.2332)	grad_norm 0.8844 (0.9367/0.2382)	mem 34631MB
[2025-11-20 01:34:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1000/2882]	eta 1:17:28 lr 0.000001	time 0.6303 (2.4698)	model_time 0.6301 (0.6330)	loss 0.2407 (0.2332)	grad_norm 0.7745 (0.9311/0.2468)	mem 34631MB
[2025-11-20 01:36:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1050/2882]	eta 1:15:21 lr 0.000001	time 0.6315 (2.4679)	model_time 0.6312 (0.6329)	loss 0.2262 (0.2330)	grad_norm 1.2635 (0.9338/0.2428)	mem 34631MB
[2025-11-20 01:38:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1100/2882]	eta 1:13:09 lr 0.000001	time 0.6338 (2.4633)	model_time 0.6335 (0.6329)	loss 0.2572 (0.2329)	grad_norm 1.3284 (0.9259/0.2445)	mem 34631MB
[2025-11-20 01:40:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1150/2882]	eta 1:11:05 lr 0.000001	time 0.6461 (2.4629)	model_time 0.6459 (0.6329)	loss 0.2214 (0.2329)	grad_norm 0.5596 (0.9208/0.2460)	mem 34631MB
[2025-11-20 01:42:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1200/2882]	eta 1:08:51 lr 0.000001	time 0.6352 (2.4561)	model_time 0.6349 (0.6331)	loss 0.2405 (0.2330)	grad_norm 0.9682 (0.9103/0.2487)	mem 34631MB
[2025-11-20 01:43:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1250/2882]	eta 1:06:37 lr 0.000001	time 0.6355 (2.4494)	model_time 0.6352 (0.6331)	loss 0.2127 (0.2330)	grad_norm 1.5427 (0.9121/0.2434)	mem 34631MB
[2025-11-20 01:46:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1300/2882]	eta 1:04:50 lr 0.000001	time 0.6335 (2.4591)	model_time 0.6332 (0.6331)	loss 0.2276 (0.2329)	grad_norm 0.9952 (0.9132/0.2489)	mem 34631MB
[2025-11-20 01:48:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1350/2882]	eta 1:02:37 lr 0.000001	time 0.6310 (2.4525)	model_time 0.6307 (0.6332)	loss 0.2625 (0.2329)	grad_norm 1.4116 (0.9056/0.2507)	mem 34631MB
[2025-11-20 01:50:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1400/2882]	eta 1:00:28 lr 0.000001	time 0.6288 (2.4483)	model_time 0.6285 (0.6332)	loss 0.2158 (0.2330)	grad_norm 0.5709 (0.9136/0.2513)	mem 34631MB
[2025-11-20 01:51:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1450/2882]	eta 0:58:19 lr 0.000001	time 0.7984 (2.4441)	model_time 0.7981 (0.6333)	loss 0.2040 (0.2328)	grad_norm 1.0146 (0.9090/0.2502)	mem 34631MB
[2025-11-20 01:53:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1500/2882]	eta 0:56:12 lr 0.000001	time 0.6342 (2.4402)	model_time 0.6339 (0.6333)	loss 0.1974 (0.2328)	grad_norm 0.8016 (0.9150/0.2445)	mem 34641MB
[2025-11-20 01:55:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1550/2882]	eta 0:54:05 lr 0.000001	time 0.6302 (2.4367)	model_time 0.6299 (0.6333)	loss 0.2534 (0.2328)	grad_norm 1.0563 (0.9065/0.2452)	mem 34641MB
[2025-11-20 01:58:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1600/2882]	eta 0:52:18 lr 0.000001	time 0.6305 (2.4479)	model_time 0.6302 (0.6333)	loss 0.2142 (0.2329)	grad_norm 0.7671 (0.8948/0.2428)	mem 34641MB
[2025-11-20 02:00:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1650/2882]	eta 0:50:12 lr 0.000001	time 1.2984 (2.4452)	model_time 0.6283 (0.6332)	loss 0.2538 (0.2330)	grad_norm 0.9266 (0.8996/0.2416)	mem 34641MB
[2025-11-20 02:02:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1700/2882]	eta 0:48:08 lr 0.000001	time 0.6277 (2.4436)	model_time 0.6275 (0.6332)	loss 0.2213 (0.2331)	grad_norm 1.0592 (0.8959/0.2335)	mem 34641MB
[2025-11-20 02:04:08 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1750/2882]	eta 0:46:04 lr 0.000001	time 0.6315 (2.4418)	model_time 0.6312 (0.6330)	loss 0.2502 (0.2330)	grad_norm 0.8011 (0.8848/0.2259)	mem 34641MB
[2025-11-20 02:06:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1800/2882]	eta 0:43:58 lr 0.000001	time 0.6301 (2.4389)	model_time 0.6297 (0.6329)	loss 0.2570 (0.2330)	grad_norm 1.0228 (0.8816/0.2249)	mem 34641MB
[2025-11-20 02:08:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1850/2882]	eta 0:41:59 lr 0.000001	time 0.6296 (2.4416)	model_time 0.6293 (0.6329)	loss 0.2354 (0.2330)	grad_norm 0.6823 (0.8882/0.2227)	mem 34641MB
[2025-11-20 02:10:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1900/2882]	eta 0:40:08 lr 0.000001	time 0.6305 (2.4530)	model_time 0.6302 (0.6328)	loss 0.2627 (0.2329)	grad_norm 1.7427 (0.8963/0.2148)	mem 34641MB
[2025-11-20 02:12:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][1950/2882]	eta 0:38:08 lr 0.000001	time 0.6305 (2.4553)	model_time 0.6303 (0.6327)	loss 0.2449 (0.2328)	grad_norm 0.9413 (0.8964/0.2113)	mem 34641MB
[2025-11-20 02:14:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2000/2882]	eta 0:36:05 lr 0.000001	time 0.6331 (2.4550)	model_time 0.6324 (0.6327)	loss 0.2222 (0.2329)	grad_norm 0.7694 (0.9028/0.2214)	mem 34641MB
[2025-11-20 02:16:47 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2050/2882]	eta 0:34:02 lr 0.000001	time 0.6337 (2.4548)	model_time 0.6334 (0.6327)	loss 0.2228 (0.2328)	grad_norm 1.3014 (0.9102/0.2251)	mem 34641MB
[2025-11-20 02:18:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2100/2882]	eta 0:31:57 lr 0.000001	time 0.6330 (2.4527)	model_time 0.6327 (0.6327)	loss 0.2564 (0.2327)	grad_norm 0.6259 (0.9105/0.2205)	mem 34641MB
[2025-11-20 02:20:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2150/2882]	eta 0:29:53 lr 0.000001	time 0.6314 (2.4502)	model_time 0.6312 (0.6326)	loss 0.2471 (0.2327)	grad_norm 0.6091 (0.9207/0.2327)	mem 34641MB
[2025-11-20 02:23:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2200/2882]	eta 0:27:56 lr 0.000001	time 0.6321 (2.4585)	model_time 0.6319 (0.6327)	loss 0.2151 (0.2328)	grad_norm 0.6108 (0.9335/0.2333)	mem 34641MB
[2025-11-20 02:25:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2250/2882]	eta 0:25:53 lr 0.000001	time 0.6414 (2.4573)	model_time 0.6411 (0.6327)	loss 0.2316 (0.2327)	grad_norm 0.8675 (0.9285/0.2366)	mem 34641MB
[2025-11-20 02:27:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2300/2882]	eta 0:23:48 lr 0.000001	time 0.6310 (2.4552)	model_time 0.6308 (0.6327)	loss 0.2329 (0.2327)	grad_norm 0.7672 (0.9365/0.2322)	mem 34641MB
[2025-11-20 02:28:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2350/2882]	eta 0:21:44 lr 0.000001	time 0.6278 (2.4522)	model_time 0.6275 (0.6327)	loss 0.2276 (0.2327)	grad_norm 0.8758 (0.9406/0.2401)	mem 34641MB
[2025-11-20 02:31:08 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2400/2882]	eta 0:19:43 lr 0.000001	time 0.6309 (2.4556)	model_time 0.6307 (0.6327)	loss 0.2458 (0.2326)	grad_norm 0.6615 (0.9344/0.2449)	mem 34641MB
[2025-11-20 02:33:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2450/2882]	eta 0:17:40 lr 0.000001	time 0.6293 (2.4538)	model_time 0.6290 (0.6327)	loss 0.2498 (0.2326)	grad_norm 0.7495 (0.9227/0.2425)	mem 34641MB
[2025-11-20 02:35:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2500/2882]	eta 0:15:39 lr 0.000001	time 0.6324 (2.4598)	model_time 0.6321 (0.6327)	loss 0.2301 (0.2325)	grad_norm 1.0932 (0.9076/0.2440)	mem 34641MB
[2025-11-20 02:37:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2550/2882]	eta 0:13:35 lr 0.000001	time 0.6308 (2.4566)	model_time 0.6306 (0.6327)	loss 0.2550 (0.2326)	grad_norm 1.1589 (0.9049/0.2462)	mem 34641MB
[2025-11-20 02:39:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2600/2882]	eta 0:11:33 lr 0.000001	time 0.6332 (2.4586)	model_time 0.6329 (0.6327)	loss 0.2179 (0.2326)	grad_norm 0.7280 (0.8879/0.2437)	mem 34641MB
[2025-11-20 02:41:25 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2650/2882]	eta 0:09:29 lr 0.000001	time 0.6296 (2.4568)	model_time 0.6294 (0.6328)	loss 0.2248 (0.2326)	grad_norm 0.7679 (0.8833/0.2371)	mem 34641MB
[2025-11-20 02:43:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2700/2882]	eta 0:07:28 lr 0.000001	time 0.6357 (2.4617)	model_time 0.6355 (0.6328)	loss 0.2167 (0.2325)	grad_norm 1.0180 (0.9008/0.2453)	mem 34641MB
[2025-11-20 02:45:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2750/2882]	eta 0:05:25 lr 0.000001	time 0.6355 (2.4623)	model_time 0.6352 (0.6328)	loss 0.2501 (0.2325)	grad_norm 0.9694 (0.9095/0.2364)	mem 34641MB
[2025-11-20 02:47:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2800/2882]	eta 0:03:22 lr 0.000001	time 0.6282 (2.4659)	model_time 0.6280 (0.6327)	loss 0.2272 (0.2325)	grad_norm 1.0275 (0.9166/0.2307)	mem 34641MB
[2025-11-20 02:49:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [11/20][2850/2882]	eta 0:01:18 lr 0.000001	time 0.6270 (2.4609)	model_time 0.6268 (0.6327)	loss 0.2501 (0.2325)	grad_norm 0.9733 (0.9191/0.2306)	mem 34641MB
[2025-11-20 02:50:49 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 11 training takes 1:57:56
[2025-11-20 02:50:49 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_11.pth saving......
[2025-11-20 02:50:51 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_11.pth saved !!!
[2025-11-20 02:51:21 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 30.349 (30.349)	Loss 0.2719 (0.2719)	Mem 34641MB
[2025-11-20 02:51:56 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:11] * Mean AUC-ROC 0.8084 Loss 0.2300
[2025-11-20 02:51:56 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:11] * Per-class AUC-ROC: ['0.8399', '0.8283', '0.8170', '0.9034', '0.7359', '0.5874', '0.7255', '0.7460', '0.8643', '0.9246', '0.7709', '0.7583', '0.8911', '0.9255']
[2025-11-20 02:51:56 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.8084
[2025-11-20 02:51:56 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-20 02:51:58 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-20 02:51:58 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.8084
[2025-11-20 02:52:07 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 8.696 (8.696)	Loss 0.2741 (0.2741)	Mem 34641MB
[2025-11-20 02:52:19 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:11] * Mean AUC-ROC 0.8028 Loss 0.2347
[2025-11-20 02:52:19 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:11] * Per-class AUC-ROC: ['0.8358', '0.8261', '0.8153', '0.9029', '0.7342', '0.5947', '0.7147', '0.7412', '0.8607', '0.9218', '0.7481', '0.7535', '0.8694', '0.9204']
[2025-11-20 02:52:19 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.8028
[2025-11-20 02:52:19 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-20 02:52:22 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-20 02:52:22 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.8028
[2025-11-20 02:52:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][0/2882]	eta 22:35:36 lr 0.000001	time 28.2221 (28.2221)	model_time 0.6347 (0.6347)	loss 0.2491 (0.2491)	grad_norm 0.9621 (0.9621/0.0000)	mem 34641MB
[2025-11-20 02:54:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][50/2882]	eta 2:05:19 lr 0.000001	time 0.6265 (2.6551)	model_time 0.6263 (0.6294)	loss 0.2377 (0.2335)	grad_norm 0.8770 (0.9563/0.2554)	mem 34641MB
[2025-11-20 02:56:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][100/2882]	eta 1:49:14 lr 0.000001	time 0.6312 (2.3559)	model_time 0.6309 (0.6304)	loss 0.2353 (0.2337)	grad_norm 0.5977 (0.9669/0.2661)	mem 34641MB
[2025-11-20 02:58:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][150/2882]	eta 1:42:54 lr 0.000001	time 0.6361 (2.2602)	model_time 0.6359 (0.6319)	loss 0.2350 (0.2328)	grad_norm 0.9047 (0.9412/0.2604)	mem 34641MB
[2025-11-20 02:59:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][200/2882]	eta 1:38:36 lr 0.000001	time 0.6360 (2.2061)	model_time 0.6357 (0.6323)	loss 0.2298 (0.2333)	grad_norm 0.6876 (0.9354/0.2612)	mem 34641MB
[2025-11-20 03:01:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][250/2882]	eta 1:35:39 lr 0.000001	time 0.6297 (2.1805)	model_time 0.6295 (0.6327)	loss 0.2602 (0.2332)	grad_norm 0.9757 (0.9377/0.2696)	mem 34641MB
[2025-11-20 03:03:33 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][300/2882]	eta 1:35:54 lr 0.000001	time 16.3173 (2.2287)	model_time 0.6336 (0.6326)	loss 0.2851 (0.2337)	grad_norm 0.9917 (0.9369/0.2608)	mem 34641MB
[2025-11-20 03:05:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][350/2882]	eta 1:33:21 lr 0.000001	time 0.6307 (2.2123)	model_time 0.6304 (0.6328)	loss 0.2361 (0.2333)	grad_norm 0.8879 (0.9256/0.2539)	mem 34641MB
[2025-11-20 03:07:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][400/2882]	eta 1:32:01 lr 0.000001	time 0.6343 (2.2245)	model_time 0.6340 (0.6329)	loss 0.2314 (0.2331)	grad_norm 1.0683 (0.9157/0.2561)	mem 34641MB
[2025-11-20 03:13:40 internimage_b_mimic_cxr_224] (main.py 729): INFO Full config saved to output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/config.json
[2025-11-20 03:13:40 internimage_b_mimic_cxr_224] (main.py 732): INFO AMP_OPT_LEVEL: O1
AMP_TYPE: float16
AUG:
  AUTO_AUGMENT: none
  COLOR_JITTER: 0.0
  CUTMIX: 0.0
  CUTMIX_MINMAX: null
  MEAN:
  - 0.485
  - 0.456
  - 0.406
  MIXUP: 0.0
  MIXUP_MODE: batch
  MIXUP_PROB: 0.0
  MIXUP_SWITCH_PROB: 0.0
  RANDOM_RESIZED_CROP: false
  RECOUNT: 1
  REMODE: pixel
  REPROB: 0.1
  STD:
  - 0.229
  - 0.224
  - 0.225
BASE:
- ''
DATA:
  BATCH_SIZE: 128
  CACHE_MODE: part
  DATASET: mimic_cxr
  DATA_PATH: /scratch/smehta90/mimic_splits
  IMG_ON_MEMORY: false
  IMG_SIZE: 224
  INTERPOLATION: bicubic
  NUM_WORKERS: 12
  PIN_MEMORY: true
  ZIP_MODE: false
EVAL_22K_TO_1K: false
EVAL_FREQ: 1
EVAL_MODE: false
LOCAL_RANK: 0
MODEL:
  DROP_PATH_RATE: 0.5
  DROP_PATH_TYPE: linear
  DROP_RATE: 0.0
  INTERN_IMAGE:
    CENTER_FEATURE_SCALE: false
    CHANNELS: 112
    CORE_OP: DCNv3
    DEPTHS:
    - 4
    - 4
    - 21
    - 4
    DW_KERNEL_SIZE: null
    GROUPS:
    - 7
    - 14
    - 28
    - 56
    LAYER_SCALE: 1.0e-05
    LEVEL2_POST_NORM: false
    LEVEL2_POST_NORM_BLOCK_IDS: null
    MLP_RATIO: 4.0
    OFFSET_SCALE: 1.0
    POST_NORM: true
    REMOVE_CENTER: false
    RES_POST_NORM: false
    USE_CLIP_PROJECTOR: false
  LABEL_SMOOTHING: 0.0
  NAME: internimage_b_mimic_cxr_224
  NUM_CLASSES: 14
  PRETRAINED: pretrained/internimage_b_1k_224.pth
  RESUME: ''
  TYPE: intern_image
OUTPUT: output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224
PRINT_FREQ: 50
SAVE_CKPT_NUM: 1
SAVE_FREQ: 1
SEED: 42
TAG: run1
TEST:
  CROP: true
  SEQUENTIAL: false
THROUGHPUT_MODE: false
TRAIN:
  ACCUMULATION_STEPS: 1
  AUTO_RESUME: true
  BASE_LR: 0.0001
  CLIP_GRAD: 5.0
  EMA:
    DECAY: 0.9999
    ENABLE: true
  EPOCHS: 20
  LR_LAYER_DECAY: true
  LR_LAYER_DECAY_RATIO: 0.875
  LR_SCHEDULER:
    DECAY_EPOCHS: 30
    DECAY_RATE: 0.1
    NAME: cosine
  MIN_LR: 1.0e-06
  OPTIMIZER:
    BETAS:
    - 0.9
    - 0.999
    DCN_LR_MUL: null
    EPS: 1.0e-08
    FREEZE_BACKBONE: null
    MOMENTUM: 0.9
    NAME: adamw
    USE_ZERO: false
  RAND_INIT_FT_HEAD: true
  START_EPOCH: 0
  USE_CHECKPOINT: false
  WARMUP_EPOCHS: 2
  WARMUP_LR: 5.0e-07
  WEIGHT_DECAY: 0.05

[2025-11-20 03:13:42 internimage_b_mimic_cxr_224] (main.py 175): INFO Creating model:intern_image/internimage_b_mimic_cxr_224
[2025-11-20 03:13:45 internimage_b_mimic_cxr_224] (main.py 178): INFO InternImage(
  (patch_embed): StemLayer(
    (conv1): Conv2d(3, 56, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm1): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((56,), eps=1e-06, elementwise_affine=True)
      (2): to_channels_first()
    )
    (act): GELU(approximate='none')
    (conv2): Conv2d(56, 112, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm2): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
    )
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (levels): ModuleList(
    (0): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): Identity()
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.016)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.031)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.047)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (1): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.062)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.078)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.094)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.109)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (2): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.125)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.141)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.156)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.172)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (4): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.188)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (5): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.203)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (6): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.219)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (7): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.234)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (8): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.250)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (9): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.266)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (10): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.281)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (11): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.297)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (12): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.312)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (13): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.328)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (14): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.344)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (15): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.359)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (16): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.375)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (17): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.391)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (18): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.406)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (19): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.422)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (20): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.438)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(448, 896, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (3): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.453)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.469)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.484)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.500)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (conv_head): Sequential(
    (0): Conv2d(896, 1344, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (1): Sequential(
      (0): BatchNorm2d(1344, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): GELU(approximate='none')
  )
  (head): Linear(in_features=1344, out_features=14, bias=True)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
[2025-11-20 03:13:45 internimage_b_mimic_cxr_224] (main.py 214): INFO Using native Torch AMP. Training in mixed precision.
[2025-11-20 03:13:45 internimage_b_mimic_cxr_224] (main.py 226): INFO using fp16_compress_hook!
[2025-11-20 03:13:45 internimage_b_mimic_cxr_224] (main.py 234): INFO number of params: 96135662
[2025-11-20 03:13:45 internimage_b_mimic_cxr_224] (main.py 247): INFO Using BCEWithLogitsLoss for multi-label classification
[2025-11-20 03:13:45 internimage_b_mimic_cxr_224] (main.py 270): INFO auto resuming from output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_11.pth
[2025-11-20 03:13:45 internimage_b_mimic_cxr_224] (utils.py 60): INFO ==============> Resuming form output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_11.pth....................
[2025-11-20 03:13:48 internimage_b_mimic_cxr_224] (utils.py 92): INFO <All keys matched successfully>
[2025-11-20 03:13:48 internimage_b_mimic_cxr_224] (utils.py 110): INFO => loaded successfully output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_11.pth (epoch 11)
[2025-11-20 03:14:26 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 38.284 (38.284)	Loss 0.2719 (0.2719)	Mem 4564MB
[2025-11-20 03:14:59 internimage_b_mimic_cxr_224] (utils_multilabel.py 141): INFO  * Mean AUC-ROC 0.8084 Loss 0.2300
[2025-11-20 03:14:59 internimage_b_mimic_cxr_224] (utils_multilabel.py 142): INFO  * Per-class AUC-ROC: ['0.8399', '0.8283', '0.8170', '0.9034', '0.7359', '0.5874', '0.7255', '0.7460', '0.8643', '0.9246', '0.7709', '0.7583', '0.8911', '0.9255']
[2025-11-20 03:14:59 internimage_b_mimic_cxr_224] (main.py 283): INFO AUC-ROC of the network on the 2991 val images: 0.8084
[2025-11-20 03:14:59 internimage_b_mimic_cxr_224] (utils.py 24): INFO ==============> Resuming form output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_11.pth....................
[2025-11-20 03:15:01 internimage_b_mimic_cxr_224] (utils.py 44): INFO <All keys matched successfully>
[2025-11-20 03:15:01 internimage_b_mimic_cxr_224] (utils.py 45): INFO Loaded state_dict_ema
[2025-11-20 03:15:10 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 9.285 (9.285)	Loss 0.2741 (0.2741)	Mem 4564MB
[2025-11-20 03:15:22 internimage_b_mimic_cxr_224] (utils_multilabel.py 141): INFO  * Mean AUC-ROC 0.8028 Loss 0.2347
[2025-11-20 03:15:22 internimage_b_mimic_cxr_224] (utils_multilabel.py 142): INFO  * Per-class AUC-ROC: ['0.8358', '0.8261', '0.8153', '0.9029', '0.7342', '0.5947', '0.7147', '0.7412', '0.8607', '0.9218', '0.7481', '0.7535', '0.8694', '0.9204']
[2025-11-20 03:15:22 internimage_b_mimic_cxr_224] (main.py 315): INFO AUC-ROC of the ema network on the 2991 val images: 0.8028
[2025-11-20 03:15:22 internimage_b_mimic_cxr_224] (main.py 331): INFO Start training
[2025-11-20 03:16:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][0/2882]	eta 1 day, 14:35:27 lr 0.000001	time 48.2051 (48.2051)	model_time 17.6434 (17.6434)	loss 0.2524 (0.2524)	grad_norm 0.9190 (0.9190/0.0000)	mem 34249MB
[2025-11-20 03:17:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][50/2882]	eta 2:06:07 lr 0.000001	time 0.6228 (2.6720)	model_time 0.6227 (0.9546)	loss 0.2334 (0.2341)	grad_norm 0.7169 (0.9296/0.2209)	mem 34629MB
[2025-11-20 03:19:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][100/2882]	eta 1:49:52 lr 0.000001	time 0.6221 (2.3696)	model_time 0.6219 (0.7891)	loss 0.2297 (0.2338)	grad_norm 0.6383 (0.9646/0.2569)	mem 34629MB
[2025-11-20 03:21:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][150/2882]	eta 1:43:33 lr 0.000001	time 0.6246 (2.2744)	model_time 0.6244 (0.7337)	loss 0.2290 (0.2330)	grad_norm 1.1682 (0.9360/0.2547)	mem 34629MB
[2025-11-20 03:22:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][200/2882]	eta 1:37:10 lr 0.000001	time 0.6225 (2.1740)	model_time 0.6223 (0.7065)	loss 0.2393 (0.2335)	grad_norm 0.8256 (0.9301/0.2514)	mem 34629MB
[2025-11-20 03:24:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][250/2882]	eta 1:32:59 lr 0.000001	time 0.6204 (2.1200)	model_time 0.6202 (0.6891)	loss 0.2576 (0.2334)	grad_norm 0.7995 (0.9329/0.2541)	mem 34629MB
[2025-11-20 03:26:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][300/2882]	eta 1:32:26 lr 0.000001	time 12.4413 (2.1481)	model_time 0.6220 (0.6777)	loss 0.2871 (0.2338)	grad_norm 1.0811 (0.9282/0.2528)	mem 34629MB
[2025-11-20 03:27:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][350/2882]	eta 1:29:52 lr 0.000001	time 0.6211 (2.1298)	model_time 0.6210 (0.6699)	loss 0.2533 (0.2334)	grad_norm 0.9278 (0.9349/0.2553)	mem 34629MB
[2025-11-20 03:29:25 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][400/2882]	eta 1:26:58 lr 0.000001	time 0.6201 (2.1026)	model_time 0.6199 (0.6638)	loss 0.2346 (0.2334)	grad_norm 0.7233 (0.9157/0.2446)	mem 34629MB
[2025-11-20 03:31:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][450/2882]	eta 1:25:27 lr 0.000001	time 0.6216 (2.1084)	model_time 0.6214 (0.6593)	loss 0.2399 (0.2333)	grad_norm 0.9747 (0.9306/0.2479)	mem 34629MB
[2025-11-20 03:33:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][500/2882]	eta 1:25:29 lr 0.000001	time 0.6211 (2.1536)	model_time 0.6209 (0.6553)	loss 0.2200 (0.2334)	grad_norm 0.9825 (0.9344/0.2473)	mem 34629MB
[2025-11-20 03:35:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][550/2882]	eta 1:25:10 lr 0.000001	time 0.6177 (2.1915)	model_time 0.6175 (0.6522)	loss 0.2547 (0.2337)	grad_norm 1.1245 (0.9430/0.2476)	mem 34629MB
[2025-11-20 03:37:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][600/2882]	eta 1:24:44 lr 0.000001	time 10.1251 (2.2280)	model_time 0.6196 (0.6495)	loss 0.2328 (0.2335)	grad_norm 1.3801 (0.9442/0.2477)	mem 34629MB
[2025-11-20 03:39:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][650/2882]	eta 1:23:56 lr 0.000001	time 0.6199 (2.2567)	model_time 0.6197 (0.6472)	loss 0.2502 (0.2335)	grad_norm 1.0064 (0.9383/0.2550)	mem 34629MB
[2025-11-20 03:41:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][700/2882]	eta 1:22:37 lr 0.000001	time 0.6233 (2.2719)	model_time 0.6231 (0.6453)	loss 0.2291 (0.2332)	grad_norm 0.7688 (0.9314/0.2540)	mem 34629MB
[2025-11-20 03:43:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][750/2882]	eta 1:20:43 lr 0.000001	time 0.6208 (2.2720)	model_time 0.6207 (0.6437)	loss 0.2274 (0.2333)	grad_norm 1.3690 (0.9304/0.2576)	mem 34629MB
[2025-11-20 03:45:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][800/2882]	eta 1:19:08 lr 0.000001	time 0.6184 (2.2809)	model_time 0.6182 (0.6422)	loss 0.2472 (0.2334)	grad_norm 1.4160 (0.9319/0.2582)	mem 34629MB
[2025-11-20 03:47:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][850/2882]	eta 1:17:30 lr 0.000001	time 0.6200 (2.2885)	model_time 0.6198 (0.6409)	loss 0.2354 (0.2334)	grad_norm 0.6260 (0.9223/0.2549)	mem 34629MB
[2025-11-20 03:49:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][900/2882]	eta 1:15:51 lr 0.000001	time 5.2950 (2.2965)	model_time 0.6204 (0.6398)	loss 0.2363 (0.2332)	grad_norm 0.7812 (0.9210/0.2552)	mem 34629MB
[2025-11-20 03:51:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][950/2882]	eta 1:14:06 lr 0.000001	time 0.6208 (2.3016)	model_time 0.6207 (0.6388)	loss 0.2494 (0.2330)	grad_norm 0.7560 (0.9177/0.2476)	mem 34629MB
[2025-11-20 03:53:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1000/2882]	eta 1:12:35 lr 0.000001	time 0.8100 (2.3145)	model_time 0.6211 (0.6380)	loss 0.2343 (0.2330)	grad_norm 0.9036 (0.9269/0.2444)	mem 34629MB
[2025-11-20 03:55:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1050/2882]	eta 1:10:40 lr 0.000001	time 0.6183 (2.3148)	model_time 0.6181 (0.6371)	loss 0.2427 (0.2330)	grad_norm 0.9208 (0.9299/0.2378)	mem 34629MB
[2025-11-20 03:58:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1100/2882]	eta 1:08:59 lr 0.000001	time 0.6179 (2.3230)	model_time 0.6177 (0.6364)	loss 0.2075 (0.2330)	grad_norm 1.1533 (0.9232/0.2401)	mem 34629MB
[2025-11-20 03:59:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1150/2882]	eta 1:07:04 lr 0.000001	time 0.6220 (2.3238)	model_time 0.6219 (0.6357)	loss 0.2425 (0.2330)	grad_norm 1.0651 (0.9202/0.2352)	mem 34629MB
[2025-11-20 04:01:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1200/2882]	eta 1:05:08 lr 0.000001	time 0.6231 (2.3239)	model_time 0.6230 (0.6351)	loss 0.2429 (0.2330)	grad_norm 0.9323 (0.9281/0.2353)	mem 34629MB
[2025-11-20 04:03:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1250/2882]	eta 1:03:17 lr 0.000001	time 0.6272 (2.3268)	model_time 0.6270 (0.6346)	loss 0.2429 (0.2329)	grad_norm 0.9973 (0.9383/0.2332)	mem 34629MB
[2025-11-20 04:06:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1300/2882]	eta 1:01:40 lr 0.000001	time 10.2603 (2.3389)	model_time 0.6247 (0.6343)	loss 0.2226 (0.2330)	grad_norm 1.0361 (0.9385/0.2376)	mem 34629MB
[2025-11-20 04:08:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1350/2882]	eta 0:59:41 lr 0.000001	time 0.6206 (2.3376)	model_time 0.6205 (0.6339)	loss 0.2287 (0.2329)	grad_norm 0.7242 (0.9276/0.2398)	mem 34629MB
[2025-11-20 04:10:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1400/2882]	eta 0:57:51 lr 0.000001	time 0.6220 (2.3426)	model_time 0.6218 (0.6334)	loss 0.2403 (0.2328)	grad_norm 0.7692 (0.9283/0.2369)	mem 34629MB
[2025-11-20 04:12:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1450/2882]	eta 0:55:57 lr 0.000001	time 0.6218 (2.3449)	model_time 0.6217 (0.6331)	loss 0.2380 (0.2328)	grad_norm 0.7690 (0.9303/0.2383)	mem 34629MB
[2025-11-20 04:14:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1500/2882]	eta 0:54:02 lr 0.000001	time 0.6181 (2.3460)	model_time 0.6180 (0.6326)	loss 0.2371 (0.2328)	grad_norm 1.0479 (0.9171/0.2407)	mem 34629MB
[2025-11-20 04:16:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1550/2882]	eta 0:52:08 lr 0.000001	time 0.6217 (2.3487)	model_time 0.6216 (0.6323)	loss 0.2041 (0.2326)	grad_norm 0.9847 (0.9111/0.2376)	mem 34629MB
[2025-11-20 04:18:17 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1600/2882]	eta 0:50:22 lr 0.000001	time 15.4950 (2.3578)	model_time 0.6206 (0.6319)	loss 0.2188 (0.2327)	grad_norm 0.5494 (0.9094/0.2390)	mem 34629MB
[2025-11-20 04:20:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1650/2882]	eta 0:48:27 lr 0.000001	time 0.6207 (2.3604)	model_time 0.6205 (0.6316)	loss 0.2511 (0.2326)	grad_norm 1.0820 (0.9110/0.2424)	mem 34629MB
[2025-11-20 04:22:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1700/2882]	eta 0:46:26 lr 0.000001	time 0.6199 (2.3573)	model_time 0.6197 (0.6313)	loss 0.2087 (0.2325)	grad_norm 0.9165 (0.9052/0.2410)	mem 34629MB
[2025-11-20 04:24:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1750/2882]	eta 0:44:30 lr 0.000001	time 0.6221 (2.3593)	model_time 0.6219 (0.6310)	loss 0.2094 (0.2324)	grad_norm 0.6641 (0.9035/0.2443)	mem 34629MB
[2025-11-20 04:26:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1800/2882]	eta 0:42:32 lr 0.000001	time 0.6199 (2.3590)	model_time 0.6197 (0.6307)	loss 0.2469 (0.2323)	grad_norm 1.1396 (0.9213/0.2472)	mem 34629MB
[2025-11-20 04:28:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1850/2882]	eta 0:40:39 lr 0.000001	time 0.6184 (2.3641)	model_time 0.6182 (0.6304)	loss 0.2330 (0.2323)	grad_norm 1.1953 (0.9215/0.2606)	mem 34629MB
[2025-11-20 04:30:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1900/2882]	eta 0:38:43 lr 0.000001	time 11.2122 (2.3664)	model_time 0.6200 (0.6301)	loss 0.2149 (0.2323)	grad_norm 1.0492 (0.9268/0.2604)	mem 34629MB
[2025-11-20 04:32:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][1950/2882]	eta 0:36:41 lr 0.000001	time 0.6184 (2.3622)	model_time 0.6183 (0.6300)	loss 0.2513 (0.2323)	grad_norm 0.9416 (0.9222/0.2513)	mem 34629MB
[2025-11-20 04:34:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2000/2882]	eta 0:34:41 lr 0.000001	time 0.6225 (2.3595)	model_time 0.6224 (0.6297)	loss 0.2364 (0.2322)	grad_norm 1.1721 (0.9399/0.2639)	mem 34629MB
[2025-11-20 04:36:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2050/2882]	eta 0:32:43 lr 0.000001	time 0.6186 (2.3602)	model_time 0.6185 (0.6295)	loss 0.2427 (0.2322)	grad_norm 0.6526 (0.9373/0.2651)	mem 34629MB
[2025-11-20 04:38:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2100/2882]	eta 0:30:46 lr 0.000001	time 2.3362 (2.3614)	model_time 0.6250 (0.6293)	loss 0.2673 (0.2322)	grad_norm 1.2872 (0.9274/0.2581)	mem 34629MB
[2025-11-20 04:40:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2150/2882]	eta 0:28:50 lr 0.000001	time 6.8847 (2.3639)	model_time 0.6258 (0.6293)	loss 0.2691 (0.2322)	grad_norm 1.1826 (0.9203/0.2535)	mem 34629MB
[2025-11-20 04:42:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2200/2882]	eta 0:26:56 lr 0.000001	time 15.5622 (2.3701)	model_time 0.6199 (0.6291)	loss 0.2454 (0.2322)	grad_norm 0.8471 (0.9263/0.2510)	mem 34629MB
[2025-11-20 04:44:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2250/2882]	eta 0:25:02 lr 0.000001	time 0.6212 (2.3777)	model_time 0.6210 (0.6289)	loss 0.2389 (0.2321)	grad_norm 1.2843 (0.9290/0.2570)	mem 34629MB
[2025-11-20 04:46:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2300/2882]	eta 0:23:03 lr 0.000001	time 0.6190 (2.3765)	model_time 0.6189 (0.6288)	loss 0.2310 (0.2320)	grad_norm 0.6724 (0.9206/0.2464)	mem 34629MB
[2025-11-20 04:48:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2350/2882]	eta 0:21:03 lr 0.000001	time 0.6230 (2.3759)	model_time 0.6228 (0.6287)	loss 0.2206 (0.2321)	grad_norm 0.8706 (0.9322/0.2491)	mem 34629MB
[2025-11-20 04:50:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2400/2882]	eta 0:19:04 lr 0.000001	time 0.6217 (2.3750)	model_time 0.6215 (0.6285)	loss 0.2140 (0.2320)	grad_norm 0.5406 (0.9268/0.2515)	mem 34629MB
[2025-11-20 04:52:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2450/2882]	eta 0:17:04 lr 0.000001	time 0.6215 (2.3718)	model_time 0.6214 (0.6284)	loss 0.2295 (0.2320)	grad_norm 0.8724 (0.9379/0.2497)	mem 34629MB
[2025-11-20 04:54:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2500/2882]	eta 0:15:08 lr 0.000001	time 14.9718 (2.3782)	model_time 0.6247 (0.6283)	loss 0.2393 (0.2320)	grad_norm 0.6671 (0.9339/0.2588)	mem 34629MB
[2025-11-20 04:56:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2550/2882]	eta 0:13:10 lr 0.000001	time 0.6221 (2.3820)	model_time 0.6219 (0.6282)	loss 0.2496 (0.2321)	grad_norm 0.8827 (0.9364/0.2555)	mem 34629MB
[2025-11-20 04:58:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2600/2882]	eta 0:11:12 lr 0.000001	time 0.6183 (2.3849)	model_time 0.6181 (0.6280)	loss 0.2668 (0.2320)	grad_norm 0.8927 (0.9330/0.2617)	mem 34629MB
[2025-11-20 05:00:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2650/2882]	eta 0:09:12 lr 0.000001	time 0.6233 (2.3835)	model_time 0.6231 (0.6279)	loss 0.2118 (0.2321)	grad_norm 0.7869 (0.9268/0.2664)	mem 34629MB
[2025-11-20 05:02:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2700/2882]	eta 0:07:13 lr 0.000001	time 0.6215 (2.3836)	model_time 0.6213 (0.6278)	loss 0.2216 (0.2320)	grad_norm 0.6777 (0.9352/0.2705)	mem 34629MB
[2025-11-20 05:04:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2750/2882]	eta 0:05:14 lr 0.000001	time 0.6210 (2.3820)	model_time 0.6208 (0.6277)	loss 0.2474 (0.2320)	grad_norm 0.9529 (0.9310/0.2744)	mem 34629MB
[2025-11-20 05:06:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2800/2882]	eta 0:03:15 lr 0.000001	time 19.7423 (2.3900)	model_time 0.6214 (0.6275)	loss 0.2292 (0.2320)	grad_norm 1.4810 (0.9299/0.2711)	mem 34629MB
[2025-11-20 05:09:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [12/20][2850/2882]	eta 0:01:16 lr 0.000001	time 0.6256 (2.3917)	model_time 0.6254 (0.6274)	loss 0.2387 (0.2320)	grad_norm 0.6889 (0.9316/0.2735)	mem 34629MB
[2025-11-20 05:10:08 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 12 training takes 1:54:45
[2025-11-20 05:10:08 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_12.pth saving......
[2025-11-20 05:10:10 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_12.pth saved !!!
[2025-11-20 05:10:39 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 29.881 (29.881)	Loss 0.2701 (0.2701)	Mem 34629MB
[2025-11-20 05:11:18 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:12] * Mean AUC-ROC 0.8099 Loss 0.2302
[2025-11-20 05:11:18 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:12] * Per-class AUC-ROC: ['0.8402', '0.8301', '0.8182', '0.9043', '0.7356', '0.5996', '0.7352', '0.7471', '0.8654', '0.9235', '0.7692', '0.7572', '0.8864', '0.9262']
[2025-11-20 05:11:18 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.8099
[2025-11-20 05:11:18 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-20 05:11:20 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-20 05:11:20 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.8099
[2025-11-20 05:11:28 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 8.757 (8.757)	Loss 0.2738 (0.2738)	Mem 34629MB
[2025-11-20 05:11:41 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:12] * Mean AUC-ROC 0.8047 Loss 0.2334
[2025-11-20 05:11:41 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:12] * Per-class AUC-ROC: ['0.8372', '0.8273', '0.8164', '0.9035', '0.7354', '0.5951', '0.7178', '0.7426', '0.8619', '0.9226', '0.7526', '0.7556', '0.8754', '0.9219']
[2025-11-20 05:11:41 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.8047
[2025-11-20 05:11:41 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-20 05:11:42 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-20 05:11:42 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.8047
[2025-11-20 05:12:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][0/2882]	eta 21:51:37 lr 0.000001	time 27.3065 (27.3065)	model_time 0.6264 (0.6264)	loss 0.2409 (0.2409)	grad_norm 1.4608 (1.4608/0.0000)	mem 34629MB
[2025-11-20 05:13:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][50/2882]	eta 2:02:10 lr 0.000001	time 4.0077 (2.5884)	model_time 0.6205 (0.6210)	loss 0.2481 (0.2291)	grad_norm 1.3000 (0.8988/0.2489)	mem 34629MB
[2025-11-20 05:15:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][100/2882]	eta 1:46:45 lr 0.000001	time 0.6210 (2.3025)	model_time 0.6208 (0.6230)	loss 0.2270 (0.2313)	grad_norm 0.9910 (0.9265/0.2503)	mem 34630MB
[2025-11-20 05:17:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][150/2882]	eta 1:41:38 lr 0.000001	time 0.6245 (2.2321)	model_time 0.6242 (0.6227)	loss 0.2229 (0.2291)	grad_norm 1.0748 (0.9122/0.2265)	mem 34630MB
[2025-11-20 05:19:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][200/2882]	eta 1:38:18 lr 0.000001	time 0.6269 (2.1993)	model_time 0.6267 (0.6227)	loss 0.2228 (0.2292)	grad_norm 0.8745 (0.9208/0.2370)	mem 34630MB
[2025-11-20 05:20:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][250/2882]	eta 1:36:23 lr 0.000001	time 0.6247 (2.1974)	model_time 0.6245 (0.6230)	loss 0.2367 (0.2297)	grad_norm 0.8893 (0.9244/0.2471)	mem 34630MB
[2025-11-20 05:22:47 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][300/2882]	eta 1:35:02 lr 0.000001	time 4.9370 (2.2086)	model_time 0.6190 (0.6228)	loss 0.2226 (0.2301)	grad_norm 1.2190 (0.9245/0.2458)	mem 34630MB
[2025-11-20 05:24:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][350/2882]	eta 1:34:36 lr 0.000001	time 10.4086 (2.2418)	model_time 0.6203 (0.6225)	loss 0.2426 (0.2302)	grad_norm 1.0204 (0.9307/0.2492)	mem 34630MB
[2025-11-20 05:26:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][400/2882]	eta 1:32:41 lr 0.000001	time 0.6206 (2.2409)	model_time 0.6204 (0.6224)	loss 0.2202 (0.2303)	grad_norm 0.8211 (0.9219/0.2420)	mem 34630MB
[2025-11-20 05:28:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][450/2882]	eta 1:31:16 lr 0.000001	time 0.6206 (2.2520)	model_time 0.6204 (0.6221)	loss 0.2322 (0.2301)	grad_norm 0.9777 (0.9317/0.2514)	mem 34630MB
[2025-11-20 05:30:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][500/2882]	eta 1:29:04 lr 0.000001	time 0.6269 (2.2438)	model_time 0.6266 (0.6221)	loss 0.2395 (0.2307)	grad_norm 0.8323 (0.9353/0.2529)	mem 34630MB
[2025-11-20 05:32:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][550/2882]	eta 1:26:49 lr 0.000001	time 0.6186 (2.2340)	model_time 0.6184 (0.6223)	loss 0.2371 (0.2307)	grad_norm 1.2779 (0.9335/0.2432)	mem 34630MB
[2025-11-20 05:34:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][600/2882]	eta 1:24:57 lr 0.000001	time 6.6586 (2.2339)	model_time 0.6212 (0.6221)	loss 0.2457 (0.2307)	grad_norm 0.8813 (0.9323/0.2476)	mem 34630MB
[2025-11-20 05:36:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][650/2882]	eta 1:23:23 lr 0.000001	time 6.5711 (2.2419)	model_time 0.6189 (0.6219)	loss 0.1981 (0.2311)	grad_norm 0.9315 (0.9445/0.2460)	mem 34630MB
[2025-11-20 05:37:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][700/2882]	eta 1:21:48 lr 0.000001	time 0.6209 (2.2493)	model_time 0.6207 (0.6220)	loss 0.2077 (0.2310)	grad_norm 1.0057 (0.9482/0.2496)	mem 34630MB
[2025-11-20 05:39:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][750/2882]	eta 1:20:11 lr 0.000001	time 0.6186 (2.2569)	model_time 0.6185 (0.6219)	loss 0.2354 (0.2313)	grad_norm 0.8753 (0.9539/0.2656)	mem 34630MB
[2025-11-20 05:41:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][800/2882]	eta 1:18:15 lr 0.000001	time 0.6207 (2.2554)	model_time 0.6205 (0.6218)	loss 0.2412 (0.2313)	grad_norm 1.2353 (0.9461/0.2665)	mem 34630MB
[2025-11-20 05:43:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][850/2882]	eta 1:16:22 lr 0.000001	time 0.6208 (2.2552)	model_time 0.6206 (0.6219)	loss 0.2366 (0.2313)	grad_norm 0.9350 (0.9456/0.2682)	mem 34630MB
[2025-11-20 05:45:47 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][900/2882]	eta 1:14:56 lr 0.000001	time 6.8369 (2.2688)	model_time 0.6211 (0.6218)	loss 0.2413 (0.2313)	grad_norm 0.7268 (0.9547/0.2692)	mem 34630MB
[2025-11-20 05:48:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][950/2882]	eta 1:13:47 lr 0.000001	time 12.5542 (2.2915)	model_time 0.6208 (0.6216)	loss 0.2181 (0.2313)	grad_norm 0.8743 (0.9498/0.2684)	mem 34630MB
[2025-11-20 05:49:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1000/2882]	eta 1:11:54 lr 0.000001	time 0.6194 (2.2928)	model_time 0.6192 (0.6217)	loss 0.2222 (0.2312)	grad_norm 1.3415 (0.9548/0.2687)	mem 34630MB
[2025-11-20 05:51:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1050/2882]	eta 1:09:56 lr 0.000001	time 0.6225 (2.2905)	model_time 0.6223 (0.6216)	loss 0.2539 (0.2313)	grad_norm 0.9686 (0.9397/0.2486)	mem 34630MB
[2025-11-20 05:53:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1100/2882]	eta 1:08:08 lr 0.000001	time 0.6181 (2.2943)	model_time 0.6180 (0.6216)	loss 0.2700 (0.2313)	grad_norm 1.4939 (0.9481/0.2394)	mem 34630MB
[2025-11-20 05:55:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1150/2882]	eta 1:06:12 lr 0.000001	time 0.6218 (2.2934)	model_time 0.6216 (0.6215)	loss 0.2486 (0.2313)	grad_norm 0.8374 (0.9565/0.2416)	mem 34630MB
[2025-11-20 05:57:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1200/2882]	eta 1:04:28 lr 0.000001	time 0.6211 (2.3002)	model_time 0.6209 (0.6215)	loss 0.2517 (0.2313)	grad_norm 1.2417 (0.9563/0.2466)	mem 34630MB
[2025-11-20 06:00:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1250/2882]	eta 1:03:04 lr 0.000001	time 2.0404 (2.3189)	model_time 0.6239 (0.6216)	loss 0.2437 (0.2313)	grad_norm 0.7681 (0.9598/0.2532)	mem 34630MB
[2025-11-20 06:02:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1300/2882]	eta 1:01:12 lr 0.000001	time 0.6242 (2.3216)	model_time 0.6239 (0.6216)	loss 0.2452 (0.2314)	grad_norm 0.9051 (0.9549/0.2559)	mem 34630MB
[2025-11-20 06:04:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1350/2882]	eta 0:59:18 lr 0.000001	time 0.6213 (2.3230)	model_time 0.6211 (0.6216)	loss 0.2370 (0.2313)	grad_norm 0.8572 (0.9645/0.2631)	mem 34630MB
[2025-11-20 06:05:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1400/2882]	eta 0:57:22 lr 0.000001	time 5.9530 (2.3226)	model_time 0.6198 (0.6216)	loss 0.2387 (0.2314)	grad_norm 0.5211 (0.9592/0.2719)	mem 34630MB
[2025-11-20 06:07:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1450/2882]	eta 0:55:30 lr 0.000001	time 0.6216 (2.3255)	model_time 0.6214 (0.6216)	loss 0.1996 (0.2312)	grad_norm 0.9201 (0.9516/0.2774)	mem 34630MB
[2025-11-20 06:09:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1500/2882]	eta 0:53:34 lr 0.000001	time 0.6189 (2.3262)	model_time 0.6188 (0.6216)	loss 0.2285 (0.2313)	grad_norm 0.9280 (0.9401/0.2619)	mem 34630MB
[2025-11-20 06:12:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1550/2882]	eta 0:51:54 lr 0.000001	time 0.6198 (2.3381)	model_time 0.6196 (0.6215)	loss 0.2287 (0.2313)	grad_norm 0.8165 (0.9242/0.2490)	mem 34630MB
[2025-11-20 06:14:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1600/2882]	eta 0:49:54 lr 0.000001	time 0.6203 (2.3358)	model_time 0.6201 (0.6215)	loss 0.2338 (0.2312)	grad_norm 0.8858 (0.9307/0.2494)	mem 34630MB
[2025-11-20 06:16:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1650/2882]	eta 0:47:59 lr 0.000001	time 0.6212 (2.3375)	model_time 0.6210 (0.6215)	loss 0.2125 (0.2312)	grad_norm 1.0883 (0.9282/0.2414)	mem 34630MB
[2025-11-20 06:18:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1700/2882]	eta 0:46:11 lr 0.000001	time 11.8143 (2.3448)	model_time 0.6223 (0.6214)	loss 0.2546 (0.2313)	grad_norm 1.2994 (0.9317/0.2404)	mem 34630MB
[2025-11-20 06:20:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1750/2882]	eta 0:44:16 lr 0.000001	time 0.6201 (2.3468)	model_time 0.6199 (0.6214)	loss 0.2151 (0.2313)	grad_norm 1.0896 (0.9353/0.2269)	mem 34630MB
[2025-11-20 06:22:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1800/2882]	eta 0:42:21 lr 0.000001	time 0.6217 (2.3489)	model_time 0.6215 (0.6214)	loss 0.2339 (0.2313)	grad_norm 0.6950 (0.9443/0.2377)	mem 34630MB
[2025-11-20 06:24:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1850/2882]	eta 0:40:35 lr 0.000001	time 1.3079 (2.3601)	model_time 0.6215 (0.6214)	loss 0.2217 (0.2314)	grad_norm 1.0594 (0.9500/0.2492)	mem 34630MB
[2025-11-20 06:26:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1900/2882]	eta 0:38:42 lr 0.000001	time 0.6220 (2.3655)	model_time 0.6217 (0.6214)	loss 0.2373 (0.2313)	grad_norm 0.8021 (0.9414/0.2428)	mem 34630MB
[2025-11-20 06:28:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][1950/2882]	eta 0:36:50 lr 0.000001	time 0.6249 (2.3713)	model_time 0.6247 (0.6215)	loss 0.2143 (0.2313)	grad_norm 1.0189 (0.9422/0.2373)	mem 34630MB
[2025-11-20 06:30:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2000/2882]	eta 0:34:55 lr 0.000001	time 12.4462 (2.3759)	model_time 0.6250 (0.6216)	loss 0.2385 (0.2313)	grad_norm 1.0273 (0.9395/0.2299)	mem 34630MB
[2025-11-20 06:33:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2050/2882]	eta 0:32:58 lr 0.000001	time 0.6232 (2.3782)	model_time 0.6230 (0.6217)	loss 0.2428 (0.2313)	grad_norm 0.7450 (0.9402/0.2399)	mem 34630MB
[2025-11-20 06:35:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2100/2882]	eta 0:31:00 lr 0.000001	time 0.6229 (2.3796)	model_time 0.6227 (0.6218)	loss 0.2122 (0.2314)	grad_norm 1.0364 (0.9372/0.2414)	mem 34630MB
[2025-11-20 06:37:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2150/2882]	eta 0:29:03 lr 0.000001	time 3.1571 (2.3822)	model_time 0.6251 (0.6218)	loss 0.2335 (0.2314)	grad_norm 1.3122 (0.9455/0.2447)	mem 34630MB
[2025-11-20 06:39:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2200/2882]	eta 0:27:03 lr 0.000001	time 0.6210 (2.3798)	model_time 0.6208 (0.6219)	loss 0.2528 (0.2315)	grad_norm 0.7136 (0.9600/0.2661)	mem 34630MB
[2025-11-20 06:40:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2250/2882]	eta 0:25:02 lr 0.000001	time 0.6188 (2.3770)	model_time 0.6186 (0.6219)	loss 0.2059 (0.2315)	grad_norm 0.6523 (0.9500/0.2830)	mem 34630MB
[2025-11-20 06:43:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2300/2882]	eta 0:23:06 lr 0.000001	time 16.7166 (2.3820)	model_time 0.6220 (0.6218)	loss 0.2228 (0.2315)	grad_norm 0.6402 (0.9454/0.2853)	mem 34630MB
[2025-11-20 06:44:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2350/2882]	eta 0:21:05 lr 0.000001	time 0.6226 (2.3783)	model_time 0.6224 (0.6218)	loss 0.2244 (0.2315)	grad_norm 0.9462 (0.9474/0.2856)	mem 34630MB
[2025-11-20 06:46:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2400/2882]	eta 0:19:06 lr 0.000001	time 3.5174 (2.3789)	model_time 0.6246 (0.6218)	loss 0.2289 (0.2315)	grad_norm 0.7837 (0.9532/0.2821)	mem 34630MB
[2025-11-20 06:48:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2450/2882]	eta 0:17:07 lr 0.000001	time 0.6242 (2.3792)	model_time 0.6240 (0.6218)	loss 0.2456 (0.2315)	grad_norm 0.8351 (0.9477/0.2702)	mem 34630MB
[2025-11-20 06:50:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2500/2882]	eta 0:15:08 lr 0.000001	time 0.6199 (2.3795)	model_time 0.6198 (0.6218)	loss 0.2159 (0.2315)	grad_norm 0.7457 (0.9517/0.2604)	mem 34630MB
[2025-11-20 06:52:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2550/2882]	eta 0:13:09 lr 0.000001	time 0.6198 (2.3766)	model_time 0.6196 (0.6218)	loss 0.2483 (0.2315)	grad_norm 0.9624 (0.9573/0.2536)	mem 34630MB
[2025-11-20 06:54:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2600/2882]	eta 0:11:11 lr 0.000001	time 16.3015 (2.3814)	model_time 0.6198 (0.6218)	loss 0.2197 (0.2315)	grad_norm 0.6184 (0.9606/0.2534)	mem 34630MB
[2025-11-20 06:56:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2650/2882]	eta 0:09:12 lr 0.000001	time 0.6221 (2.3828)	model_time 0.6220 (0.6218)	loss 0.2343 (0.2314)	grad_norm 0.5338 (0.9604/0.2505)	mem 34630MB
[2025-11-20 06:59:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2700/2882]	eta 0:07:14 lr 0.000001	time 0.6214 (2.3847)	model_time 0.6212 (0.6218)	loss 0.2423 (0.2314)	grad_norm 0.6238 (0.9410/0.2511)	mem 34630MB
[2025-11-20 07:01:08 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2750/2882]	eta 0:05:15 lr 0.000001	time 0.6197 (2.3867)	model_time 0.6195 (0.6218)	loss 0.2069 (0.2314)	grad_norm 1.2029 (0.9419/0.2484)	mem 34630MB
[2025-11-20 07:03:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2800/2882]	eta 0:03:15 lr 0.000001	time 0.6224 (2.3886)	model_time 0.6222 (0.6218)	loss 0.2283 (0.2314)	grad_norm 0.8468 (0.9262/0.2468)	mem 34630MB
[2025-11-20 07:05:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [13/20][2850/2882]	eta 0:01:16 lr 0.000001	time 7.0258 (2.3935)	model_time 0.6254 (0.6219)	loss 0.2276 (0.2315)	grad_norm 1.2201 (0.9421/0.2553)	mem 34630MB
[2025-11-20 07:07:00 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 13 training takes 1:55:17
[2025-11-20 07:07:00 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_13.pth saving......
[2025-11-20 07:07:02 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_13.pth saved !!!
[2025-11-20 07:07:36 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 33.841 (33.841)	Loss 0.2725 (0.2725)	Mem 34630MB
[2025-11-20 07:08:16 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:13] * Mean AUC-ROC 0.8085 Loss 0.2295
[2025-11-20 07:08:16 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:13] * Per-class AUC-ROC: ['0.8403', '0.8308', '0.8209', '0.9029', '0.7370', '0.5948', '0.7198', '0.7460', '0.8652', '0.9244', '0.7616', '0.7604', '0.8887', '0.9264']
[2025-11-20 07:08:16 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.8085
[2025-11-20 07:08:16 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.8099
[2025-11-20 07:08:25 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 9.011 (9.011)	Loss 0.2732 (0.2732)	Mem 34630MB
[2025-11-20 07:08:37 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:13] * Mean AUC-ROC 0.8061 Loss 0.2324
[2025-11-20 07:08:37 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:13] * Per-class AUC-ROC: ['0.8383', '0.8281', '0.8170', '0.9036', '0.7355', '0.5962', '0.7204', '0.7438', '0.8629', '0.9231', '0.7559', '0.7572', '0.8799', '0.9232']
[2025-11-20 07:08:37 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.8061
[2025-11-20 07:08:37 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-20 07:08:40 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-20 07:08:40 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.8061
[2025-11-20 07:09:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][0/2882]	eta 23:39:56 lr 0.000001	time 29.5616 (29.5616)	model_time 0.6223 (0.6223)	loss 0.2335 (0.2335)	grad_norm 0.6711 (0.6711/0.0000)	mem 34630MB
[2025-11-20 07:11:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][50/2882]	eta 2:21:11 lr 0.000001	time 0.6182 (2.9913)	model_time 0.6181 (0.6227)	loss 0.2105 (0.2290)	grad_norm 0.9904 (0.9216/0.2599)	mem 34630MB
[2025-11-20 07:13:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][100/2882]	eta 2:02:25 lr 0.000001	time 0.6205 (2.6404)	model_time 0.6203 (0.6207)	loss 0.2302 (0.2303)	grad_norm 0.9377 (0.9657/0.2606)	mem 34630MB
[2025-11-20 07:15:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][150/2882]	eta 1:57:30 lr 0.000001	time 0.6180 (2.5808)	model_time 0.6178 (0.6202)	loss 0.2327 (0.2306)	grad_norm 0.8278 (0.9616/0.2615)	mem 34630MB
[2025-11-20 07:17:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][200/2882]	eta 1:52:35 lr 0.000001	time 1.0803 (2.5189)	model_time 0.6211 (0.6209)	loss 0.2514 (0.2308)	grad_norm 1.4159 (0.9710/0.2691)	mem 34630MB
[2025-11-20 07:19:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][250/2882]	eta 1:48:50 lr 0.000001	time 0.6203 (2.4814)	model_time 0.6202 (0.6211)	loss 0.2541 (0.2304)	grad_norm 1.3158 (0.9665/0.2588)	mem 34630MB
[2025-11-20 07:21:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][300/2882]	eta 1:47:06 lr 0.000001	time 10.5422 (2.4889)	model_time 0.6243 (0.6214)	loss 0.2360 (0.2310)	grad_norm 1.0624 (0.9545/0.2500)	mem 34630MB
[2025-11-20 07:23:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][350/2882]	eta 1:45:00 lr 0.000001	time 1.4743 (2.4884)	model_time 0.6187 (0.6215)	loss 0.2449 (0.2309)	grad_norm 0.7579 (0.9623/0.2441)	mem 34630MB
[2025-11-20 07:25:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][400/2882]	eta 1:42:25 lr 0.000001	time 1.4207 (2.4760)	model_time 0.6208 (0.6214)	loss 0.2317 (0.2310)	grad_norm 1.0441 (0.9619/0.2492)	mem 34630MB
[2025-11-20 07:27:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][450/2882]	eta 1:39:32 lr 0.000001	time 0.6215 (2.4560)	model_time 0.6213 (0.6213)	loss 0.2252 (0.2311)	grad_norm 0.8563 (0.9544/0.2577)	mem 34630MB
[2025-11-20 07:29:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][500/2882]	eta 1:36:40 lr 0.000001	time 3.3790 (2.4352)	model_time 0.6197 (0.6212)	loss 0.2114 (0.2310)	grad_norm 0.6487 (0.9436/0.2489)	mem 34630MB
[2025-11-20 07:30:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][550/2882]	eta 1:33:54 lr 0.000001	time 0.6195 (2.4162)	model_time 0.6193 (0.6212)	loss 0.2153 (0.2310)	grad_norm 0.7306 (0.9424/0.2452)	mem 34630MB
[2025-11-20 07:32:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][600/2882]	eta 1:31:49 lr 0.000001	time 8.4733 (2.4145)	model_time 0.6218 (0.6212)	loss 0.2288 (0.2311)	grad_norm 0.8545 (0.9555/0.2484)	mem 34630MB
[2025-11-20 07:34:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][650/2882]	eta 1:29:41 lr 0.000001	time 2.4456 (2.4112)	model_time 0.6203 (0.6212)	loss 0.2101 (0.2312)	grad_norm 1.2105 (0.9440/0.2525)	mem 34630MB
[2025-11-20 07:36:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][700/2882]	eta 1:27:59 lr 0.000001	time 0.6214 (2.4195)	model_time 0.6212 (0.6213)	loss 0.2239 (0.2315)	grad_norm 1.3050 (0.9330/0.2401)	mem 34630MB
[2025-11-20 07:38:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][750/2882]	eta 1:26:04 lr 0.000001	time 0.6193 (2.4223)	model_time 0.6192 (0.6213)	loss 0.2053 (0.2312)	grad_norm 0.8049 (0.9413/0.2427)	mem 34630MB
[2025-11-20 07:40:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][800/2882]	eta 1:23:49 lr 0.000001	time 0.6188 (2.4158)	model_time 0.6187 (0.6213)	loss 0.2505 (0.2312)	grad_norm 1.5941 (0.9385/0.2405)	mem 34630MB
[2025-11-20 07:42:47 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][850/2882]	eta 1:21:29 lr 0.000001	time 0.6219 (2.4060)	model_time 0.6217 (0.6213)	loss 0.2338 (0.2310)	grad_norm 1.3743 (0.9335/0.2514)	mem 34630MB
[2025-11-20 07:44:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][900/2882]	eta 1:19:39 lr 0.000001	time 9.4263 (2.4116)	model_time 0.6196 (0.6214)	loss 0.2137 (0.2308)	grad_norm 0.6052 (0.9376/0.2603)	mem 34630MB
[2025-11-20 07:46:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][950/2882]	eta 1:17:46 lr 0.000001	time 7.7207 (2.4156)	model_time 0.6180 (0.6213)	loss 0.2288 (0.2306)	grad_norm 1.1479 (0.9463/0.2655)	mem 34630MB
[2025-11-20 07:48:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1000/2882]	eta 1:15:36 lr 0.000001	time 0.6201 (2.4103)	model_time 0.6200 (0.6212)	loss 0.2164 (0.2307)	grad_norm 0.9483 (0.9449/0.2702)	mem 34630MB
[2025-11-20 07:50:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1050/2882]	eta 1:13:36 lr 0.000001	time 0.6215 (2.4106)	model_time 0.6213 (0.6213)	loss 0.2071 (0.2309)	grad_norm 1.0228 (0.9378/0.2569)	mem 34630MB
[2025-11-20 07:52:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1100/2882]	eta 1:11:34 lr 0.000001	time 0.6192 (2.4099)	model_time 0.6191 (0.6212)	loss 0.2274 (0.2308)	grad_norm 1.1120 (0.9338/0.2546)	mem 34630MB
[2025-11-20 07:54:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1150/2882]	eta 1:09:29 lr 0.000001	time 0.6183 (2.4073)	model_time 0.6181 (0.6212)	loss 0.2540 (0.2308)	grad_norm 1.1520 (0.9404/0.2510)	mem 34630MB
[2025-11-20 07:56:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1200/2882]	eta 1:07:18 lr 0.000001	time 1.5070 (2.4011)	model_time 0.6206 (0.6212)	loss 0.2183 (0.2307)	grad_norm 0.7705 (0.9307/0.2449)	mem 34630MB
[2025-11-20 07:58:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1250/2882]	eta 1:05:28 lr 0.000001	time 15.0327 (2.4073)	model_time 0.6223 (0.6212)	loss 0.2036 (0.2307)	grad_norm 0.6915 (0.9280/0.2364)	mem 34630MB
[2025-11-20 08:00:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1300/2882]	eta 1:03:29 lr 0.000001	time 0.6190 (2.4078)	model_time 0.6189 (0.6212)	loss 0.2162 (0.2307)	grad_norm 0.9578 (0.9227/0.2405)	mem 34630MB
[2025-11-20 08:02:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1350/2882]	eta 1:01:25 lr 0.000001	time 0.6204 (2.4059)	model_time 0.6203 (0.6211)	loss 0.2229 (0.2308)	grad_norm 1.0775 (0.9318/0.2443)	mem 34630MB
[2025-11-20 08:04:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1400/2882]	eta 0:59:19 lr 0.000001	time 0.6188 (2.4017)	model_time 0.6186 (0.6211)	loss 0.2412 (0.2308)	grad_norm 0.8296 (0.9345/0.2421)	mem 34630MB
[2025-11-20 08:06:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1450/2882]	eta 0:57:20 lr 0.000001	time 0.6207 (2.4023)	model_time 0.6206 (0.6210)	loss 0.2147 (0.2309)	grad_norm 1.4831 (0.9399/0.2534)	mem 34630MB
[2025-11-20 08:08:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1500/2882]	eta 0:55:22 lr 0.000001	time 10.1980 (2.4040)	model_time 0.6190 (0.6210)	loss 0.2007 (0.2309)	grad_norm 0.8241 (0.9371/0.2499)	mem 34630MB
[2025-11-20 08:11:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1550/2882]	eta 0:53:31 lr 0.000001	time 12.1278 (2.4113)	model_time 0.6213 (0.6211)	loss 0.2253 (0.2309)	grad_norm 0.6837 (0.9374/0.2535)	mem 34630MB
[2025-11-20 08:13:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1600/2882]	eta 0:51:35 lr 0.000001	time 0.6226 (2.4145)	model_time 0.6224 (0.6211)	loss 0.2077 (0.2309)	grad_norm 1.1365 (0.9562/0.2484)	mem 34630MB
[2025-11-20 08:15:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1650/2882]	eta 0:49:33 lr 0.000001	time 0.6200 (2.4139)	model_time 0.6199 (0.6211)	loss 0.2586 (0.2309)	grad_norm 1.1191 (0.9626/0.2551)	mem 34630MB
[2025-11-20 08:17:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1700/2882]	eta 0:47:30 lr 0.000001	time 0.6188 (2.4113)	model_time 0.6186 (0.6211)	loss 0.2309 (0.2309)	grad_norm 1.2596 (0.9736/0.2612)	mem 34630MB
[2025-11-20 08:19:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1750/2882]	eta 0:45:31 lr 0.000001	time 0.6222 (2.4134)	model_time 0.6220 (0.6211)	loss 0.2446 (0.2310)	grad_norm 0.7382 (0.9677/0.2529)	mem 34630MB
[2025-11-20 08:20:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1800/2882]	eta 0:43:25 lr 0.000001	time 0.6210 (2.4081)	model_time 0.6208 (0.6212)	loss 0.2021 (0.2308)	grad_norm 0.7488 (0.9710/0.2611)	mem 34630MB
[2025-11-20 08:23:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1850/2882]	eta 0:41:32 lr 0.000001	time 18.4307 (2.4151)	model_time 0.6225 (0.6212)	loss 0.2155 (0.2309)	grad_norm 0.9378 (0.9610/0.2626)	mem 34630MB
[2025-11-20 08:25:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1900/2882]	eta 0:39:30 lr 0.000001	time 0.6217 (2.4142)	model_time 0.6215 (0.6212)	loss 0.2222 (0.2310)	grad_norm 0.6168 (0.9477/0.2608)	mem 34630MB
[2025-11-20 08:27:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][1950/2882]	eta 0:37:28 lr 0.000001	time 0.6212 (2.4129)	model_time 0.6210 (0.6212)	loss 0.2187 (0.2309)	grad_norm 0.8627 (0.9395/0.2556)	mem 34630MB
[2025-11-20 08:28:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2000/2882]	eta 0:35:24 lr 0.000001	time 0.6218 (2.4085)	model_time 0.6216 (0.6212)	loss 0.2402 (0.2310)	grad_norm 1.0534 (0.9338/0.2517)	mem 34630MB
[2025-11-20 08:30:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2050/2882]	eta 0:33:20 lr 0.000001	time 0.6212 (2.4044)	model_time 0.6210 (0.6212)	loss 0.2206 (0.2310)	grad_norm 1.1584 (0.9374/0.2578)	mem 34630MB
[2025-11-20 08:32:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2100/2882]	eta 0:31:18 lr 0.000001	time 3.5274 (2.4017)	model_time 0.6216 (0.6212)	loss 0.1977 (0.2310)	grad_norm 0.7243 (0.9418/0.2565)	mem 34630MB
[2025-11-20 08:34:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2150/2882]	eta 0:29:19 lr 0.000001	time 15.7349 (2.4043)	model_time 0.6209 (0.6213)	loss 0.2187 (0.2311)	grad_norm 1.1054 (0.9440/0.2530)	mem 34630MB
[2025-11-20 08:36:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2200/2882]	eta 0:27:17 lr 0.000001	time 0.6224 (2.4004)	model_time 0.6222 (0.6213)	loss 0.2275 (0.2311)	grad_norm 0.6762 (0.9411/0.2588)	mem 34630MB
[2025-11-20 08:38:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2250/2882]	eta 0:25:16 lr 0.000001	time 0.6214 (2.4001)	model_time 0.6212 (0.6213)	loss 0.2492 (0.2311)	grad_norm 0.8505 (0.9406/0.2593)	mem 34630MB
[2025-11-20 08:40:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2300/2882]	eta 0:23:15 lr 0.000001	time 0.6195 (2.3977)	model_time 0.6193 (0.6213)	loss 0.2227 (0.2311)	grad_norm 0.7859 (0.9355/0.2650)	mem 34630MB
[2025-11-20 08:42:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2350/2882]	eta 0:21:15 lr 0.000001	time 0.6202 (2.3979)	model_time 0.6200 (0.6213)	loss 0.2460 (0.2312)	grad_norm 1.1031 (0.9352/0.2586)	mem 34630MB
[2025-11-20 08:44:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2400/2882]	eta 0:19:14 lr 0.000001	time 0.6186 (2.3948)	model_time 0.6184 (0.6212)	loss 0.2180 (0.2312)	grad_norm 0.7760 (0.9240/0.2495)	mem 34630MB
[2025-11-20 08:46:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2450/2882]	eta 0:17:13 lr 0.000001	time 4.9561 (2.3934)	model_time 0.6244 (0.6212)	loss 0.2248 (0.2312)	grad_norm 1.3403 (0.9240/0.2478)	mem 34630MB
[2025-11-20 08:48:23 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2500/2882]	eta 0:15:13 lr 0.000001	time 0.6208 (2.3925)	model_time 0.6207 (0.6212)	loss 0.2414 (0.2312)	grad_norm 0.7369 (0.9171/0.2392)	mem 34630MB
[2025-11-20 08:50:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2550/2882]	eta 0:13:17 lr 0.000001	time 0.6221 (2.4012)	model_time 0.6219 (0.6212)	loss 0.2268 (0.2312)	grad_norm 0.7175 (0.9081/0.2356)	mem 34630MB
[2025-11-20 08:52:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2600/2882]	eta 0:11:18 lr 0.000001	time 0.6211 (2.4053)	model_time 0.6210 (0.6212)	loss 0.2536 (0.2311)	grad_norm 1.2941 (0.9104/0.2318)	mem 34630MB
[2025-11-20 08:54:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2650/2882]	eta 0:09:18 lr 0.000001	time 0.6185 (2.4059)	model_time 0.6183 (0.6212)	loss 0.2535 (0.2311)	grad_norm 1.0591 (0.8938/0.2321)	mem 34630MB
[2025-11-20 08:57:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2700/2882]	eta 0:07:18 lr 0.000001	time 0.6198 (2.4081)	model_time 0.6196 (0.6212)	loss 0.2302 (0.2311)	grad_norm 0.6842 (0.8978/0.2378)	mem 34630MB
[2025-11-20 08:59:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2750/2882]	eta 0:05:17 lr 0.000001	time 4.9105 (2.4080)	model_time 0.6209 (0.6212)	loss 0.2247 (0.2311)	grad_norm 0.6248 (0.9021/0.2353)	mem 34630MB
[2025-11-20 09:01:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2800/2882]	eta 0:03:17 lr 0.000001	time 16.7996 (2.4127)	model_time 0.6205 (0.6212)	loss 0.2432 (0.2312)	grad_norm 0.6659 (0.9025/0.2439)	mem 34630MB
[2025-11-20 09:03:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [14/20][2850/2882]	eta 0:01:17 lr 0.000001	time 0.7434 (2.4109)	model_time 0.7431 (0.6212)	loss 0.2221 (0.2312)	grad_norm 0.6988 (0.9013/0.2349)	mem 34630MB
[2025-11-20 09:04:16 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 14 training takes 1:55:36
[2025-11-20 09:04:16 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_14.pth saving......
[2025-11-20 09:04:18 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_14.pth saved !!!
[2025-11-20 09:04:48 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 30.009 (30.009)	Loss 0.2708 (0.2708)	Mem 34630MB
[2025-11-20 09:05:25 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:14] * Mean AUC-ROC 0.8101 Loss 0.2292
[2025-11-20 09:05:25 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:14] * Per-class AUC-ROC: ['0.8399', '0.8303', '0.8195', '0.9036', '0.7346', '0.5937', '0.7289', '0.7483', '0.8664', '0.9245', '0.7730', '0.7612', '0.8905', '0.9272']
[2025-11-20 09:05:25 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.8101
[2025-11-20 09:05:25 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-20 09:05:28 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-20 09:05:28 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.8101
[2025-11-20 09:05:37 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 8.845 (8.845)	Loss 0.2729 (0.2729)	Mem 34630MB
[2025-11-20 09:05:49 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:14] * Mean AUC-ROC 0.8072 Loss 0.2316
[2025-11-20 09:05:49 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:14] * Per-class AUC-ROC: ['0.8390', '0.8288', '0.8185', '0.9038', '0.7357', '0.5969', '0.7222', '0.7448', '0.8638', '0.9236', '0.7582', '0.7581', '0.8833', '0.9243']
[2025-11-20 09:05:49 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.8072
[2025-11-20 09:05:49 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-20 09:05:51 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-20 09:05:51 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.8072
[2025-11-20 09:06:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][0/2882]	eta 21:47:52 lr 0.000001	time 27.2285 (27.2285)	model_time 0.6279 (0.6279)	loss 0.2369 (0.2369)	grad_norm 1.2391 (1.2391/0.0000)	mem 34630MB
[2025-11-20 09:08:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][50/2882]	eta 2:13:10 lr 0.000001	time 0.6246 (2.8216)	model_time 0.6244 (0.6247)	loss 0.2252 (0.2318)	grad_norm 0.6643 (0.9917/0.2128)	mem 34630MB
[2025-11-20 09:09:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][100/2882]	eta 1:53:39 lr 0.000001	time 0.6256 (2.4515)	model_time 0.6254 (0.6262)	loss 0.2503 (0.2304)	grad_norm 0.9190 (0.9905/0.2415)	mem 34630MB
[2025-11-20 09:11:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][150/2882]	eta 1:46:53 lr 0.000001	time 0.6243 (2.3475)	model_time 0.6241 (0.6257)	loss 0.2321 (0.2304)	grad_norm 0.6566 (0.9732/0.2442)	mem 34630MB
[2025-11-20 09:13:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][200/2882]	eta 1:42:23 lr 0.000001	time 0.6207 (2.2908)	model_time 0.6205 (0.6249)	loss 0.2085 (0.2298)	grad_norm 1.1918 (0.9661/0.2492)	mem 34630MB
[2025-11-20 09:15:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][250/2882]	eta 1:39:37 lr 0.000001	time 0.6205 (2.2713)	model_time 0.6204 (0.6249)	loss 0.1953 (0.2300)	grad_norm 1.3726 (0.9614/0.2461)	mem 34630MB
[2025-11-20 09:17:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][300/2882]	eta 1:38:59 lr 0.000001	time 19.9238 (2.3003)	model_time 0.6242 (0.6244)	loss 0.2286 (0.2297)	grad_norm 1.0579 (0.9543/0.2425)	mem 34630MB
[2025-11-20 09:19:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][350/2882]	eta 1:36:06 lr 0.000001	time 1.3973 (2.2773)	model_time 0.6242 (0.6241)	loss 0.2219 (0.2303)	grad_norm 0.8173 (0.9554/0.2523)	mem 34630MB
[2025-11-20 09:20:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][400/2882]	eta 1:33:33 lr 0.000001	time 0.6233 (2.2618)	model_time 0.6231 (0.6242)	loss 0.2207 (0.2301)	grad_norm 0.9967 (0.9395/0.2457)	mem 34630MB
[2025-11-20 09:22:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][450/2882]	eta 1:31:02 lr 0.000001	time 0.6206 (2.2461)	model_time 0.6205 (0.6241)	loss 0.2325 (0.2304)	grad_norm 0.6231 (0.9447/0.2441)	mem 34630MB
[2025-11-20 09:24:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][500/2882]	eta 1:29:21 lr 0.000001	time 0.6214 (2.2510)	model_time 0.6213 (0.6238)	loss 0.2305 (0.2305)	grad_norm 0.7196 (0.9348/0.2377)	mem 34630MB
[2025-11-20 09:26:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][550/2882]	eta 1:27:22 lr 0.000001	time 0.6232 (2.2479)	model_time 0.6230 (0.6239)	loss 0.2342 (0.2306)	grad_norm 0.6525 (0.9177/0.2424)	mem 34630MB
[2025-11-20 09:28:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][600/2882]	eta 1:27:00 lr 0.000001	time 14.5114 (2.2878)	model_time 0.6207 (0.6237)	loss 0.2118 (0.2307)	grad_norm 0.9188 (0.9176/0.2669)	mem 34630MB
[2025-11-20 09:31:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][650/2882]	eta 1:26:46 lr 0.000001	time 16.3749 (2.3329)	model_time 0.6214 (0.6236)	loss 0.2270 (0.2309)	grad_norm 1.0605 (0.9181/0.2559)	mem 34630MB
[2025-11-20 09:33:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][700/2882]	eta 1:25:26 lr 0.000001	time 0.6195 (2.3496)	model_time 0.6194 (0.6234)	loss 0.2272 (0.2308)	grad_norm 1.5113 (0.9322/0.2613)	mem 34630MB
[2025-11-20 09:35:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][750/2882]	eta 1:23:42 lr 0.000001	time 0.6220 (2.3558)	model_time 0.6217 (0.6232)	loss 0.2174 (0.2311)	grad_norm 0.8740 (0.9343/0.2674)	mem 34630MB
[2025-11-20 09:37:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][800/2882]	eta 1:21:45 lr 0.000001	time 0.6232 (2.3563)	model_time 0.6230 (0.6231)	loss 0.2726 (0.2311)	grad_norm 1.1244 (0.9436/0.2844)	mem 34630MB
[2025-11-20 09:39:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][850/2882]	eta 1:19:56 lr 0.000001	time 0.6210 (2.3606)	model_time 0.6208 (0.6230)	loss 0.2354 (0.2312)	grad_norm 1.1479 (0.9576/0.2922)	mem 34630MB
[2025-11-20 09:41:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][900/2882]	eta 1:18:21 lr 0.000001	time 4.0715 (2.3721)	model_time 0.6201 (0.6229)	loss 0.2782 (0.2312)	grad_norm 1.4988 (0.9670/0.2725)	mem 34630MB
[2025-11-20 09:43:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][950/2882]	eta 1:17:13 lr 0.000001	time 20.1460 (2.3983)	model_time 0.6227 (0.6228)	loss 0.2152 (0.2311)	grad_norm 0.8045 (0.9506/0.2836)	mem 34630MB
[2025-11-20 09:46:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1000/2882]	eta 1:15:32 lr 0.000001	time 0.6197 (2.4084)	model_time 0.6195 (0.6227)	loss 0.2466 (0.2311)	grad_norm 1.2516 (0.9315/0.2834)	mem 34630MB
[2025-11-20 09:47:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1050/2882]	eta 1:13:16 lr 0.000001	time 0.6200 (2.3998)	model_time 0.6199 (0.6227)	loss 0.2208 (0.2310)	grad_norm 1.5745 (0.9235/0.2785)	mem 34630MB
[2025-11-20 09:49:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1100/2882]	eta 1:10:59 lr 0.000001	time 0.6194 (2.3903)	model_time 0.6192 (0.6226)	loss 0.2392 (0.2309)	grad_norm 0.5335 (0.9226/0.2612)	mem 34630MB
[2025-11-20 09:51:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1150/2882]	eta 1:09:00 lr 0.000001	time 0.6196 (2.3904)	model_time 0.6194 (0.6224)	loss 0.2243 (0.2311)	grad_norm 0.7319 (0.9210/0.2392)	mem 34630MB
[2025-11-20 09:53:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1200/2882]	eta 1:07:03 lr 0.000001	time 6.6470 (2.3921)	model_time 0.6234 (0.6223)	loss 0.2433 (0.2311)	grad_norm 0.8952 (0.9166/0.2434)	mem 34630MB
[2025-11-20 09:55:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1250/2882]	eta 1:05:12 lr 0.000001	time 11.9441 (2.3976)	model_time 0.6229 (0.6224)	loss 0.2477 (0.2310)	grad_norm 0.7336 (0.9086/0.2335)	mem 34630MB
[2025-11-20 09:57:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1300/2882]	eta 1:03:10 lr 0.000001	time 0.6230 (2.3961)	model_time 0.6228 (0.6224)	loss 0.2007 (0.2310)	grad_norm 0.6727 (0.9150/0.2340)	mem 34630MB
[2025-11-20 09:59:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1350/2882]	eta 1:01:11 lr 0.000001	time 0.6217 (2.3966)	model_time 0.6216 (0.6223)	loss 0.2409 (0.2311)	grad_norm 0.6982 (0.9244/0.2334)	mem 34630MB
[2025-11-20 10:01:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1400/2882]	eta 0:59:18 lr 0.000001	time 0.6215 (2.4009)	model_time 0.6213 (0.6224)	loss 0.2523 (0.2310)	grad_norm 0.8895 (0.9212/0.2363)	mem 34630MB
[2025-11-20 10:04:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1450/2882]	eta 0:57:46 lr 0.000001	time 0.6207 (2.4207)	model_time 0.6205 (0.6223)	loss 0.2426 (0.2312)	grad_norm 0.8234 (0.9346/0.2495)	mem 34630MB
[2025-11-20 10:06:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1500/2882]	eta 0:56:03 lr 0.000001	time 8.8708 (2.4338)	model_time 0.6203 (0.6222)	loss 0.2168 (0.2311)	grad_norm 1.0669 (0.9355/0.2455)	mem 34630MB
[2025-11-20 10:09:08 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1550/2882]	eta 0:54:20 lr 0.000001	time 9.8401 (2.4482)	model_time 0.6198 (0.6222)	loss 0.2213 (0.2311)	grad_norm 1.1287 (0.9423/0.2507)	mem 34630MB
[2025-11-20 10:11:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1600/2882]	eta 0:52:18 lr 0.000001	time 0.6259 (2.4478)	model_time 0.6256 (0.6222)	loss 0.1973 (0.2309)	grad_norm 0.7486 (0.9397/0.2416)	mem 34630MB
[2025-11-20 10:13:08 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1650/2882]	eta 0:50:12 lr 0.000001	time 0.6256 (2.4450)	model_time 0.6254 (0.6223)	loss 0.2297 (0.2309)	grad_norm 0.5925 (0.9313/0.2452)	mem 34630MB
[2025-11-20 10:15:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1700/2882]	eta 0:48:05 lr 0.000001	time 0.6223 (2.4412)	model_time 0.6221 (0.6223)	loss 0.2172 (0.2309)	grad_norm 0.8894 (0.9309/0.2423)	mem 34630MB
[2025-11-20 10:17:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1750/2882]	eta 0:46:02 lr 0.000001	time 0.6228 (2.4407)	model_time 0.6226 (0.6223)	loss 0.2165 (0.2308)	grad_norm 0.9468 (0.9138/0.2342)	mem 34630MB
[2025-11-20 10:19:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1800/2882]	eta 0:44:16 lr 0.000001	time 10.6671 (2.4549)	model_time 0.6213 (0.6222)	loss 0.2167 (0.2308)	grad_norm 1.1354 (0.9079/0.2289)	mem 34630MB
[2025-11-20 10:22:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1850/2882]	eta 0:42:32 lr 0.000001	time 5.9270 (2.4729)	model_time 0.6224 (0.6222)	loss 0.2335 (0.2308)	grad_norm 1.0015 (0.9094/0.2248)	mem 34630MB
[2025-11-20 10:24:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1900/2882]	eta 0:40:38 lr 0.000001	time 0.6189 (2.4832)	model_time 0.6188 (0.6222)	loss 0.2291 (0.2308)	grad_norm 0.8057 (0.9114/0.2241)	mem 34630MB
[2025-11-20 10:26:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][1950/2882]	eta 0:38:37 lr 0.000001	time 0.6192 (2.4868)	model_time 0.6190 (0.6222)	loss 0.2129 (0.2308)	grad_norm 1.0778 (0.9114/0.2220)	mem 34630MB
[2025-11-20 10:28:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2000/2882]	eta 0:36:34 lr 0.000001	time 0.6215 (2.4880)	model_time 0.6213 (0.6221)	loss 0.2280 (0.2309)	grad_norm 1.1905 (0.9232/0.2317)	mem 34630MB
[2025-11-20 10:31:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2050/2882]	eta 0:34:36 lr 0.000001	time 0.6219 (2.4956)	model_time 0.6218 (0.6221)	loss 0.1969 (0.2308)	grad_norm 1.1078 (0.9322/0.2414)	mem 34630MB
[2025-11-20 10:33:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2100/2882]	eta 0:32:44 lr 0.000001	time 2.4299 (2.5115)	model_time 0.6193 (0.6221)	loss 0.2342 (0.2308)	grad_norm 0.8695 (0.9324/0.2402)	mem 34630MB
[2025-11-20 10:36:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2150/2882]	eta 0:30:49 lr 0.000001	time 7.1705 (2.5267)	model_time 0.6193 (0.6221)	loss 0.2288 (0.2308)	grad_norm 0.7224 (0.9288/0.2494)	mem 34630MB
[2025-11-20 10:38:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2200/2882]	eta 0:28:44 lr 0.000001	time 0.6209 (2.5284)	model_time 0.6207 (0.6220)	loss 0.2076 (0.2308)	grad_norm 0.8833 (0.9389/0.2580)	mem 34630MB
[2025-11-20 10:40:47 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2250/2882]	eta 0:26:39 lr 0.000001	time 0.6185 (2.5303)	model_time 0.6184 (0.6220)	loss 0.2173 (0.2307)	grad_norm 1.1659 (0.9280/0.2553)	mem 34630MB
[2025-11-20 10:42:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2300/2882]	eta 0:24:32 lr 0.000001	time 0.6213 (2.5305)	model_time 0.6211 (0.6220)	loss 0.2076 (0.2308)	grad_norm 0.6677 (0.9297/0.2541)	mem 34630MB
[2025-11-20 10:45:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2350/2882]	eta 0:22:29 lr 0.000001	time 0.6177 (2.5358)	model_time 0.6175 (0.6219)	loss 0.2623 (0.2308)	grad_norm 1.2921 (0.9228/0.2446)	mem 34630MB
[2025-11-20 10:47:33 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2400/2882]	eta 0:20:24 lr 0.000001	time 7.3241 (2.5414)	model_time 0.6214 (0.6219)	loss 0.2301 (0.2307)	grad_norm 0.8398 (0.9316/0.2490)	mem 34630MB
[2025-11-20 10:50:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2450/2882]	eta 0:18:23 lr 0.000001	time 15.2006 (2.5540)	model_time 0.6210 (0.6219)	loss 0.1935 (0.2307)	grad_norm 0.7038 (0.9414/0.2345)	mem 34630MB
[2025-11-20 10:52:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2500/2882]	eta 0:16:16 lr 0.000001	time 0.6198 (2.5559)	model_time 0.6196 (0.6219)	loss 0.2069 (0.2307)	grad_norm 1.0500 (0.9389/0.2404)	mem 34630MB
[2025-11-20 10:54:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2550/2882]	eta 0:14:09 lr 0.000001	time 0.6201 (2.5583)	model_time 0.6200 (0.6219)	loss 0.2435 (0.2307)	grad_norm 1.2898 (0.9401/0.2389)	mem 34630MB
[2025-11-20 10:56:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2600/2882]	eta 0:12:02 lr 0.000001	time 0.6216 (2.5607)	model_time 0.6214 (0.6220)	loss 0.2273 (0.2307)	grad_norm 0.6440 (0.9275/0.2348)	mem 34630MB
[2025-11-20 10:59:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2650/2882]	eta 0:09:56 lr 0.000001	time 0.6237 (2.5711)	model_time 0.6235 (0.6220)	loss 0.2285 (0.2308)	grad_norm 0.6724 (0.9392/0.2454)	mem 34630MB
[2025-11-20 11:01:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2700/2882]	eta 0:07:48 lr 0.000001	time 0.6193 (2.5767)	model_time 0.6191 (0.6220)	loss 0.2765 (0.2308)	grad_norm 1.1424 (0.9322/0.2394)	mem 34630MB
[2025-11-20 11:04:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2750/2882]	eta 0:05:42 lr 0.000001	time 23.9185 (2.5924)	model_time 0.6211 (0.6219)	loss 0.2250 (0.2309)	grad_norm 0.6071 (0.9322/0.2492)	mem 34630MB
[2025-11-20 11:06:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2800/2882]	eta 0:03:32 lr 0.000001	time 0.6208 (2.5938)	model_time 0.6206 (0.6219)	loss 0.2368 (0.2309)	grad_norm 1.0244 (0.9365/0.2388)	mem 34630MB
[2025-11-20 11:09:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [15/20][2850/2882]	eta 0:01:22 lr 0.000001	time 0.6204 (2.5929)	model_time 0.6202 (0.6219)	loss 0.2267 (0.2308)	grad_norm 0.9036 (0.9518/0.2510)	mem 34630MB
[2025-11-20 11:10:10 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 15 training takes 2:04:18
[2025-11-20 11:10:10 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_15.pth saving......
[2025-11-20 11:10:11 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_15.pth saved !!!
[2025-11-20 11:10:44 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 32.304 (32.304)	Loss 0.2707 (0.2707)	Mem 34630MB
[2025-11-20 11:11:24 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:15] * Mean AUC-ROC 0.8102 Loss 0.2292
[2025-11-20 11:11:24 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:15] * Per-class AUC-ROC: ['0.8412', '0.8309', '0.8205', '0.9034', '0.7319', '0.5920', '0.7354', '0.7485', '0.8667', '0.9247', '0.7677', '0.7610', '0.8916', '0.9273']
[2025-11-20 11:11:24 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.8102
[2025-11-20 11:11:24 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-20 11:11:25 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-20 11:11:25 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.8102
[2025-11-20 11:11:35 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 9.818 (9.818)	Loss 0.2728 (0.2728)	Mem 34630MB
[2025-11-20 11:11:48 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:15] * Mean AUC-ROC 0.8081 Loss 0.2310
[2025-11-20 11:11:48 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:15] * Per-class AUC-ROC: ['0.8395', '0.8293', '0.8189', '0.9039', '0.7357', '0.5978', '0.7239', '0.7458', '0.8646', '0.9239', '0.7606', '0.7592', '0.8859', '0.9252']
[2025-11-20 11:11:48 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.8081
[2025-11-20 11:11:48 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-20 11:11:49 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-20 11:11:49 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.8081
[2025-11-20 11:12:22 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][0/2882]	eta 1 day, 2:20:32 lr 0.000001	time 32.9050 (32.9050)	model_time 0.6238 (0.6238)	loss 0.2360 (0.2360)	grad_norm 0.7899 (0.7899/0.0000)	mem 34630MB
[2025-11-20 11:14:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][50/2882]	eta 2:27:56 lr 0.000001	time 0.6223 (3.1342)	model_time 0.6222 (0.6206)	loss 0.2400 (0.2328)	grad_norm 1.1997 (0.9863/0.2607)	mem 34630MB
[2025-11-20 11:16:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][100/2882]	eta 2:11:36 lr 0.000001	time 0.6212 (2.8384)	model_time 0.6211 (0.6222)	loss 0.2493 (0.2304)	grad_norm 1.4875 (1.0070/0.2953)	mem 34630MB
[2025-11-20 11:18:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][150/2882]	eta 2:04:28 lr 0.000001	time 0.6203 (2.7337)	model_time 0.6201 (0.6218)	loss 0.2573 (0.2297)	grad_norm 1.6989 (0.9821/0.2879)	mem 34630MB
[2025-11-20 11:20:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][200/2882]	eta 2:00:09 lr 0.000001	time 0.6217 (2.6882)	model_time 0.6216 (0.6217)	loss 0.2263 (0.2293)	grad_norm 0.8164 (0.9863/0.2857)	mem 34630MB
[2025-11-20 11:23:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][250/2882]	eta 1:57:52 lr 0.000001	time 0.6186 (2.6873)	model_time 0.6185 (0.6215)	loss 0.2325 (0.2292)	grad_norm 0.8675 (0.9722/0.2781)	mem 34630MB
[2025-11-20 11:25:33 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][300/2882]	eta 1:57:47 lr 0.000001	time 15.2311 (2.7370)	model_time 0.6240 (0.6216)	loss 0.2404 (0.2293)	grad_norm 1.0058 (0.9809/0.2810)	mem 34630MB
[2025-11-20 11:28:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][350/2882]	eta 1:57:00 lr 0.000001	time 0.6243 (2.7729)	model_time 0.6241 (0.6220)	loss 0.2181 (0.2294)	grad_norm 0.7845 (0.9716/0.2823)	mem 34630MB
[2025-11-20 11:30:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][400/2882]	eta 1:53:33 lr 0.000001	time 0.6271 (2.7450)	model_time 0.6268 (0.6224)	loss 0.2299 (0.2299)	grad_norm 0.7087 (0.9553/0.2652)	mem 34630MB
[2025-11-20 11:32:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][450/2882]	eta 1:51:17 lr 0.000001	time 0.6273 (2.7455)	model_time 0.6271 (0.6227)	loss 0.2107 (0.2298)	grad_norm 0.9563 (0.9512/0.2564)	mem 34630MB
[2025-11-20 11:34:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][500/2882]	eta 1:48:32 lr 0.000001	time 0.6235 (2.7342)	model_time 0.6233 (0.6231)	loss 0.2487 (0.2302)	grad_norm 0.8976 (0.9315/0.2524)	mem 34630MB
[2025-11-20 11:36:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][550/2882]	eta 1:45:46 lr 0.000001	time 0.6253 (2.7214)	model_time 0.6251 (0.6232)	loss 0.2367 (0.2302)	grad_norm 1.2223 (0.9520/0.2757)	mem 34630MB
[2025-11-20 11:39:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][600/2882]	eta 1:43:55 lr 0.000001	time 6.0508 (2.7325)	model_time 0.6262 (0.6233)	loss 0.2058 (0.2302)	grad_norm 1.6737 (0.9507/0.2832)	mem 34630MB
[2025-11-20 11:41:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][650/2882]	eta 1:42:15 lr 0.000001	time 0.6264 (2.7491)	model_time 0.6262 (0.6236)	loss 0.2113 (0.2304)	grad_norm 1.1369 (0.9605/0.2799)	mem 34630MB
[2025-11-20 11:44:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][700/2882]	eta 1:40:44 lr 0.000001	time 0.6235 (2.7702)	model_time 0.6233 (0.6237)	loss 0.1911 (0.2304)	grad_norm 0.7064 (0.9687/0.2873)	mem 34630MB
[2025-11-20 11:46:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][750/2882]	eta 1:39:19 lr 0.000001	time 0.6256 (2.7952)	model_time 0.6253 (0.6238)	loss 0.2476 (0.2304)	grad_norm 1.3546 (0.9717/0.2892)	mem 34630MB
[2025-11-20 11:49:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][800/2882]	eta 1:37:29 lr 0.000001	time 0.6248 (2.8097)	model_time 0.6245 (0.6239)	loss 0.2345 (0.2304)	grad_norm 0.8047 (0.9846/0.2885)	mem 34630MB
[2025-11-20 11:51:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][850/2882]	eta 1:35:34 lr 0.000001	time 0.6239 (2.8220)	model_time 0.6237 (0.6239)	loss 0.2069 (0.2304)	grad_norm 0.7903 (0.9707/0.2714)	mem 34630MB
[2025-11-20 11:54:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][900/2882]	eta 1:33:44 lr 0.000001	time 7.4085 (2.8378)	model_time 0.6243 (0.6239)	loss 0.2161 (0.2305)	grad_norm 1.0908 (0.9597/0.2652)	mem 34630MB
[2025-11-20 11:56:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][950/2882]	eta 1:31:44 lr 0.000001	time 0.6230 (2.8490)	model_time 0.6227 (0.6241)	loss 0.2224 (0.2303)	grad_norm 1.0141 (0.9513/0.2709)	mem 34630MB
[2025-11-20 11:59:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1000/2882]	eta 1:29:11 lr 0.000001	time 0.6245 (2.8434)	model_time 0.6243 (0.6241)	loss 0.2269 (0.2303)	grad_norm 0.8939 (0.9461/0.2600)	mem 34630MB
[2025-11-20 12:01:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1050/2882]	eta 1:27:00 lr 0.000001	time 0.6247 (2.8497)	model_time 0.6245 (0.6241)	loss 0.2140 (0.2303)	grad_norm 1.0890 (0.9501/0.2625)	mem 34630MB
[2025-11-20 12:04:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1100/2882]	eta 1:24:28 lr 0.000001	time 0.6182 (2.8441)	model_time 0.6181 (0.6241)	loss 0.2197 (0.2302)	grad_norm 1.2340 (0.9432/0.2589)	mem 34630MB
[2025-11-20 12:06:25 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1150/2882]	eta 1:22:09 lr 0.000001	time 3.7642 (2.8459)	model_time 0.6194 (0.6239)	loss 0.2347 (0.2300)	grad_norm 1.6567 (0.9516/0.2593)	mem 34630MB
[2025-11-20 12:09:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1200/2882]	eta 1:20:05 lr 0.000001	time 19.8912 (2.8571)	model_time 0.6198 (0.6238)	loss 0.2612 (0.2302)	grad_norm 1.0935 (0.9535/0.2495)	mem 34630MB
[2025-11-20 12:11:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1250/2882]	eta 1:17:35 lr 0.000001	time 0.6209 (2.8528)	model_time 0.6207 (0.6237)	loss 0.2106 (0.2300)	grad_norm 1.0594 (0.9489/0.2485)	mem 34630MB
[2025-11-20 12:13:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1300/2882]	eta 1:15:05 lr 0.000001	time 0.6207 (2.8480)	model_time 0.6206 (0.6236)	loss 0.2396 (0.2300)	grad_norm 0.9819 (0.9542/0.2556)	mem 34630MB
[2025-11-20 12:16:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1350/2882]	eta 1:12:51 lr 0.000001	time 0.6201 (2.8537)	model_time 0.6200 (0.6235)	loss 0.2068 (0.2300)	grad_norm 0.5171 (0.9531/0.2637)	mem 34630MB
[2025-11-20 12:18:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1400/2882]	eta 1:10:37 lr 0.000001	time 0.6215 (2.8595)	model_time 0.6213 (0.6234)	loss 0.2333 (0.2300)	grad_norm 1.2603 (0.9576/0.2678)	mem 34630MB
[2025-11-20 12:21:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1450/2882]	eta 1:08:19 lr 0.000001	time 0.6792 (2.8628)	model_time 0.6790 (0.6233)	loss 0.2070 (0.2300)	grad_norm 1.3087 (0.9581/0.2711)	mem 34630MB
[2025-11-20 12:23:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1500/2882]	eta 1:06:04 lr 0.000001	time 9.2822 (2.8689)	model_time 0.6219 (0.6232)	loss 0.2592 (0.2301)	grad_norm 1.1839 (0.9659/0.2788)	mem 34630MB
[2025-11-20 12:25:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1550/2882]	eta 1:03:35 lr 0.000001	time 2.2220 (2.8643)	model_time 0.6207 (0.6231)	loss 0.1981 (0.2302)	grad_norm 1.3024 (0.9821/0.2889)	mem 34630MB
[2025-11-20 12:28:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1600/2882]	eta 1:01:15 lr 0.000001	time 0.6189 (2.8672)	model_time 0.6188 (0.6231)	loss 0.2029 (0.2301)	grad_norm 0.7576 (0.9755/0.2873)	mem 34630MB
[2025-11-20 12:31:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1650/2882]	eta 0:59:13 lr 0.000001	time 0.6192 (2.8843)	model_time 0.6191 (0.6230)	loss 0.2462 (0.2301)	grad_norm 1.0191 (0.9728/0.2763)	mem 34630MB
[2025-11-20 12:34:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1700/2882]	eta 0:57:09 lr 0.000001	time 0.6208 (2.9018)	model_time 0.6206 (0.6230)	loss 0.2403 (0.2303)	grad_norm 0.6525 (0.9665/0.2821)	mem 34630MB
[2025-11-20 12:36:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1750/2882]	eta 0:54:58 lr 0.000001	time 0.6206 (2.9140)	model_time 0.6205 (0.6230)	loss 0.2150 (0.2302)	grad_norm 1.0807 (0.9583/0.2740)	mem 34630MB
[2025-11-20 12:39:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1800/2882]	eta 0:52:56 lr 0.000001	time 13.6463 (2.9359)	model_time 0.6211 (0.6230)	loss 0.2334 (0.2302)	grad_norm 0.7953 (0.9506/0.2690)	mem 34630MB
[2025-11-20 12:42:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1850/2882]	eta 0:50:37 lr 0.000001	time 1.0332 (2.9432)	model_time 0.6204 (0.6229)	loss 0.2250 (0.2302)	grad_norm 0.8137 (0.9388/0.2501)	mem 34630MB
[2025-11-20 12:45:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1900/2882]	eta 0:48:09 lr 0.000001	time 0.6218 (2.9426)	model_time 0.6217 (0.6228)	loss 0.2487 (0.2302)	grad_norm 0.6600 (0.9292/0.2452)	mem 34630MB
[2025-11-20 12:47:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][1950/2882]	eta 0:45:47 lr 0.000001	time 0.6201 (2.9477)	model_time 0.6200 (0.6228)	loss 0.2288 (0.2303)	grad_norm 0.5931 (0.9358/0.2551)	mem 34630MB
[2025-11-20 12:50:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2000/2882]	eta 0:43:20 lr 0.000001	time 0.6217 (2.9486)	model_time 0.6216 (0.6228)	loss 0.2527 (0.2302)	grad_norm 0.7733 (0.9402/0.2449)	mem 34630MB
[2025-11-20 12:52:33 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2050/2882]	eta 0:40:51 lr 0.000001	time 0.6229 (2.9469)	model_time 0.6227 (0.6228)	loss 0.1993 (0.2301)	grad_norm 0.8044 (0.9255/0.2479)	mem 34630MB
[2025-11-20 12:54:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2100/2882]	eta 0:38:20 lr 0.000001	time 0.6192 (2.9417)	model_time 0.6191 (0.6228)	loss 0.2298 (0.2302)	grad_norm 0.6922 (0.9202/0.2407)	mem 34630MB
[2025-11-20 12:57:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2150/2882]	eta 0:35:55 lr 0.000001	time 9.7971 (2.9451)	model_time 0.6208 (0.6227)	loss 0.2574 (0.2303)	grad_norm 1.1963 (0.9259/0.2415)	mem 34630MB
[2025-11-20 12:59:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2200/2882]	eta 0:33:26 lr 0.000001	time 0.6223 (2.9425)	model_time 0.6221 (0.6226)	loss 0.2418 (0.2303)	grad_norm 1.0999 (0.9334/0.2460)	mem 34630MB
[2025-11-20 13:02:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2250/2882]	eta 0:30:58 lr 0.000001	time 0.6181 (2.9411)	model_time 0.6179 (0.6226)	loss 0.2153 (0.2303)	grad_norm 0.7735 (0.9368/0.2434)	mem 34630MB
[2025-11-20 13:04:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2300/2882]	eta 0:28:31 lr 0.000001	time 0.6218 (2.9412)	model_time 0.6216 (0.6226)	loss 0.1895 (0.2302)	grad_norm 1.2450 (0.9411/0.2382)	mem 34630MB
[2025-11-20 13:06:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2350/2882]	eta 0:26:02 lr 0.000001	time 0.6212 (2.9371)	model_time 0.6210 (0.6225)	loss 0.2351 (0.2303)	grad_norm 1.0016 (0.9575/0.2364)	mem 34630MB
[2025-11-20 13:09:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2400/2882]	eta 0:23:34 lr 0.000001	time 0.6217 (2.9349)	model_time 0.6216 (0.6225)	loss 0.2411 (0.2304)	grad_norm 1.7752 (0.9714/0.2432)	mem 34630MB
[2025-11-20 13:11:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2450/2882]	eta 0:21:10 lr 0.000001	time 13.8658 (2.9413)	model_time 0.6192 (0.6225)	loss 0.2538 (0.2304)	grad_norm 0.8674 (0.9668/0.2381)	mem 34630MB
[2025-11-20 13:14:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2500/2882]	eta 0:18:43 lr 0.000001	time 0.6209 (2.9408)	model_time 0.6207 (0.6224)	loss 0.2253 (0.2304)	grad_norm 0.8700 (0.9623/0.2372)	mem 34630MB
[2025-11-20 13:16:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2550/2882]	eta 0:16:16 lr 0.000001	time 0.6189 (2.9407)	model_time 0.6187 (0.6224)	loss 0.2329 (0.2304)	grad_norm 0.8824 (0.9582/0.2293)	mem 34630MB
[2025-11-20 13:19:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2600/2882]	eta 0:13:50 lr 0.000001	time 0.6217 (2.9457)	model_time 0.6216 (0.6224)	loss 0.2303 (0.2304)	grad_norm 0.9109 (0.9540/0.2263)	mem 34630MB
[2025-11-20 13:22:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2650/2882]	eta 0:11:23 lr 0.000001	time 0.6198 (2.9475)	model_time 0.6197 (0.6224)	loss 0.2432 (0.2304)	grad_norm 1.3179 (0.9522/0.2240)	mem 34630MB
[2025-11-20 13:24:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2700/2882]	eta 0:08:56 lr 0.000001	time 0.6215 (2.9487)	model_time 0.6214 (0.6223)	loss 0.2099 (0.2304)	grad_norm 1.0123 (0.9467/0.2264)	mem 34630MB
[2025-11-20 13:27:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2750/2882]	eta 0:06:29 lr 0.000001	time 1.9677 (2.9499)	model_time 0.6204 (0.6223)	loss 0.2400 (0.2304)	grad_norm 1.0437 (0.9488/0.2327)	mem 34630MB
[2025-11-20 13:29:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2800/2882]	eta 0:04:01 lr 0.000001	time 0.6215 (2.9497)	model_time 0.6214 (0.6223)	loss 0.2521 (0.2304)	grad_norm 0.9057 (0.9551/0.2343)	mem 34630MB
[2025-11-20 13:32:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [16/20][2850/2882]	eta 0:01:34 lr 0.000001	time 0.6187 (2.9538)	model_time 0.6186 (0.6223)	loss 0.2436 (0.2304)	grad_norm 1.1001 (0.9417/0.2385)	mem 34630MB
[2025-11-20 13:33:42 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 16 training takes 2:21:52
[2025-11-20 13:33:42 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_16.pth saving......
[2025-11-20 13:33:44 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_16.pth saved !!!
[2025-11-20 13:34:23 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 39.369 (39.369)	Loss 0.2699 (0.2699)	Mem 34630MB
[2025-11-20 13:35:09 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:16] * Mean AUC-ROC 0.8107 Loss 0.2290
[2025-11-20 13:35:09 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:16] * Per-class AUC-ROC: ['0.8409', '0.8310', '0.8220', '0.9036', '0.7342', '0.5972', '0.7290', '0.7492', '0.8672', '0.9244', '0.7699', '0.7616', '0.8923', '0.9272']
[2025-11-20 13:35:09 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.8107
[2025-11-20 13:35:09 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-20 13:35:11 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-20 13:35:11 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.8107
[2025-11-20 13:35:20 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 8.922 (8.922)	Loss 0.2725 (0.2725)	Mem 34630MB
[2025-11-20 13:35:33 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:16] * Mean AUC-ROC 0.8089 Loss 0.2305
[2025-11-20 13:35:33 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:16] * Per-class AUC-ROC: ['0.8399', '0.8298', '0.8195', '0.9040', '0.7352', '0.5991', '0.7256', '0.7465', '0.8652', '0.9241', '0.7624', '0.7597', '0.8880', '0.9258']
[2025-11-20 13:35:33 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.8089
[2025-11-20 13:35:33 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-20 13:35:35 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-20 13:35:35 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.8089
[2025-11-20 13:36:17 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][0/2882]	eta 1 day, 9:26:40 lr 0.000001	time 41.7766 (41.7766)	model_time 0.6193 (0.6193)	loss 0.2120 (0.2120)	grad_norm 0.9524 (0.9524/0.0000)	mem 34630MB
[2025-11-20 13:38:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][50/2882]	eta 2:56:29 lr 0.000001	time 0.6180 (3.7394)	model_time 0.6179 (0.6201)	loss 0.2239 (0.2288)	grad_norm 0.7660 (0.8920/0.1815)	mem 34630MB
[2025-11-20 13:41:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][100/2882]	eta 2:38:55 lr 0.000001	time 0.6216 (3.4276)	model_time 0.6215 (0.6197)	loss 0.2357 (0.2294)	grad_norm 1.2925 (0.9408/0.2291)	mem 34630MB
[2025-11-20 13:43:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][150/2882]	eta 2:29:11 lr 0.000001	time 0.6186 (3.2765)	model_time 0.6184 (0.6197)	loss 0.2266 (0.2296)	grad_norm 0.7402 (0.9633/0.2603)	mem 34630MB
[2025-11-20 13:46:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][200/2882]	eta 2:23:47 lr 0.000001	time 0.6211 (3.2167)	model_time 0.6210 (0.6199)	loss 0.2131 (0.2299)	grad_norm 0.9530 (0.9579/0.2698)	mem 34630MB
[2025-11-20 13:48:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][250/2882]	eta 2:18:59 lr 0.000001	time 0.6219 (3.1685)	model_time 0.6217 (0.6202)	loss 0.2422 (0.2304)	grad_norm 1.5133 (0.9590/0.2791)	mem 34630MB
[2025-11-20 13:51:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][300/2882]	eta 2:20:28 lr 0.000001	time 31.1830 (3.2645)	model_time 0.6203 (0.6202)	loss 0.2176 (0.2309)	grad_norm 1.0929 (0.9593/0.2737)	mem 34630MB
[2025-11-20 13:54:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][350/2882]	eta 2:16:37 lr 0.000001	time 0.6255 (3.2376)	model_time 0.6253 (0.6209)	loss 0.2386 (0.2307)	grad_norm 1.1858 (0.9684/0.2884)	mem 34630MB
[2025-11-20 13:57:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][400/2882]	eta 2:12:47 lr 0.000001	time 0.6204 (3.2101)	model_time 0.6203 (0.6209)	loss 0.2386 (0.2309)	grad_norm 0.7562 (0.9639/0.2816)	mem 34630MB
[2025-11-20 13:59:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][450/2882]	eta 2:09:51 lr 0.000001	time 0.6234 (3.2039)	model_time 0.6232 (0.6209)	loss 0.2353 (0.2311)	grad_norm 0.7468 (0.9481/0.2640)	mem 34630MB
[2025-11-20 14:02:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][500/2882]	eta 2:07:17 lr 0.000001	time 0.6190 (3.2062)	model_time 0.6189 (0.6211)	loss 0.2818 (0.2312)	grad_norm 1.1923 (0.9532/0.2663)	mem 34630MB
[2025-11-20 14:04:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][550/2882]	eta 2:04:24 lr 0.000001	time 0.6230 (3.2008)	model_time 0.6227 (0.6211)	loss 0.2263 (0.2314)	grad_norm 0.9757 (0.9576/0.2587)	mem 34630MB
[2025-11-20 14:07:48 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][600/2882]	eta 2:02:18 lr 0.000001	time 24.0143 (3.2160)	model_time 0.6214 (0.6215)	loss 0.2510 (0.2313)	grad_norm 0.9229 (0.9517/0.2590)	mem 34630MB
[2025-11-20 14:10:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][650/2882]	eta 1:59:31 lr 0.000001	time 0.6228 (3.2130)	model_time 0.6226 (0.6214)	loss 0.2359 (0.2314)	grad_norm 1.0136 (0.9433/0.2479)	mem 34630MB
[2025-11-20 14:12:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][700/2882]	eta 1:56:20 lr 0.000001	time 0.6215 (3.1991)	model_time 0.6213 (0.6214)	loss 0.2429 (0.2314)	grad_norm 1.1746 (0.9529/0.2599)	mem 34630MB
[2025-11-20 14:15:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][750/2882]	eta 1:53:14 lr 0.000001	time 1.4115 (3.1870)	model_time 0.6211 (0.6213)	loss 0.2237 (0.2313)	grad_norm 0.9376 (0.9606/0.2676)	mem 34630MB
[2025-11-20 14:17:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][800/2882]	eta 1:50:00 lr 0.000001	time 0.6186 (3.1702)	model_time 0.6185 (0.6212)	loss 0.2351 (0.2311)	grad_norm 0.6432 (0.9500/0.2607)	mem 34630MB
[2025-11-20 14:20:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][850/2882]	eta 1:46:46 lr 0.000001	time 0.6189 (3.1530)	model_time 0.6187 (0.6212)	loss 0.2203 (0.2310)	grad_norm 1.0018 (0.9446/0.2531)	mem 34630MB
[2025-11-20 14:23:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][900/2882]	eta 1:44:42 lr 0.000001	time 22.8241 (3.1700)	model_time 0.6217 (0.6211)	loss 0.2457 (0.2313)	grad_norm 0.6534 (0.9524/0.2645)	mem 34630MB
[2025-11-20 14:25:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][950/2882]	eta 1:41:44 lr 0.000001	time 0.6240 (3.1598)	model_time 0.6238 (0.6210)	loss 0.2173 (0.2311)	grad_norm 0.8073 (0.9568/0.2671)	mem 34630MB
[2025-11-20 14:28:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1000/2882]	eta 1:38:58 lr 0.000001	time 0.6251 (3.1555)	model_time 0.6248 (0.6213)	loss 0.2837 (0.2312)	grad_norm 1.5060 (0.9462/0.2619)	mem 34630MB
[2025-11-20 14:30:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1050/2882]	eta 1:36:34 lr 0.000001	time 13.0891 (3.1631)	model_time 0.6239 (0.6214)	loss 0.2444 (0.2311)	grad_norm 0.9996 (0.9469/0.2711)	mem 34630MB
[2025-11-20 14:33:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1100/2882]	eta 1:33:47 lr 0.000001	time 0.6225 (3.1582)	model_time 0.6223 (0.6215)	loss 0.2547 (0.2311)	grad_norm 0.8375 (0.9420/0.2689)	mem 34630MB
[2025-11-20 14:35:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1150/2882]	eta 1:30:53 lr 0.000001	time 0.6231 (3.1484)	model_time 0.6228 (0.6217)	loss 0.2431 (0.2309)	grad_norm 0.6456 (0.9308/0.2705)	mem 34630MB
[2025-11-20 14:38:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1200/2882]	eta 1:28:33 lr 0.000001	time 14.8597 (3.1593)	model_time 0.6234 (0.6218)	loss 0.2048 (0.2309)	grad_norm 1.2523 (0.9326/0.2555)	mem 34630MB
[2025-11-20 14:41:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1250/2882]	eta 1:26:20 lr 0.000001	time 0.6259 (3.1741)	model_time 0.6257 (0.6219)	loss 0.2336 (0.2308)	grad_norm 0.8501 (0.9357/0.2605)	mem 34630MB
[2025-11-20 14:44:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1300/2882]	eta 1:23:43 lr 0.000001	time 0.6240 (3.1756)	model_time 0.6237 (0.6221)	loss 0.2424 (0.2308)	grad_norm 0.8848 (0.9333/0.2580)	mem 34630MB
[2025-11-20 14:47:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1350/2882]	eta 1:21:15 lr 0.000001	time 11.9925 (3.1824)	model_time 0.6241 (0.6222)	loss 0.2256 (0.2309)	grad_norm 1.1263 (0.9284/0.2475)	mem 34630MB
[2025-11-20 14:49:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1400/2882]	eta 1:18:24 lr 0.000001	time 0.6250 (3.1745)	model_time 0.6249 (0.6223)	loss 0.2262 (0.2309)	grad_norm 0.9427 (0.9405/0.2433)	mem 34630MB
[2025-11-20 14:52:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1450/2882]	eta 1:15:40 lr 0.000001	time 0.6179 (3.1706)	model_time 0.6177 (0.6224)	loss 0.2305 (0.2308)	grad_norm 1.3401 (0.9403/0.2412)	mem 34630MB
[2025-11-20 14:54:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1500/2882]	eta 1:12:59 lr 0.000001	time 0.6261 (3.1687)	model_time 0.6259 (0.6223)	loss 0.2486 (0.2307)	grad_norm 1.8222 (0.9334/0.2494)	mem 34630MB
[2025-11-20 14:57:45 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1550/2882]	eta 1:10:33 lr 0.000001	time 0.6254 (3.1785)	model_time 0.6252 (0.6224)	loss 0.2459 (0.2308)	grad_norm 1.0918 (0.9289/0.2423)	mem 34630MB
[2025-11-20 15:00:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1600/2882]	eta 1:07:47 lr 0.000001	time 0.6254 (3.1728)	model_time 0.6252 (0.6226)	loss 0.2436 (0.2307)	grad_norm 0.7990 (0.9291/0.2448)	mem 34630MB
[2025-11-20 15:02:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1650/2882]	eta 1:05:13 lr 0.000001	time 11.9965 (3.1765)	model_time 0.6235 (0.6226)	loss 0.2180 (0.2306)	grad_norm 0.7296 (0.9251/0.2411)	mem 34630MB
[2025-11-20 15:05:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1700/2882]	eta 1:02:28 lr 0.000001	time 0.6178 (3.1715)	model_time 0.6177 (0.6226)	loss 0.2026 (0.2305)	grad_norm 0.6088 (0.9297/0.2462)	mem 34630MB
[2025-11-20 15:08:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1750/2882]	eta 0:59:47 lr 0.000001	time 0.6178 (3.1689)	model_time 0.6176 (0.6225)	loss 0.1902 (0.2304)	grad_norm 0.7313 (0.9261/0.2519)	mem 34630MB
[2025-11-20 15:10:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1800/2882]	eta 0:57:09 lr 0.000001	time 6.3505 (3.1692)	model_time 0.6225 (0.6225)	loss 0.2304 (0.2304)	grad_norm 0.8107 (0.9250/0.2533)	mem 34630MB
[2025-11-20 15:13:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1850/2882]	eta 0:54:34 lr 0.000001	time 0.6206 (3.1729)	model_time 0.6205 (0.6224)	loss 0.2233 (0.2304)	grad_norm 0.9676 (0.9268/0.2559)	mem 34630MB
[2025-11-20 16:28:57 internimage_b_mimic_cxr_224] (main.py 729): INFO Full config saved to output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/config.json
[2025-11-20 16:28:57 internimage_b_mimic_cxr_224] (main.py 732): INFO AMP_OPT_LEVEL: O1
AMP_TYPE: float16
AUG:
  AUTO_AUGMENT: none
  COLOR_JITTER: 0.0
  CUTMIX: 0.0
  CUTMIX_MINMAX: null
  MEAN:
  - 0.485
  - 0.456
  - 0.406
  MIXUP: 0.0
  MIXUP_MODE: batch
  MIXUP_PROB: 0.0
  MIXUP_SWITCH_PROB: 0.0
  RANDOM_RESIZED_CROP: false
  RECOUNT: 1
  REMODE: pixel
  REPROB: 0.1
  STD:
  - 0.229
  - 0.224
  - 0.225
BASE:
- ''
DATA:
  BATCH_SIZE: 128
  CACHE_MODE: part
  DATASET: mimic_cxr
  DATA_PATH: /scratch/smehta90/mimic_splits
  IMG_ON_MEMORY: false
  IMG_SIZE: 224
  INTERPOLATION: bicubic
  NUM_WORKERS: 12
  PIN_MEMORY: true
  ZIP_MODE: false
EVAL_22K_TO_1K: false
EVAL_FREQ: 1
EVAL_MODE: false
LOCAL_RANK: 0
MODEL:
  DROP_PATH_RATE: 0.5
  DROP_PATH_TYPE: linear
  DROP_RATE: 0.0
  INTERN_IMAGE:
    CENTER_FEATURE_SCALE: false
    CHANNELS: 112
    CORE_OP: DCNv3
    DEPTHS:
    - 4
    - 4
    - 21
    - 4
    DW_KERNEL_SIZE: null
    GROUPS:
    - 7
    - 14
    - 28
    - 56
    LAYER_SCALE: 1.0e-05
    LEVEL2_POST_NORM: false
    LEVEL2_POST_NORM_BLOCK_IDS: null
    MLP_RATIO: 4.0
    OFFSET_SCALE: 1.0
    POST_NORM: true
    REMOVE_CENTER: false
    RES_POST_NORM: false
    USE_CLIP_PROJECTOR: false
  LABEL_SMOOTHING: 0.0
  NAME: internimage_b_mimic_cxr_224
  NUM_CLASSES: 14
  PRETRAINED: pretrained/internimage_b_1k_224.pth
  RESUME: ''
  TYPE: intern_image
OUTPUT: output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224
PRINT_FREQ: 50
SAVE_CKPT_NUM: 1
SAVE_FREQ: 1
SEED: 42
TAG: run1
TEST:
  CROP: true
  SEQUENTIAL: false
THROUGHPUT_MODE: false
TRAIN:
  ACCUMULATION_STEPS: 1
  AUTO_RESUME: true
  BASE_LR: 0.0001
  CLIP_GRAD: 5.0
  EMA:
    DECAY: 0.9999
    ENABLE: true
  EPOCHS: 20
  LR_LAYER_DECAY: true
  LR_LAYER_DECAY_RATIO: 0.875
  LR_SCHEDULER:
    DECAY_EPOCHS: 30
    DECAY_RATE: 0.1
    NAME: cosine
  MIN_LR: 1.0e-06
  OPTIMIZER:
    BETAS:
    - 0.9
    - 0.999
    DCN_LR_MUL: null
    EPS: 1.0e-08
    FREEZE_BACKBONE: null
    MOMENTUM: 0.9
    NAME: adamw
    USE_ZERO: false
  RAND_INIT_FT_HEAD: true
  START_EPOCH: 0
  USE_CHECKPOINT: false
  WARMUP_EPOCHS: 2
  WARMUP_LR: 5.0e-07
  WEIGHT_DECAY: 0.05

[2025-11-20 16:28:59 internimage_b_mimic_cxr_224] (main.py 175): INFO Creating model:intern_image/internimage_b_mimic_cxr_224
[2025-11-20 16:29:00 internimage_b_mimic_cxr_224] (main.py 178): INFO InternImage(
  (patch_embed): StemLayer(
    (conv1): Conv2d(3, 56, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm1): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((56,), eps=1e-06, elementwise_affine=True)
      (2): to_channels_first()
    )
    (act): GELU(approximate='none')
    (conv2): Conv2d(56, 112, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm2): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
    )
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (levels): ModuleList(
    (0): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): Identity()
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.016)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.031)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.047)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (1): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.062)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.078)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.094)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.109)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (2): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.125)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.141)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.156)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.172)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (4): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.188)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (5): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.203)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (6): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.219)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (7): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.234)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (8): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.250)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (9): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.266)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (10): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.281)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (11): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.297)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (12): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.312)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (13): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.328)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (14): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.344)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (15): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.359)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (16): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.375)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (17): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.391)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (18): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.406)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (19): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.422)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (20): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.438)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(448, 896, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (3): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.453)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.469)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.484)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.500)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (conv_head): Sequential(
    (0): Conv2d(896, 1344, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (1): Sequential(
      (0): BatchNorm2d(1344, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): GELU(approximate='none')
  )
  (head): Linear(in_features=1344, out_features=14, bias=True)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
[2025-11-20 16:29:00 internimage_b_mimic_cxr_224] (main.py 214): INFO Using native Torch AMP. Training in mixed precision.
[2025-11-20 16:29:01 internimage_b_mimic_cxr_224] (main.py 226): INFO using fp16_compress_hook!
[2025-11-20 16:29:01 internimage_b_mimic_cxr_224] (main.py 234): INFO number of params: 96135662
[2025-11-20 16:29:01 internimage_b_mimic_cxr_224] (main.py 247): INFO Using BCEWithLogitsLoss for multi-label classification
[2025-11-20 16:29:01 internimage_b_mimic_cxr_224] (main.py 270): INFO auto resuming from output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_16.pth
[2025-11-20 16:29:01 internimage_b_mimic_cxr_224] (utils.py 60): INFO ==============> Resuming form output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_16.pth....................
[2025-11-20 16:29:04 internimage_b_mimic_cxr_224] (utils.py 92): INFO <All keys matched successfully>
[2025-11-20 16:29:04 internimage_b_mimic_cxr_224] (utils.py 110): INFO => loaded successfully output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_16.pth (epoch 16)
[2025-11-20 16:30:00 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 56.109 (56.109)	Loss 0.2699 (0.2699)	Mem 4564MB
[2025-11-20 16:30:56 internimage_b_mimic_cxr_224] (utils_multilabel.py 141): INFO  * Mean AUC-ROC 0.8107 Loss 0.2290
[2025-11-20 16:30:56 internimage_b_mimic_cxr_224] (utils_multilabel.py 142): INFO  * Per-class AUC-ROC: ['0.8409', '0.8310', '0.8220', '0.9036', '0.7342', '0.5972', '0.7290', '0.7492', '0.8672', '0.9244', '0.7699', '0.7616', '0.8923', '0.9272']
[2025-11-20 16:30:56 internimage_b_mimic_cxr_224] (main.py 283): INFO AUC-ROC of the network on the 2991 val images: 0.8107
[2025-11-20 16:30:56 internimage_b_mimic_cxr_224] (utils.py 24): INFO ==============> Resuming form output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_16.pth....................
[2025-11-20 16:30:59 internimage_b_mimic_cxr_224] (utils.py 44): INFO <All keys matched successfully>
[2025-11-20 16:30:59 internimage_b_mimic_cxr_224] (utils.py 45): INFO Loaded state_dict_ema
[2025-11-20 16:31:10 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 10.909 (10.909)	Loss 0.2725 (0.2725)	Mem 4564MB
[2025-11-20 16:31:23 internimage_b_mimic_cxr_224] (utils_multilabel.py 141): INFO  * Mean AUC-ROC 0.8089 Loss 0.2305
[2025-11-20 16:31:23 internimage_b_mimic_cxr_224] (utils_multilabel.py 142): INFO  * Per-class AUC-ROC: ['0.8399', '0.8298', '0.8195', '0.9040', '0.7352', '0.5991', '0.7256', '0.7465', '0.8652', '0.9241', '0.7624', '0.7597', '0.8880', '0.9258']
[2025-11-20 16:31:23 internimage_b_mimic_cxr_224] (main.py 315): INFO AUC-ROC of the ema network on the 2991 val images: 0.8089
[2025-11-20 16:31:23 internimage_b_mimic_cxr_224] (main.py 331): INFO Start training
[2025-11-20 16:32:33 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][0/2882]	eta 2 days, 7:38:04 lr 0.000001	time 69.4949 (69.4949)	model_time 18.0867 (18.0867)	loss 0.2189 (0.2189)	grad_norm 0.7153 (0.7153/0.0000)	mem 34249MB
[2025-11-20 16:35:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][50/2882]	eta 3:28:43 lr 0.000001	time 0.6251 (4.4222)	model_time 0.6249 (0.9648)	loss 0.2255 (0.2296)	grad_norm 0.9766 (0.9364/0.2423)	mem 34631MB
[2025-11-20 16:38:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][100/2882]	eta 3:08:31 lr 0.000001	time 3.9561 (4.0659)	model_time 0.6234 (0.7956)	loss 0.2289 (0.2298)	grad_norm 0.7124 (0.9214/0.2197)	mem 34631MB
[2025-11-20 16:41:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][150/2882]	eta 2:58:12 lr 0.000001	time 6.7440 (3.9139)	model_time 0.6231 (0.7394)	loss 0.2319 (0.2299)	grad_norm 1.0972 (0.9305/0.2099)	mem 34631MB
[2025-11-20 16:44:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][200/2882]	eta 2:52:31 lr 0.000001	time 5.9715 (3.8597)	model_time 0.6222 (0.7099)	loss 0.2112 (0.2303)	grad_norm 0.7758 (0.9258/0.2239)	mem 34631MB
[2025-11-20 16:46:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][250/2882]	eta 2:41:50 lr 0.000001	time 0.6226 (3.6895)	model_time 0.6224 (0.6931)	loss 0.2456 (0.2307)	grad_norm 0.9653 (0.9177/0.2228)	mem 34631MB
[2025-11-20 16:49:44 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][300/2882]	eta 2:37:21 lr 0.000001	time 20.5373 (3.6567)	model_time 0.6238 (0.6816)	loss 0.2228 (0.2311)	grad_norm 1.3159 (0.9277/0.2327)	mem 34631MB
[2025-11-20 16:52:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][350/2882]	eta 2:30:01 lr 0.000001	time 0.6220 (3.5551)	model_time 0.6219 (0.6733)	loss 0.2442 (0.2309)	grad_norm 1.4119 (0.9310/0.2224)	mem 34631MB
[2025-11-20 16:54:49 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][400/2882]	eta 2:25:04 lr 0.000001	time 0.6233 (3.5070)	model_time 0.6231 (0.6669)	loss 0.2412 (0.2312)	grad_norm 0.8816 (0.9294/0.2331)	mem 34631MB
[2025-11-20 16:57:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][450/2882]	eta 2:20:15 lr 0.000001	time 0.6220 (3.4604)	model_time 0.6218 (0.6619)	loss 0.2279 (0.2315)	grad_norm 1.0832 (0.9260/0.2421)	mem 34631MB
[2025-11-20 16:59:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][500/2882]	eta 2:15:45 lr 0.000001	time 1.1174 (3.4198)	model_time 0.6225 (0.6580)	loss 0.2776 (0.2315)	grad_norm 1.6382 (0.9308/0.2397)	mem 34631MB
[2025-11-20 17:02:30 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][550/2882]	eta 2:11:40 lr 0.000001	time 0.6252 (3.3877)	model_time 0.6250 (0.6548)	loss 0.2307 (0.2316)	grad_norm 1.4766 (0.9398/0.2451)	mem 34631MB
[2025-11-20 17:05:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][600/2882]	eta 2:10:02 lr 0.000001	time 31.5401 (3.4194)	model_time 0.6245 (0.6522)	loss 0.2547 (0.2315)	grad_norm 0.8926 (0.9315/0.2399)	mem 34631MB
[2025-11-20 17:08:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][650/2882]	eta 2:06:25 lr 0.000001	time 0.6195 (3.3985)	model_time 0.6193 (0.6501)	loss 0.2440 (0.2315)	grad_norm 1.2175 (0.9290/0.2483)	mem 34631MB
[2025-11-20 17:10:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][700/2882]	eta 2:02:49 lr 0.000001	time 0.6232 (3.3776)	model_time 0.6230 (0.6480)	loss 0.2498 (0.2315)	grad_norm 1.5386 (0.9395/0.2566)	mem 34631MB
[2025-11-20 17:13:18 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][750/2882]	eta 1:59:00 lr 0.000001	time 0.6227 (3.3493)	model_time 0.6225 (0.6463)	loss 0.2248 (0.2314)	grad_norm 1.3895 (0.9363/0.2545)	mem 34631MB
[2025-11-20 17:15:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][800/2882]	eta 1:55:49 lr 0.000001	time 0.6215 (3.3381)	model_time 0.6213 (0.6450)	loss 0.2300 (0.2311)	grad_norm 0.9650 (0.9304/0.2603)	mem 34631MB
[2025-11-20 17:18:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][850/2882]	eta 1:53:26 lr 0.000001	time 0.6226 (3.3498)	model_time 0.6225 (0.6437)	loss 0.2249 (0.2311)	grad_norm 1.1645 (0.9385/0.2670)	mem 34631MB
[2025-11-20 17:22:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][900/2882]	eta 1:51:44 lr 0.000001	time 31.1960 (3.3825)	model_time 0.6231 (0.6425)	loss 0.2485 (0.2313)	grad_norm 0.9338 (0.9516/0.2726)	mem 34631MB
[2025-11-20 17:24:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][950/2882]	eta 1:48:39 lr 0.000001	time 0.6228 (3.3746)	model_time 0.6226 (0.6415)	loss 0.2294 (0.2311)	grad_norm 0.6763 (0.9527/0.2794)	mem 34631MB
[2025-11-20 17:27:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1000/2882]	eta 1:45:59 lr 0.000001	time 0.6225 (3.3792)	model_time 0.6223 (0.6407)	loss 0.2802 (0.2312)	grad_norm 1.0833 (0.9503/0.2687)	mem 34631MB
[2025-11-20 17:30:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1050/2882]	eta 1:42:56 lr 0.000001	time 0.6218 (3.3713)	model_time 0.6217 (0.6398)	loss 0.2391 (0.2311)	grad_norm 1.3257 (0.9609/0.2793)	mem 34631MB
[2025-11-20 17:33:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1100/2882]	eta 1:39:43 lr 0.000001	time 0.6226 (3.3576)	model_time 0.6224 (0.6390)	loss 0.2576 (0.2311)	grad_norm 0.9546 (0.9636/0.2695)	mem 34631MB
[2025-11-20 17:35:33 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1150/2882]	eta 1:36:33 lr 0.000001	time 0.6224 (3.3449)	model_time 0.6222 (0.6383)	loss 0.2488 (0.2309)	grad_norm 0.9368 (0.9478/0.2535)	mem 34631MB
[2025-11-20 17:38:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1200/2882]	eta 1:34:11 lr 0.000001	time 27.9990 (3.3598)	model_time 0.6211 (0.6377)	loss 0.2055 (0.2309)	grad_norm 0.8288 (0.9396/0.2544)	mem 34631MB
[2025-11-20 17:41:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1250/2882]	eta 1:30:53 lr 0.000001	time 0.6229 (3.3416)	model_time 0.6227 (0.6372)	loss 0.2326 (0.2308)	grad_norm 0.9931 (0.9380/0.2507)	mem 34631MB
[2025-11-20 17:43:22 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1300/2882]	eta 1:27:31 lr 0.000001	time 0.6236 (3.3195)	model_time 0.6233 (0.6366)	loss 0.2357 (0.2308)	grad_norm 0.8434 (0.9371/0.2513)	mem 34631MB
[2025-11-20 17:45:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1350/2882]	eta 1:24:16 lr 0.000001	time 0.6228 (3.3007)	model_time 0.6227 (0.6361)	loss 0.2221 (0.2308)	grad_norm 0.9699 (0.9352/0.2461)	mem 34631MB
[2025-11-20 17:47:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1400/2882]	eta 1:21:01 lr 0.000001	time 0.6232 (3.2800)	model_time 0.6230 (0.6356)	loss 0.2220 (0.2308)	grad_norm 0.8207 (0.9243/0.2471)	mem 34631MB
[2025-11-20 17:50:16 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1450/2882]	eta 1:17:51 lr 0.000001	time 0.6215 (3.2619)	model_time 0.6213 (0.6351)	loss 0.2393 (0.2308)	grad_norm 1.1426 (0.9371/0.2574)	mem 34631MB
[2025-11-20 17:52:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1500/2882]	eta 1:15:05 lr 0.000001	time 25.8477 (3.2604)	model_time 0.6219 (0.6347)	loss 0.2416 (0.2308)	grad_norm 0.8917 (0.9384/0.2502)	mem 34631MB
[2025-11-20 17:55:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1550/2882]	eta 1:11:58 lr 0.000001	time 0.6212 (3.2424)	model_time 0.6210 (0.6343)	loss 0.2418 (0.2308)	grad_norm 0.5122 (0.9471/0.2536)	mem 34631MB
[2025-11-20 17:57:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1600/2882]	eta 1:08:58 lr 0.000001	time 0.6253 (3.2281)	model_time 0.6251 (0.6339)	loss 0.2500 (0.2308)	grad_norm 1.2716 (0.9419/0.2527)	mem 34631MB
[2025-11-20 17:59:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1650/2882]	eta 1:06:03 lr 0.000001	time 0.6229 (3.2168)	model_time 0.6227 (0.6336)	loss 0.2218 (0.2307)	grad_norm 1.0824 (0.9487/0.2513)	mem 34631MB
[2025-11-20 18:02:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1700/2882]	eta 1:03:20 lr 0.000001	time 0.6224 (3.2149)	model_time 0.6222 (0.6333)	loss 0.2064 (0.2306)	grad_norm 0.6198 (0.9627/0.2517)	mem 34631MB
[2025-11-20 18:05:06 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1750/2882]	eta 1:00:34 lr 0.000001	time 0.6214 (3.2110)	model_time 0.6211 (0.6330)	loss 0.1944 (0.2305)	grad_norm 0.5796 (0.9504/0.2463)	mem 34631MB
[2025-11-20 18:08:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1800/2882]	eta 0:58:08 lr 0.000001	time 35.5221 (3.2242)	model_time 0.6218 (0.6327)	loss 0.2407 (0.2305)	grad_norm 0.7975 (0.9492/0.2570)	mem 34631MB
[2025-11-20 18:10:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1850/2882]	eta 0:55:26 lr 0.000001	time 0.6230 (3.2235)	model_time 0.6228 (0.6324)	loss 0.2248 (0.2305)	grad_norm 0.8305 (0.9329/0.2505)	mem 34631MB
[2025-11-20 18:13:27 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1900/2882]	eta 0:52:43 lr 0.000001	time 0.6219 (3.2216)	model_time 0.6218 (0.6322)	loss 0.2537 (0.2305)	grad_norm 0.7208 (0.9341/0.2560)	mem 34631MB
[2025-11-20 18:15:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][1950/2882]	eta 0:49:56 lr 0.000001	time 0.6240 (3.2151)	model_time 0.6238 (0.6320)	loss 0.2274 (0.2306)	grad_norm 0.7528 (0.9237/0.2496)	mem 34631MB
[2025-11-20 18:18:23 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2000/2882]	eta 0:47:09 lr 0.000001	time 0.6225 (3.2084)	model_time 0.6223 (0.6318)	loss 0.2279 (0.2306)	grad_norm 1.3483 (0.9323/0.2566)	mem 34631MB
[2025-11-20 18:20:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2050/2882]	eta 0:44:24 lr 0.000001	time 0.6224 (3.2022)	model_time 0.6222 (0.6316)	loss 0.1957 (0.2307)	grad_norm 1.0084 (0.9370/0.2572)	mem 34631MB
[2025-11-20 18:23:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2100/2882]	eta 0:41:46 lr 0.000001	time 27.6370 (3.2056)	model_time 0.6245 (0.6314)	loss 0.2226 (0.2306)	grad_norm 0.9136 (0.9320/0.2514)	mem 34631MB
[2025-11-20 18:25:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2150/2882]	eta 0:38:59 lr 0.000001	time 0.6239 (3.1960)	model_time 0.6237 (0.6313)	loss 0.2446 (0.2305)	grad_norm 0.6734 (0.9312/0.2544)	mem 34631MB
[2025-11-20 18:28:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2200/2882]	eta 0:36:12 lr 0.000001	time 0.6230 (3.1853)	model_time 0.6228 (0.6310)	loss 0.2421 (0.2305)	grad_norm 0.7732 (0.9293/0.2457)	mem 34631MB
[2025-11-20 18:30:25 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2250/2882]	eta 0:33:25 lr 0.000001	time 0.6268 (3.1730)	model_time 0.6266 (0.6309)	loss 0.2089 (0.2305)	grad_norm 0.7060 (0.9373/0.2477)	mem 34631MB
[2025-11-20 18:32:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2300/2882]	eta 0:30:41 lr 0.000001	time 0.6240 (3.1639)	model_time 0.6238 (0.6308)	loss 0.2242 (0.2304)	grad_norm 0.5999 (0.9270/0.2470)	mem 34631MB
[2025-11-20 18:34:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2350/2882]	eta 0:27:56 lr 0.000001	time 0.6239 (3.1521)	model_time 0.6237 (0.6307)	loss 0.2292 (0.2305)	grad_norm 1.0515 (0.9321/0.2535)	mem 34631MB
[2025-11-20 18:37:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2400/2882]	eta 0:25:20 lr 0.000001	time 27.0154 (3.1549)	model_time 0.6227 (0.6305)	loss 0.2408 (0.2305)	grad_norm 0.9755 (0.9383/0.2507)	mem 34631MB
[2025-11-20 18:39:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2450/2882]	eta 0:22:39 lr 0.000001	time 0.6229 (3.1477)	model_time 0.6227 (0.6304)	loss 0.2298 (0.2304)	grad_norm 0.7434 (0.9469/0.2509)	mem 34631MB
[2025-11-20 18:42:11 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2500/2882]	eta 0:19:58 lr 0.000001	time 0.6235 (3.1380)	model_time 0.6233 (0.6302)	loss 0.2233 (0.2304)	grad_norm 0.9218 (0.9484/0.2509)	mem 34631MB
[2025-11-20 18:44:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2550/2882]	eta 0:17:19 lr 0.000001	time 0.6233 (3.1318)	model_time 0.6231 (0.6301)	loss 0.2306 (0.2304)	grad_norm 0.7365 (0.9328/0.2445)	mem 34631MB
[2025-11-20 18:47:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2600/2882]	eta 0:14:42 lr 0.000001	time 0.6209 (3.1288)	model_time 0.6207 (0.6300)	loss 0.2601 (0.2304)	grad_norm 1.4355 (0.9459/0.2461)	mem 34631MB
[2025-11-20 18:49:22 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2650/2882]	eta 0:12:04 lr 0.000001	time 0.6228 (3.1230)	model_time 0.6226 (0.6298)	loss 0.2209 (0.2305)	grad_norm 1.2075 (0.9386/0.2439)	mem 34631MB
[2025-11-20 18:52:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2700/2882]	eta 0:09:29 lr 0.000001	time 28.8722 (3.1289)	model_time 0.6231 (0.6297)	loss 0.2326 (0.2305)	grad_norm 0.7013 (0.9466/0.2454)	mem 34631MB
[2025-11-20 18:54:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2750/2882]	eta 0:06:52 lr 0.000001	time 0.6231 (3.1228)	model_time 0.6229 (0.6296)	loss 0.2741 (0.2304)	grad_norm 1.0728 (0.9358/0.2396)	mem 34631MB
[2025-11-20 18:56:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2800/2882]	eta 0:04:15 lr 0.000001	time 0.6232 (3.1156)	model_time 0.6230 (0.6295)	loss 0.2256 (0.2304)	grad_norm 1.3581 (0.9414/0.2447)	mem 34631MB
[2025-11-20 18:59:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [17/20][2850/2882]	eta 0:01:39 lr 0.000001	time 0.6214 (3.1075)	model_time 0.6212 (0.6294)	loss 0.2299 (0.2304)	grad_norm 1.1889 (0.9433/0.2543)	mem 34631MB
[2025-11-20 19:00:58 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 17 training takes 2:29:34
[2025-11-20 19:00:58 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_17.pth saving......
[2025-11-20 19:01:00 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_17.pth saved !!!
[2025-11-20 19:01:36 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 35.728 (35.728)	Loss 0.2705 (0.2705)	Mem 34631MB
[2025-11-20 19:02:21 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:17] * Mean AUC-ROC 0.8114 Loss 0.2289
[2025-11-20 19:02:21 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:17] * Per-class AUC-ROC: ['0.8412', '0.8315', '0.8240', '0.9038', '0.7344', '0.5977', '0.7326', '0.7495', '0.8675', '0.9245', '0.7714', '0.7610', '0.8930', '0.9273']
[2025-11-20 19:02:21 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.8114
[2025-11-20 19:02:21 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-20 19:02:23 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-20 19:02:23 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.8114
[2025-11-20 19:02:33 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 10.194 (10.194)	Loss 0.2721 (0.2721)	Mem 34631MB
[2025-11-20 19:02:45 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:17] * Mean AUC-ROC 0.8095 Loss 0.2301
[2025-11-20 19:02:45 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:17] * Per-class AUC-ROC: ['0.8403', '0.8302', '0.8201', '0.9039', '0.7348', '0.5991', '0.7271', '0.7473', '0.8657', '0.9243', '0.7642', '0.7603', '0.8892', '0.9262']
[2025-11-20 19:02:46 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.8095
[2025-11-20 19:02:46 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-20 19:02:47 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-20 19:02:47 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.8095
[2025-11-20 19:03:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][0/2882]	eta 1 day, 13:30:37 lr 0.000001	time 46.8556 (46.8556)	model_time 0.6227 (0.6227)	loss 0.2630 (0.2630)	grad_norm 0.7880 (0.7880/0.0000)	mem 34631MB
[2025-11-20 19:05:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][50/2882]	eta 2:50:34 lr 0.000001	time 0.6243 (3.6139)	model_time 0.6241 (0.6232)	loss 0.2389 (0.2307)	grad_norm 0.8647 (0.9476/0.2416)	mem 34631MB
[2025-11-20 19:08:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][100/2882]	eta 2:25:45 lr 0.000001	time 0.6242 (3.1438)	model_time 0.6241 (0.6231)	loss 0.2331 (0.2302)	grad_norm 1.1152 (0.9676/0.2830)	mem 34631MB
[2025-11-20 19:10:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][150/2882]	eta 2:14:12 lr 0.000001	time 0.6224 (2.9473)	model_time 0.6222 (0.6240)	loss 0.2492 (0.2302)	grad_norm 1.1293 (0.9693/0.2702)	mem 34631MB
[2025-11-20 19:12:24 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][200/2882]	eta 2:08:09 lr 0.000001	time 0.6224 (2.8671)	model_time 0.6223 (0.6238)	loss 0.2536 (0.2316)	grad_norm 1.0328 (0.9606/0.2727)	mem 34631MB
[2025-11-20 19:14:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][250/2882]	eta 2:03:50 lr 0.000001	time 0.6244 (2.8230)	model_time 0.6242 (0.6237)	loss 0.2461 (0.2319)	grad_norm 0.6248 (0.9473/0.2623)	mem 34631MB
[2025-11-20 19:17:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][300/2882]	eta 2:04:05 lr 0.000001	time 24.6100 (2.8837)	model_time 0.6245 (0.6236)	loss 0.2415 (0.2323)	grad_norm 1.0753 (0.9596/0.2647)	mem 34631MB
[2025-11-20 19:19:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][350/2882]	eta 2:00:00 lr 0.000001	time 0.6222 (2.8440)	model_time 0.6220 (0.6238)	loss 0.2165 (0.2322)	grad_norm 0.5487 (0.9503/0.2573)	mem 34631MB
[2025-11-20 19:21:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][400/2882]	eta 1:56:27 lr 0.000001	time 0.6208 (2.8154)	model_time 0.6206 (0.6237)	loss 0.2555 (0.2321)	grad_norm 0.7630 (0.9421/0.2398)	mem 34631MB
[2025-11-20 19:24:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][450/2882]	eta 1:54:26 lr 0.000001	time 0.6212 (2.8234)	model_time 0.6210 (0.6235)	loss 0.2445 (0.2318)	grad_norm 0.9174 (0.9324/0.2383)	mem 34631MB
[2025-11-20 19:26:14 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][500/2882]	eta 1:51:27 lr 0.000001	time 0.6236 (2.8077)	model_time 0.6234 (0.6237)	loss 0.2361 (0.2319)	grad_norm 0.8292 (0.9283/0.2283)	mem 34631MB
[2025-11-20 19:28:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][550/2882]	eta 1:48:08 lr 0.000001	time 0.6237 (2.7824)	model_time 0.6236 (0.6237)	loss 0.2053 (0.2318)	grad_norm 1.0247 (0.9321/0.2333)	mem 34631MB
[2025-11-20 19:30:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][600/2882]	eta 1:46:40 lr 0.000001	time 26.4724 (2.8050)	model_time 0.6240 (0.6239)	loss 0.2220 (0.2318)	grad_norm 0.6738 (0.9139/0.2217)	mem 34631MB
[2025-11-20 19:33:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][650/2882]	eta 1:44:15 lr 0.000001	time 0.6236 (2.8027)	model_time 0.6234 (0.6239)	loss 0.2304 (0.2320)	grad_norm 0.7772 (0.9196/0.2352)	mem 34631MB
[2025-11-20 19:35:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][700/2882]	eta 1:41:44 lr 0.000001	time 0.6228 (2.7976)	model_time 0.6226 (0.6240)	loss 0.2266 (0.2318)	grad_norm 0.9951 (0.9171/0.2422)	mem 34631MB
[2025-11-20 19:37:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][750/2882]	eta 1:38:58 lr 0.000001	time 0.6232 (2.7856)	model_time 0.6231 (0.6239)	loss 0.2440 (0.2317)	grad_norm 1.0878 (0.9177/0.2489)	mem 34631MB
[2025-11-20 19:39:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][800/2882]	eta 1:36:17 lr 0.000001	time 0.6250 (2.7751)	model_time 0.6248 (0.6238)	loss 0.2285 (0.2315)	grad_norm 0.6740 (0.9234/0.2479)	mem 34631MB
[2025-11-20 19:42:23 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][850/2882]	eta 1:34:32 lr 0.000001	time 0.6226 (2.7918)	model_time 0.6224 (0.6238)	loss 0.2390 (0.2314)	grad_norm 0.9854 (0.9291/0.2546)	mem 34631MB
[2025-11-20 19:45:47 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][900/2882]	eta 1:34:34 lr 0.000001	time 37.8331 (2.8630)	model_time 0.6232 (0.6237)	loss 0.2294 (0.2314)	grad_norm 0.6254 (0.9396/0.2650)	mem 34631MB
[2025-11-20 19:48:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][950/2882]	eta 1:33:00 lr 0.000001	time 0.6227 (2.8882)	model_time 0.6225 (0.6237)	loss 0.2339 (0.2313)	grad_norm 0.7188 (0.9403/0.2661)	mem 34631MB
[2025-11-20 19:51:17 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1000/2882]	eta 1:31:10 lr 0.000001	time 0.6233 (2.9068)	model_time 0.6231 (0.6237)	loss 0.2555 (0.2312)	grad_norm 1.0123 (0.9469/0.2620)	mem 34631MB
[2025-11-20 19:54:00 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1050/2882]	eta 1:29:15 lr 0.000001	time 0.6232 (2.9231)	model_time 0.6229 (0.6236)	loss 0.2525 (0.2311)	grad_norm 1.2010 (0.9443/0.2481)	mem 34631MB
[2025-11-20 19:56:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1100/2882]	eta 1:27:03 lr 0.000001	time 0.6211 (2.9313)	model_time 0.6209 (0.6236)	loss 0.2248 (0.2310)	grad_norm 1.2623 (0.9545/0.2547)	mem 34631MB
[2025-11-20 19:59:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1150/2882]	eta 1:25:17 lr 0.000001	time 0.6235 (2.9548)	model_time 0.6233 (0.6236)	loss 0.2180 (0.2309)	grad_norm 0.8811 (0.9547/0.2460)	mem 34631MB
[2025-11-20 20:02:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1200/2882]	eta 1:23:47 lr 0.000001	time 31.8980 (2.9888)	model_time 0.6230 (0.6236)	loss 0.2426 (0.2309)	grad_norm 0.8565 (0.9536/0.2427)	mem 34631MB
[2025-11-20 20:05:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1250/2882]	eta 1:21:11 lr 0.000001	time 0.6224 (2.9852)	model_time 0.6221 (0.6235)	loss 0.2321 (0.2309)	grad_norm 1.0910 (0.9540/0.2318)	mem 34631MB
[2025-11-20 20:07:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1300/2882]	eta 1:18:42 lr 0.000001	time 0.6221 (2.9850)	model_time 0.6219 (0.6236)	loss 0.2190 (0.2308)	grad_norm 1.1567 (0.9474/0.2251)	mem 34631MB
[2025-11-20 20:09:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1350/2882]	eta 1:15:53 lr 0.000001	time 0.6245 (2.9720)	model_time 0.6243 (0.6236)	loss 0.2430 (0.2307)	grad_norm 0.6287 (0.9559/0.2341)	mem 34631MB
[2025-11-20 20:11:50 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1400/2882]	eta 1:13:01 lr 0.000001	time 0.6236 (2.9568)	model_time 0.6235 (0.6235)	loss 0.2131 (0.2308)	grad_norm 0.7355 (0.9340/0.2319)	mem 34631MB
[2025-11-20 20:14:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1450/2882]	eta 1:10:17 lr 0.000001	time 0.6218 (2.9451)	model_time 0.6216 (0.6236)	loss 0.2270 (0.2307)	grad_norm 1.0273 (0.9302/0.2333)	mem 34631MB
[2025-11-20 20:16:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1500/2882]	eta 1:07:53 lr 0.000001	time 25.1094 (2.9478)	model_time 0.6230 (0.6236)	loss 0.2247 (0.2307)	grad_norm 0.9032 (0.9383/0.2345)	mem 34631MB
[2025-11-20 20:18:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1550/2882]	eta 1:05:12 lr 0.000001	time 0.6217 (2.9373)	model_time 0.6215 (0.6236)	loss 0.2302 (0.2307)	grad_norm 0.9393 (0.9281/0.2396)	mem 34631MB
[2025-11-20 20:21:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1600/2882]	eta 1:02:38 lr 0.000001	time 0.6219 (2.9317)	model_time 0.6218 (0.6236)	loss 0.2505 (0.2306)	grad_norm 1.1186 (0.9353/0.2534)	mem 34631MB
[2025-11-20 20:23:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1650/2882]	eta 1:00:06 lr 0.000001	time 0.6234 (2.9271)	model_time 0.6232 (0.6236)	loss 0.2461 (0.2305)	grad_norm 0.8920 (0.9350/0.2574)	mem 34631MB
[2025-11-20 20:25:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1700/2882]	eta 0:57:33 lr 0.000001	time 0.6236 (2.9217)	model_time 0.6234 (0.6236)	loss 0.2402 (0.2305)	grad_norm 1.0845 (0.9552/0.2685)	mem 34631MB
[2025-11-20 20:27:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1750/2882]	eta 0:54:52 lr 0.000001	time 0.6241 (2.9084)	model_time 0.6239 (0.6236)	loss 0.2435 (0.2304)	grad_norm 1.1160 (0.9521/0.2697)	mem 34631MB
[2025-11-20 20:30:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1800/2882]	eta 0:52:32 lr 0.000001	time 26.1483 (2.9138)	model_time 0.6252 (0.6236)	loss 0.2389 (0.2305)	grad_norm 0.6652 (0.9336/0.2634)	mem 34631MB
[2025-11-20 20:32:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1850/2882]	eta 0:49:56 lr 0.000001	time 0.6230 (2.9033)	model_time 0.6228 (0.6235)	loss 0.2478 (0.2305)	grad_norm 0.8648 (0.9450/0.2646)	mem 34631MB
[2025-11-20 20:34:22 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1900/2882]	eta 0:47:18 lr 0.000001	time 0.6241 (2.8903)	model_time 0.6239 (0.6235)	loss 0.2336 (0.2305)	grad_norm 1.0244 (0.9382/0.2483)	mem 34631MB
[2025-11-20 20:36:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][1950/2882]	eta 0:44:50 lr 0.000001	time 0.6222 (2.8873)	model_time 0.6220 (0.6235)	loss 0.2365 (0.2306)	grad_norm 1.1537 (0.9303/0.2466)	mem 34631MB
[2025-11-20 20:38:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2000/2882]	eta 0:42:22 lr 0.000001	time 0.6274 (2.8822)	model_time 0.6272 (0.6235)	loss 0.2394 (0.2305)	grad_norm 0.7977 (0.9219/0.2417)	mem 34631MB
[2025-11-20 20:41:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2050/2882]	eta 0:39:54 lr 0.000001	time 0.6230 (2.8777)	model_time 0.6228 (0.6236)	loss 0.2279 (0.2305)	grad_norm 0.6496 (0.9317/0.2442)	mem 34631MB
[2025-11-20 20:43:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2100/2882]	eta 0:37:30 lr 0.000001	time 13.9482 (2.8779)	model_time 0.6247 (0.6236)	loss 0.2256 (0.2305)	grad_norm 1.1350 (0.9326/0.2392)	mem 34631MB
[2025-11-20 20:45:42 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2150/2882]	eta 0:35:01 lr 0.000001	time 0.6236 (2.8704)	model_time 0.6234 (0.6236)	loss 0.2103 (0.2303)	grad_norm 0.6492 (0.9249/0.2384)	mem 34631MB
[2025-11-20 20:47:47 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2200/2882]	eta 0:32:32 lr 0.000001	time 0.6239 (2.8622)	model_time 0.6237 (0.6236)	loss 0.1972 (0.2304)	grad_norm 1.2095 (0.9358/0.2508)	mem 34631MB
[2025-11-20 20:50:08 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2250/2882]	eta 0:30:08 lr 0.000001	time 0.6238 (2.8612)	model_time 0.6236 (0.6236)	loss 0.2267 (0.2303)	grad_norm 0.6837 (0.9483/0.2575)	mem 34631MB
[2025-11-20 20:52:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2300/2882]	eta 0:27:46 lr 0.000001	time 0.6231 (2.8628)	model_time 0.6229 (0.6237)	loss 0.2203 (0.2303)	grad_norm 0.9808 (0.9444/0.2525)	mem 34631MB
[2025-11-20 20:54:51 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2350/2882]	eta 0:25:21 lr 0.000001	time 0.6227 (2.8597)	model_time 0.6225 (0.6237)	loss 0.2115 (0.2303)	grad_norm 0.8606 (0.9397/0.2515)	mem 34631MB
[2025-11-20 20:57:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2400/2882]	eta 0:22:59 lr 0.000001	time 13.4026 (2.8626)	model_time 0.6253 (0.6237)	loss 0.2530 (0.2303)	grad_norm 1.0223 (0.9535/0.2573)	mem 34631MB
[2025-11-20 20:59:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2450/2882]	eta 0:20:35 lr 0.000001	time 0.6232 (2.8591)	model_time 0.6230 (0.6237)	loss 0.2143 (0.2302)	grad_norm 0.7426 (0.9452/0.2550)	mem 34631MB
[2025-11-20 21:01:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2500/2882]	eta 0:18:12 lr 0.000001	time 0.6226 (2.8590)	model_time 0.6224 (0.6237)	loss 0.2304 (0.2302)	grad_norm 1.1216 (0.9274/0.2557)	mem 34631MB
[2025-11-20 21:04:15 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2550/2882]	eta 0:15:48 lr 0.000001	time 0.6236 (2.8569)	model_time 0.6234 (0.6237)	loss 0.2468 (0.2302)	grad_norm 1.2105 (0.9202/0.2472)	mem 34631MB
[2025-11-20 21:06:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2600/2882]	eta 0:13:25 lr 0.000001	time 0.6230 (2.8561)	model_time 0.6228 (0.6238)	loss 0.2196 (0.2301)	grad_norm 1.0012 (0.9319/0.2424)	mem 34631MB
[2025-11-20 21:08:43 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2650/2882]	eta 0:11:01 lr 0.000001	time 0.6228 (2.8501)	model_time 0.6226 (0.6238)	loss 0.2301 (0.2301)	grad_norm 0.7278 (0.9325/0.2374)	mem 34631MB
[2025-11-20 21:11:17 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2700/2882]	eta 0:08:39 lr 0.000001	time 10.3042 (2.8544)	model_time 0.6244 (0.6238)	loss 0.2564 (0.2301)	grad_norm 1.0288 (0.9296/0.2464)	mem 34631MB
[2025-11-20 21:13:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2750/2882]	eta 0:06:16 lr 0.000001	time 0.6233 (2.8535)	model_time 0.6231 (0.6238)	loss 0.2145 (0.2302)	grad_norm 1.1696 (0.9375/0.2502)	mem 34631MB
[2025-11-20 21:15:57 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2800/2882]	eta 0:03:53 lr 0.000001	time 0.6234 (2.8524)	model_time 0.6232 (0.6238)	loss 0.2186 (0.2302)	grad_norm 1.0684 (0.9405/0.2479)	mem 34631MB
[2025-11-20 21:18:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [18/20][2850/2882]	eta 0:01:31 lr 0.000001	time 0.6244 (2.8522)	model_time 0.6242 (0.6238)	loss 0.2395 (0.2302)	grad_norm 0.7745 (0.9394/0.2483)	mem 34631MB
[2025-11-20 21:20:07 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 18 training takes 2:17:19
[2025-11-20 21:20:07 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_18.pth saving......
[2025-11-20 21:20:09 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_18.pth saved !!!
[2025-11-20 21:20:47 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 37.504 (37.504)	Loss 0.2712 (0.2712)	Mem 34631MB
[2025-11-20 21:21:30 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:18] * Mean AUC-ROC 0.8109 Loss 0.2288
[2025-11-20 21:21:30 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:18] * Per-class AUC-ROC: ['0.8414', '0.8313', '0.8225', '0.9037', '0.7326', '0.6015', '0.7281', '0.7496', '0.8673', '0.9248', '0.7667', '0.7611', '0.8947', '0.9275']
[2025-11-20 21:21:30 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.8109
[2025-11-20 21:21:30 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.8114
[2025-11-20 21:21:42 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 11.290 (11.290)	Loss 0.2718 (0.2718)	Mem 34631MB
[2025-11-20 21:21:56 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:18] * Mean AUC-ROC 0.8100 Loss 0.2298
[2025-11-20 21:21:56 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:18] * Per-class AUC-ROC: ['0.8406', '0.8305', '0.8207', '0.9039', '0.7346', '0.5993', '0.7282', '0.7478', '0.8662', '0.9244', '0.7662', '0.7605', '0.8903', '0.9266']
[2025-11-20 21:21:56 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.8100
[2025-11-20 21:21:56 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-20 21:21:59 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-20 21:21:59 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.8100
[2025-11-20 21:22:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][0/2882]	eta 1 day, 7:41:06 lr 0.000001	time 39.5788 (39.5788)	model_time 0.6239 (0.6239)	loss 0.2595 (0.2595)	grad_norm 1.0463 (1.0463/0.0000)	mem 34631MB
[2025-11-20 21:24:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][50/2882]	eta 2:42:26 lr 0.000001	time 0.6253 (3.4417)	model_time 0.6251 (0.6245)	loss 0.2446 (0.2274)	grad_norm 0.9450 (0.8903/0.1666)	mem 34631MB
[2025-11-20 21:27:04 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][100/2882]	eta 2:20:10 lr 0.000001	time 0.6219 (3.0233)	model_time 0.6217 (0.6241)	loss 0.2489 (0.2281)	grad_norm 0.9226 (0.9231/0.2339)	mem 34631MB
[2025-11-20 21:29:21 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][150/2882]	eta 2:13:19 lr 0.000001	time 0.6234 (2.9282)	model_time 0.6232 (0.6240)	loss 0.2315 (0.2293)	grad_norm 1.4536 (0.9488/0.2448)	mem 34631MB
[2025-11-20 21:31:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][200/2882]	eta 2:08:08 lr 0.000001	time 0.6253 (2.8667)	model_time 0.6250 (0.6240)	loss 0.2327 (0.2303)	grad_norm 0.6408 (0.9499/0.2550)	mem 34631MB
[2025-11-20 21:33:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][250/2882]	eta 2:04:57 lr 0.000001	time 0.6229 (2.8486)	model_time 0.6227 (0.6240)	loss 0.2603 (0.2308)	grad_norm 0.9499 (0.9498/0.2541)	mem 34631MB
[2025-11-20 21:36:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][300/2882]	eta 2:05:35 lr 0.000001	time 27.3593 (2.9185)	model_time 0.6213 (0.6241)	loss 0.2550 (0.2306)	grad_norm 0.9331 (0.9441/0.2499)	mem 34631MB
[2025-11-20 21:38:56 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][350/2882]	eta 2:02:16 lr 0.000001	time 0.6227 (2.8974)	model_time 0.6226 (0.6240)	loss 0.2689 (0.2303)	grad_norm 0.6529 (0.9578/0.2560)	mem 34631MB
[2025-11-20 21:41:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][400/2882]	eta 1:58:13 lr 0.000001	time 0.6233 (2.8578)	model_time 0.6232 (0.6240)	loss 0.2365 (0.2305)	grad_norm 0.6849 (0.9589/0.2556)	mem 34631MB
[2025-11-20 21:43:28 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][450/2882]	eta 1:55:50 lr 0.000001	time 0.6242 (2.8579)	model_time 0.6240 (0.6244)	loss 0.2200 (0.2305)	grad_norm 0.9267 (0.9568/0.2508)	mem 34631MB
[2025-11-20 21:45:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][500/2882]	eta 1:52:14 lr 0.000001	time 0.6240 (2.8273)	model_time 0.6238 (0.6243)	loss 0.2443 (0.2306)	grad_norm 0.8375 (0.9557/0.2485)	mem 34631MB
[2025-11-20 21:47:36 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][550/2882]	eta 1:48:27 lr 0.000001	time 0.6221 (2.7906)	model_time 0.6219 (0.6241)	loss 0.1953 (0.2304)	grad_norm 0.9519 (0.9453/0.2432)	mem 34631MB
[2025-11-20 21:49:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][600/2882]	eta 1:45:12 lr 0.000001	time 2.9829 (2.7662)	model_time 0.6243 (0.6241)	loss 0.2143 (0.2302)	grad_norm 0.4044 (0.9522/0.2407)	mem 34631MB
[2025-11-20 21:51:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][650/2882]	eta 1:42:53 lr 0.000001	time 0.6241 (2.7658)	model_time 0.6239 (0.6243)	loss 0.2275 (0.2302)	grad_norm 0.5663 (0.9378/0.2452)	mem 34631MB
[2025-11-20 21:54:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][700/2882]	eta 1:40:07 lr 0.000001	time 0.6233 (2.7534)	model_time 0.6231 (0.6242)	loss 0.1977 (0.2299)	grad_norm 1.1086 (0.9378/0.2411)	mem 34631MB
[2025-11-20 21:56:33 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][750/2882]	eta 1:38:07 lr 0.000001	time 0.6228 (2.7617)	model_time 0.6227 (0.6241)	loss 0.2092 (0.2298)	grad_norm 0.6996 (0.9251/0.2393)	mem 34631MB
[2025-11-20 21:58:39 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][800/2882]	eta 1:35:19 lr 0.000001	time 0.6221 (2.7471)	model_time 0.6218 (0.6243)	loss 0.2351 (0.2301)	grad_norm 1.0450 (0.9148/0.2390)	mem 34631MB
[2025-11-20 22:00:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][850/2882]	eta 1:32:52 lr 0.000001	time 0.6240 (2.7425)	model_time 0.6238 (0.6242)	loss 0.2235 (0.2302)	grad_norm 0.8249 (0.9220/0.2426)	mem 34631MB
[2025-11-20 22:03:13 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][900/2882]	eta 1:30:42 lr 0.000001	time 9.9188 (2.7459)	model_time 0.6229 (0.6243)	loss 0.2510 (0.2302)	grad_norm 0.9748 (0.9199/0.2412)	mem 34631MB
[2025-11-20 22:05:58 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][950/2882]	eta 1:29:21 lr 0.000001	time 0.6226 (2.7753)	model_time 0.6224 (0.6242)	loss 0.2278 (0.2304)	grad_norm 0.6814 (0.9311/0.2459)	mem 34631MB
[2025-11-20 22:08:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1000/2882]	eta 1:27:26 lr 0.000001	time 0.6231 (2.7879)	model_time 0.6229 (0.6242)	loss 0.2463 (0.2303)	grad_norm 0.7152 (0.9196/0.2443)	mem 34631MB
[2025-11-20 22:10:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1050/2882]	eta 1:24:49 lr 0.000001	time 0.6239 (2.7779)	model_time 0.6237 (0.6243)	loss 0.2200 (0.2300)	grad_norm 1.0187 (0.9224/0.2478)	mem 34631MB
[2025-11-20 22:12:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1100/2882]	eta 1:22:26 lr 0.000001	time 0.6233 (2.7756)	model_time 0.6231 (0.6242)	loss 0.2240 (0.2299)	grad_norm 1.0113 (0.9283/0.2478)	mem 34631MB
[2025-11-20 22:15:10 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1150/2882]	eta 1:20:01 lr 0.000001	time 0.6243 (2.7725)	model_time 0.6240 (0.6243)	loss 0.2267 (0.2299)	grad_norm 0.9689 (0.9270/0.2486)	mem 34631MB
[2025-11-20 22:17:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1200/2882]	eta 1:18:18 lr 0.000001	time 17.7709 (2.7934)	model_time 0.6220 (0.6242)	loss 0.2203 (0.2300)	grad_norm 0.7008 (0.9261/0.2556)	mem 34631MB
[2025-11-20 22:20:20 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1250/2882]	eta 1:16:07 lr 0.000001	time 0.6236 (2.7989)	model_time 0.6234 (0.6242)	loss 0.2562 (0.2302)	grad_norm 0.6995 (0.9345/0.2588)	mem 34631MB
[2025-11-20 22:22:34 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1300/2882]	eta 1:13:40 lr 0.000001	time 0.6206 (2.7940)	model_time 0.6204 (0.6241)	loss 0.2265 (0.2302)	grad_norm 0.7734 (0.9455/0.2611)	mem 34631MB
[2025-11-20 22:24:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1350/2882]	eta 1:11:03 lr 0.000001	time 0.6231 (2.7826)	model_time 0.6229 (0.6241)	loss 0.2197 (0.2302)	grad_norm 0.6377 (0.9457/0.2566)	mem 34631MB
[2025-11-20 22:26:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1400/2882]	eta 1:08:25 lr 0.000001	time 0.6237 (2.7702)	model_time 0.6236 (0.6241)	loss 0.2234 (0.2304)	grad_norm 1.2320 (0.9569/0.2589)	mem 34631MB
[2025-11-20 22:28:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1450/2882]	eta 1:06:00 lr 0.000001	time 0.6255 (2.7658)	model_time 0.6253 (0.6241)	loss 0.2313 (0.2304)	grad_norm 0.5819 (0.9520/0.2589)	mem 34631MB
[2025-11-20 22:31:19 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1500/2882]	eta 1:03:50 lr 0.000001	time 22.5287 (2.7715)	model_time 0.6220 (0.6240)	loss 0.2608 (0.2305)	grad_norm 0.8636 (0.9507/0.2575)	mem 34631MB
[2025-11-20 22:33:26 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1550/2882]	eta 1:01:21 lr 0.000001	time 0.6244 (2.7641)	model_time 0.6242 (0.6241)	loss 0.2260 (0.2303)	grad_norm 1.4713 (0.9547/0.2615)	mem 34631MB
[2025-11-20 22:36:25 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1600/2882]	eta 0:59:36 lr 0.000001	time 0.6223 (2.7896)	model_time 0.6221 (0.6241)	loss 0.2339 (0.2304)	grad_norm 0.7789 (0.9600/0.2686)	mem 34631MB
[2025-11-20 22:38:40 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1650/2882]	eta 0:57:13 lr 0.000001	time 0.6245 (2.7871)	model_time 0.6243 (0.6240)	loss 0.2215 (0.2303)	grad_norm 0.7398 (0.9549/0.2699)	mem 34631MB
[2025-11-20 22:40:52 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1700/2882]	eta 0:54:49 lr 0.000001	time 0.6251 (2.7826)	model_time 0.6249 (0.6240)	loss 0.2368 (0.2302)	grad_norm 0.9787 (0.9473/0.2678)	mem 34631MB
[2025-11-20 22:43:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1750/2882]	eta 0:52:30 lr 0.000001	time 0.6226 (2.7829)	model_time 0.6224 (0.6241)	loss 0.2154 (0.2302)	grad_norm 1.2103 (0.9594/0.2739)	mem 34631MB
[2025-11-20 22:45:37 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1800/2882]	eta 0:50:15 lr 0.000001	time 16.3159 (2.7867)	model_time 0.6214 (0.6240)	loss 0.2370 (0.2302)	grad_norm 0.6908 (0.9495/0.2730)	mem 34631MB
[2025-11-20 22:47:46 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1850/2882]	eta 0:47:49 lr 0.000001	time 0.6224 (2.7810)	model_time 0.6222 (0.6240)	loss 0.2155 (0.2302)	grad_norm 0.5365 (0.9239/0.2628)	mem 34631MB
[2025-11-20 22:49:55 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1900/2882]	eta 0:45:25 lr 0.000001	time 0.6243 (2.7754)	model_time 0.6241 (0.6241)	loss 0.2324 (0.2301)	grad_norm 0.8841 (0.9218/0.2504)	mem 34631MB
[2025-11-20 22:51:59 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][1950/2882]	eta 0:43:00 lr 0.000001	time 0.6227 (2.7683)	model_time 0.6225 (0.6240)	loss 0.2401 (0.2301)	grad_norm 0.5022 (0.9288/0.2590)	mem 34631MB
[2025-11-20 22:54:07 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2000/2882]	eta 0:40:36 lr 0.000001	time 0.6232 (2.7629)	model_time 0.6230 (0.6241)	loss 0.2446 (0.2301)	grad_norm 1.2381 (0.9367/0.2618)	mem 34631MB
[2025-11-20 22:56:29 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2050/2882]	eta 0:38:20 lr 0.000001	time 0.6216 (2.7647)	model_time 0.6215 (0.6241)	loss 0.2058 (0.2302)	grad_norm 0.8362 (0.9169/0.2524)	mem 34631MB
[2025-11-20 22:59:53 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2100/2882]	eta 0:36:26 lr 0.000001	time 24.2827 (2.7961)	model_time 0.6249 (0.6241)	loss 0.2359 (0.2302)	grad_norm 1.0030 (0.9207/0.2527)	mem 34631MB
[2025-11-20 23:02:23 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2150/2882]	eta 0:34:10 lr 0.000001	time 0.6237 (2.8008)	model_time 0.6235 (0.6241)	loss 0.2502 (0.2302)	grad_norm 1.2432 (0.9340/0.2591)	mem 34631MB
[2025-11-20 23:04:41 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2200/2882]	eta 0:31:49 lr 0.000001	time 0.6224 (2.7996)	model_time 0.6222 (0.6241)	loss 0.2119 (0.2302)	grad_norm 0.9515 (0.9280/0.2676)	mem 34631MB
[2025-11-20 23:06:54 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2250/2882]	eta 0:29:27 lr 0.000001	time 0.6235 (2.7966)	model_time 0.6233 (0.6241)	loss 0.2045 (0.2302)	grad_norm 0.8327 (0.9269/0.2605)	mem 34631MB
[2025-11-20 23:09:02 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2300/2882]	eta 0:27:04 lr 0.000001	time 0.6229 (2.7917)	model_time 0.6227 (0.6240)	loss 0.2412 (0.2302)	grad_norm 0.8114 (0.9221/0.2606)	mem 34631MB
[2025-11-20 23:11:35 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2350/2882]	eta 0:24:48 lr 0.000001	time 0.6237 (2.7975)	model_time 0.6235 (0.6240)	loss 0.2370 (0.2301)	grad_norm 0.6517 (0.9437/0.2666)	mem 34631MB
[2025-11-20 23:14:03 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2400/2882]	eta 0:22:30 lr 0.000001	time 21.6257 (2.8008)	model_time 0.6244 (0.6240)	loss 0.2266 (0.2302)	grad_norm 0.8037 (0.9505/0.2623)	mem 34631MB
[2025-11-20 23:16:05 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2450/2882]	eta 0:20:06 lr 0.000001	time 0.6214 (2.7933)	model_time 0.6211 (0.6240)	loss 0.2257 (0.2302)	grad_norm 1.0064 (0.9541/0.2539)	mem 34631MB
[2025-11-20 23:18:09 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2500/2882]	eta 0:17:44 lr 0.000001	time 0.6211 (2.7868)	model_time 0.6210 (0.6240)	loss 0.2005 (0.2302)	grad_norm 1.0219 (0.9690/0.2614)	mem 34631MB
[2025-11-20 23:20:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2550/2882]	eta 0:15:25 lr 0.000001	time 0.6209 (2.7883)	model_time 0.6207 (0.6240)	loss 0.2095 (0.2302)	grad_norm 0.7218 (0.9734/0.2576)	mem 34631MB
[2025-11-20 23:22:32 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2600/2882]	eta 0:13:04 lr 0.000001	time 0.6265 (2.7810)	model_time 0.6263 (0.6240)	loss 0.2000 (0.2302)	grad_norm 0.9129 (0.9683/0.2500)	mem 34631MB
[2025-11-20 23:24:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2650/2882]	eta 0:10:43 lr 0.000001	time 0.6225 (2.7735)	model_time 0.6223 (0.6240)	loss 0.2562 (0.2302)	grad_norm 0.9561 (0.9657/0.2508)	mem 34631MB
[2025-11-20 23:27:01 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2700/2882]	eta 0:08:25 lr 0.000001	time 23.5610 (2.7777)	model_time 0.6237 (0.6240)	loss 0.2245 (0.2302)	grad_norm 0.5847 (0.9755/0.2722)	mem 34631MB
[2025-11-20 23:29:12 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2750/2882]	eta 0:06:06 lr 0.000001	time 0.6218 (2.7748)	model_time 0.6216 (0.6240)	loss 0.2336 (0.2302)	grad_norm 0.6470 (0.9767/0.2709)	mem 34631MB
[2025-11-20 23:31:31 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2800/2882]	eta 0:03:47 lr 0.000001	time 0.6220 (2.7749)	model_time 0.6218 (0.6239)	loss 0.2093 (0.2302)	grad_norm 0.9513 (0.9688/0.2508)	mem 34631MB
[2025-11-20 23:33:38 internimage_b_mimic_cxr_224] (main.py 574): INFO Train: [19/20][2850/2882]	eta 0:01:28 lr 0.000001	time 3.8506 (2.7708)	model_time 0.6236 (0.6239)	loss 0.1983 (0.2302)	grad_norm 0.6744 (0.9784/0.2659)	mem 34631MB
[2025-11-20 23:35:14 internimage_b_mimic_cxr_224] (main.py 583): INFO EPOCH 19 training takes 2:13:15
[2025-11-20 23:35:14 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_19.pth saving......
[2025-11-20 23:35:16 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_19.pth saved !!!
[2025-11-20 23:35:48 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 32.098 (32.098)	Loss 0.2711 (0.2711)	Mem 34631MB
[2025-11-20 23:36:30 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:19] * Mean AUC-ROC 0.8119 Loss 0.2288
[2025-11-20 23:36:30 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:19] * Per-class AUC-ROC: ['0.8416', '0.8313', '0.8222', '0.9037', '0.7343', '0.6060', '0.7319', '0.7496', '0.8673', '0.9247', '0.7703', '0.7610', '0.8951', '0.9278']
[2025-11-20 23:36:30 internimage_b_mimic_cxr_224] (main.py 365): INFO AUC-ROC of the network on the 2991 val images: 0.8119
[2025-11-20 23:36:30 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saving......
[2025-11-20 23:36:31 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth saved !!!
[2025-11-20 23:36:31 internimage_b_mimic_cxr_224] (main.py 380): INFO Max AUC-ROC: 0.8119
[2025-11-20 23:36:41 internimage_b_mimic_cxr_224] (utils_multilabel.py 77): INFO Test: [0/24]	Time 9.124 (9.124)	Loss 0.2716 (0.2716)	Mem 34631MB
[2025-11-20 23:36:53 internimage_b_mimic_cxr_224] (utils_multilabel.py 138): INFO [Epoch:19] * Mean AUC-ROC 0.8104 Loss 0.2296
[2025-11-20 23:36:53 internimage_b_mimic_cxr_224] (utils_multilabel.py 139): INFO [Epoch:19] * Per-class AUC-ROC: ['0.8408', '0.8308', '0.8212', '0.9038', '0.7345', '0.5995', '0.7293', '0.7484', '0.8665', '0.9244', '0.7679', '0.7607', '0.8913', '0.9269']
[2025-11-20 23:36:53 internimage_b_mimic_cxr_224] (main.py 385): INFO AUC-ROC of the ema network on the 2991 val images: 0.8104
[2025-11-20 23:36:53 internimage_b_mimic_cxr_224] (utils.py 359): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saving......
[2025-11-20 23:36:55 internimage_b_mimic_cxr_224] (utils.py 361): INFO output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_ema_best.pth saved !!!
[2025-11-20 23:36:55 internimage_b_mimic_cxr_224] (main.py 400): INFO Max ema AUC-ROC: 0.8104
[2025-11-20 23:36:55 internimage_b_mimic_cxr_224] (main.py 443): INFO Training time 7:05:31
[2025-11-21 00:00:14 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 192): INFO Evaluation configuration:
[2025-11-21 00:00:14 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 193): INFO   Checkpoint: output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth
[2025-11-21 00:00:14 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 194): INFO   Split: test
[2025-11-21 00:00:14 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 195): INFO   Batch size: 128
[2025-11-21 00:00:14 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 196): INFO   Data path: /scratch/smehta90/mimic_splits
[2025-11-21 00:05:59 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 195): INFO Evaluation configuration:
[2025-11-21 00:05:59 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 196): INFO   Checkpoint: output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth
[2025-11-21 00:05:59 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 197): INFO   Split: test
[2025-11-21 00:05:59 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 198): INFO   Batch size: 128
[2025-11-21 00:05:59 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 199): INFO   Data path: /scratch/smehta90/mimic_splits
[2025-11-21 00:06:01 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 89): INFO Evaluating on test set with 5159 samples
[2025-11-21 00:06:01 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 91): INFO Creating model:intern_image/internimage_b_mimic_cxr_224
[2025-11-21 00:06:03 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 94): INFO InternImage(
  (patch_embed): StemLayer(
    (conv1): Conv2d(3, 56, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm1): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((56,), eps=1e-06, elementwise_affine=True)
      (2): to_channels_first()
    )
    (act): GELU(approximate='none')
    (conv2): Conv2d(56, 112, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm2): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
    )
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (levels): ModuleList(
    (0): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): Identity()
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.016)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.031)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.047)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (1): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.062)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.078)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.094)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.109)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (2): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.125)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.141)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.156)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.172)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (4): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.188)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (5): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.203)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (6): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.219)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (7): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.234)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (8): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.250)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (9): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.266)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (10): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.281)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (11): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.297)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (12): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.312)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (13): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.328)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (14): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.344)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (15): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.359)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (16): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.375)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (17): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.391)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (18): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.406)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (19): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.422)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (20): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.438)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(448, 896, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (3): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.453)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.469)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.484)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.500)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (conv_head): Sequential(
    (0): Conv2d(896, 1344, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (1): Sequential(
      (0): BatchNorm2d(1344, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): GELU(approximate='none')
  )
  (head): Linear(in_features=1344, out_features=14, bias=True)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
[2025-11-21 00:06:03 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 97): INFO number of params: 96135662
[2025-11-21 00:06:03 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 103): INFO Loading checkpoint from output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth
[2025-11-21 00:06:05 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 108): INFO Checkpoint loaded: <All keys matched successfully>
[2025-11-21 00:06:05 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 109): INFO Checkpoint was saved at epoch 19
[2025-11-21 00:06:05 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 112): INFO Best validation AUC-ROC in checkpoint: 0.8114
[2025-11-21 00:06:05 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 118): INFO Starting evaluation on test set...
[2025-11-21 00:32:22 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 283): INFO Evaluation configuration:
[2025-11-21 00:32:22 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 284): INFO   Checkpoint: output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth
[2025-11-21 00:32:22 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 285): INFO   Split: test
[2025-11-21 00:32:22 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 286): INFO   Batch size: 128
[2025-11-21 00:32:22 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 287): INFO   Data path: /scratch/smehta90/mimic_splits
[2025-11-21 00:32:24 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 177): INFO Evaluating on test set with 5159 samples
[2025-11-21 00:32:24 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 179): INFO Creating model:intern_image/internimage_b_mimic_cxr_224
[2025-11-21 00:32:25 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 182): INFO InternImage(
  (patch_embed): StemLayer(
    (conv1): Conv2d(3, 56, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm1): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((56,), eps=1e-06, elementwise_affine=True)
      (2): to_channels_first()
    )
    (act): GELU(approximate='none')
    (conv2): Conv2d(56, 112, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (norm2): Sequential(
      (0): to_channels_last()
      (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
    )
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (levels): ModuleList(
    (0): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): Identity()
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.016)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.031)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=112)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=112, out_features=126, bias=True)
            (mask): Linear(in_features=112, out_features=63, bias=True)
            (input_proj): Linear(in_features=112, out_features=112, bias=True)
            (output_proj): Linear(in_features=112, out_features=112, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.047)
          (norm2): Sequential(
            (0): LayerNorm((112,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=112, out_features=448, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=448, out_features=112, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (1): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.062)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.078)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.094)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=224)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=224, out_features=252, bias=True)
            (mask): Linear(in_features=224, out_features=126, bias=True)
            (input_proj): Linear(in_features=224, out_features=224, bias=True)
            (output_proj): Linear(in_features=224, out_features=224, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.109)
          (norm2): Sequential(
            (0): LayerNorm((224,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=224, out_features=896, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=896, out_features=224, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (2): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.125)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.141)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.156)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.172)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (4): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.188)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (5): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.203)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (6): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.219)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (7): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.234)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (8): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.250)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (9): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.266)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (10): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.281)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (11): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.297)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (12): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.312)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (13): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.328)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (14): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.344)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (15): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.359)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (16): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.375)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (17): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.391)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (18): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.406)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (19): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.422)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (20): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=448)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=448, out_features=504, bias=True)
            (mask): Linear(in_features=448, out_features=252, bias=True)
            (input_proj): Linear(in_features=448, out_features=448, bias=True)
            (output_proj): Linear(in_features=448, out_features=448, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.438)
          (norm2): Sequential(
            (0): LayerNorm((448,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=448, out_features=1792, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1792, out_features=448, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): DownsampleLayer(
        (conv): Conv2d(448, 896, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (norm): Sequential(
          (0): to_channels_last()
          (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
        )
      )
    )
    (3): InternImageBlock(
      (blocks): ModuleList(
        (0): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.453)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.469)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (2): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.484)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (3): InternImageLayer(
          (norm1): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (dcn): DCNv3(
            (dw_conv): Sequential(
              (0): Conv2d(896, 896, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=896)
              (1): Sequential(
                (0): to_channels_last()
                (1): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
              )
              (2): GELU(approximate='none')
            )
            (offset): Linear(in_features=896, out_features=1008, bias=True)
            (mask): Linear(in_features=896, out_features=504, bias=True)
            (input_proj): Linear(in_features=896, out_features=896, bias=True)
            (output_proj): Linear(in_features=896, out_features=896, bias=True)
          )
          (drop_path): DropPath(drop_prob=0.500)
          (norm2): Sequential(
            (0): LayerNorm((896,), eps=1e-06, elementwise_affine=True)
          )
          (mlp): MLPLayer(
            (fc1): Linear(in_features=896, out_features=3584, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3584, out_features=896, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (conv_head): Sequential(
    (0): Conv2d(896, 1344, kernel_size=(1, 1), stride=(1, 1), bias=False)
    (1): Sequential(
      (0): BatchNorm2d(1344, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): GELU(approximate='none')
  )
  (head): Linear(in_features=1344, out_features=14, bias=True)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
[2025-11-21 00:32:25 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 185): INFO number of params: 96135662
[2025-11-21 00:32:25 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 191): INFO Loading checkpoint from output/mimic_cxr/internimage_b/internimage_b_mimic_cxr_224/ckpt_epoch_best.pth
[2025-11-21 00:32:27 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 196): INFO Checkpoint loaded: <All keys matched successfully>
[2025-11-21 00:32:27 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 197): INFO Checkpoint was saved at epoch 19
[2025-11-21 00:32:27 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 200): INFO Best validation AUC-ROC in checkpoint: 0.8114
[2025-11-21 00:32:27 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 206): INFO Starting evaluation on test set...
[2025-11-21 00:33:08 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 90): INFO Test: [0/41]	Time 38.243 (38.243)	Loss 0.2778 (0.2778)	Mem 3462MB
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 118): INFO  * Mean AUC-ROC 0.7889 Loss 0.2911
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 119): INFO  * Per-class AUC-ROC: ['0.7699', '0.7824', '0.7617', '0.8465', '0.7168', '0.6956', '0.7065', '0.7088', '0.8136', '0.8941', '0.8586', '0.7288', '0.8643', '0.8974']
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 210): INFO ============================================================
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 211): INFO TEST SET RESULTS:
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 212): INFO ============================================================
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 213): INFO Mean AUC-ROC: 0.7889
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 214): INFO Loss: 0.2911
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 215): INFO Per-class AUC-ROC: [0.7699272023914192, 0.7823789831721433, 0.7617472666826611, 0.8465383087541586, 0.7168390804597701, 0.6955907895746968, 0.7064986607597616, 0.7088382612733461, 0.8135543547052239, 0.8940724142048626, 0.8586317860477525, 0.7288025363628332, 0.8642655367231639, 0.8974267559096402]
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 216): INFO ============================================================
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 226): INFO 
Detailed per-class results:
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 227): INFO ------------------------------------------------------------
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 228): INFO Disease                           AUC-ROC
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 229): INFO ------------------------------------------------------------
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 231): INFO Atelectasis                        0.7699
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 231): INFO Cardiomegaly                       0.7824
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 231): INFO Consolidation                      0.7617
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 231): INFO Edema                              0.8465
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 231): INFO Enlarged Cardiomediastinum         0.7168
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 231): INFO Fracture                           0.6956
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 231): INFO Lung Lesion                        0.7065
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 231): INFO Lung Opacity                       0.7088
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 231): INFO No Finding                         0.8136
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 231): INFO Pleural Effusion                   0.8941
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 231): INFO Pleural Other                      0.8586
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 231): INFO Pneumonia                          0.7288
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 231): INFO Pneumothorax                       0.8643
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 231): INFO Support Devices                    0.8974
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 232): INFO ------------------------------------------------------------
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 233): INFO Mean                               0.7889
[2025-11-21 00:34:43 internimage_b_mimic_cxr_224_eval] (eval_checkpoint.py 234): INFO ------------------------------------------------------------
